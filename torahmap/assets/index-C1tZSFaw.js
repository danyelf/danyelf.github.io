(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))u(d);new MutationObserver(d=>{for(const p of d)if(p.type==="childList")for(const v of p.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&u(v)}).observe(document,{childList:!0,subtree:!0});function s(d){const p={};return d.integrity&&(p.integrity=d.integrity),d.referrerPolicy&&(p.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?p.credentials="include":d.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function u(d){if(d.ep)return;d.ep=!0;const p=s(d);fetch(d.href,p)}})();function yn(n){const a=Math.sin(n*12.9898+n*78.233)*43758.5453;return a-Math.floor(a)}const Yt=[{name:"Genesis",file:"genesis",section:"torah"},{name:"Exodus",file:"exodus",section:"torah"},{name:"Leviticus",file:"leviticus",section:"torah"},{name:"Numbers",file:"numbers",section:"torah"},{name:"Deuteronomy",file:"deuteronomy",section:"torah"},{name:"Joshua",file:"joshua",section:"neviim"},{name:"Judges",file:"judges",section:"neviim"},{name:"I Samuel",file:"i-samuel",section:"neviim"},{name:"II Samuel",file:"ii-samuel",section:"neviim"},{name:"I Kings",file:"i-kings",section:"neviim"},{name:"II Kings",file:"ii-kings",section:"neviim"},{name:"Isaiah",file:"isaiah",section:"neviim"},{name:"Jeremiah",file:"jeremiah",section:"neviim"},{name:"Ezekiel",file:"ezekiel",section:"neviim"},{name:"Hosea",file:"hosea",section:"neviim"},{name:"Joel",file:"joel",section:"neviim"},{name:"Amos",file:"amos",section:"neviim"},{name:"Obadiah",file:"obadiah",section:"neviim"},{name:"Jonah",file:"jonah",section:"neviim"},{name:"Micah",file:"micah",section:"neviim"},{name:"Nahum",file:"nahum",section:"neviim"},{name:"Habakkuk",file:"habakkuk",section:"neviim"},{name:"Zephaniah",file:"zephaniah",section:"neviim"},{name:"Haggai",file:"haggai",section:"neviim"},{name:"Zechariah",file:"zechariah",section:"neviim"},{name:"Malachi",file:"malachi",section:"neviim"},{name:"Psalms",file:"psalms",section:"ketuvim"},{name:"Proverbs",file:"proverbs",section:"ketuvim"},{name:"Job",file:"job",section:"ketuvim"},{name:"Song of Songs",file:"song-of-songs",section:"ketuvim"},{name:"Ruth",file:"ruth",section:"ketuvim"},{name:"Lamentations",file:"lamentations",section:"ketuvim"},{name:"Ecclesiastes",file:"ecclesiastes",section:"ketuvim"},{name:"Esther",file:"esther",section:"ketuvim"},{name:"Daniel",file:"daniel",section:"ketuvim"},{name:"Ezra",file:"ezra",section:"ketuvim"},{name:"Nehemiah",file:"nehemiah",section:"ketuvim"},{name:"I Chronicles",file:"i-chronicles",section:"ketuvim"},{name:"II Chronicles",file:"ii-chronicles",section:"ketuvim"}],Lo=Yt.map(n=>n.name),_o=new Set(Yt.filter(n=>n.section==="torah").map(n=>n.name));new Set(Yt.filter(n=>n.section==="neviim").map(n=>n.name));const Do=new Set(Yt.filter(n=>n.section==="ketuvim").map(n=>n.name));Object.fromEntries(Yt.map(n=>[n.name,n.file]));function Bo(n){return _o.has(n)?"torah":Do.has(n)?"ketuvim":"neviim"}const Dn=.5,Bn=2,$o=.9,Fo=1.1,jo=1,Ho=300,Uo=2,oo=60,ro=20,$t=6,$n=2,Vt=12,Fn=70,io=35,Ft=50,Ko=12,jn=3,Hn=15,dn=72,ao=[["Hosea","Joel"],["Amos","Obadiah","Jonah"],["Micah","Nahum","Habakkuk","Zephaniah","Haggai"],["Zechariah","Malachi"]],Un=new Set(ao.flat()),so=[{books:["Song of Songs","Ruth","Lamentations"],insertAfter:"Job"},{books:["Ecclesiastes","Esther"],insertAfter:"Job"},{books:["Ezra","Nehemiah"],insertAfter:"Daniel"}],zo=new Set(so.flatMap(n=>n.books));function Vo(n){if(!Number.isFinite(n)||n<0)return console.error(`Invalid verse count: ${n}, defaulting to 0`),[0];if(n===0)return[0];if(n<=Ft)return[n];const a=[];let s=n;for(;s>0;)if(s<=Ft)a.push(s),s=0;else if(s<=Ft+jn-1){const u=s-jn;a.push(u),s-=u}else a.push(Ft),s-=Ft;return a}function bn(n,a,s,u,d,p,v){if(!Number.isFinite(s)||s<0)return console.error(`Invalid verse count for ${n} chapter ${a+1}: ${s}`),{width:0,height:0};if(!Number.isFinite(u)||!Number.isFinite(d))return console.error(`Invalid coordinates for ${n} chapter ${a+1}: (${u}, ${d})`),{width:0,height:0};if(!Array.isArray(v))return console.error(`Verses array is not an array for ${n} chapter ${a+1}`),{width:0,height:0};const k=Vo(s);let T=0,P=d,C=0;for(let D=0;D<k.length;D++){const F=k[D];if(!Number.isFinite(F)||F<0){console.error(`Invalid wrap point ${F} at line ${D} for ${n} chapter ${a+1}`);continue}const j=D>0?Ko:0;for(let Y=0;Y<F;Y++){const Z=(yn(p.value*2)-Dn)*Bn,ye=(yn(p.value*2+1)-Dn)*Bn,ue=u+j+Y*$t+Z;v.push({book:n,chapter:a+1,verse:C+1,x:ue,y:P+ye,size:$t}),T=Math.max(T,j+(Y+1)*$t),C++,p.value++}P+=$t+$n}return{width:T,height:k.length*($t+$n)}}function An(n,a,s,u,d){if(!n||typeof n!="object")return console.error(`Invalid book object: ${n}`),{width:0,height:0};if(!n.name||typeof n.name!="string")return console.error(`Invalid book name: ${n.name}`),{width:0,height:0};if(!Array.isArray(n.chapters))return console.error(`Book ${n.name} has invalid chapters array`),{width:0,height:0};if(!Number.isFinite(a)||!Number.isFinite(s))return console.error(`Invalid coordinates for ${n.name}: (${a}, ${s})`),{width:0,height:0};let p=0,v=s;for(let k=0;k<n.chapters.length;k++){const T=n.chapters[k];if(!Number.isFinite(T)||T<0){console.error(`Invalid verse count for ${n.name} chapter ${k+1}: ${T}`);continue}const{width:P,height:C}=bn(n.name,k,T,a,v,u,d);p=Math.max(p,P),v+=C}return{width:p,height:v-s}}function co(n,a,s,u,d,p,v=An){if(!Array.isArray(n))return console.error(`Books is not an array: ${n}`),{width:0,height:0,nextX:a};if(!Number.isFinite(a)||!Number.isFinite(s)||!Number.isFinite(u))return console.error(`Invalid layout parameters: startX=${a}, y=${s}, gap=${u}`),{width:0,height:0,nextX:a};let k=a,T=0;for(const P of n){if(!P){console.error("Encountered null or undefined book in layoutBooksRow");continue}const{width:C,height:D}=v(P,k,s,d,p);T=Math.max(T,D),k+=C+u}return{width:k-a-(n.length>0?u:0),height:T,nextX:k}}function uo(n,a,s,u,d,p,v){if(!Array.isArray(n))return console.error(`Book names is not an array: ${n}`),{width:0,height:0};if(!(a instanceof Map))return console.error(`Book map is not a Map: ${a}`),{width:0,height:0};if(!Number.isFinite(s)||!Number.isFinite(u)||!Number.isFinite(d))return console.error(`Invalid layout parameters: x=${s}, startY=${u}, gap=${d}`),{width:0,height:0};let k=u,T=0;for(const C of n){if(!C||typeof C!="string"){console.error(`Invalid book name in stack: ${C}`);continue}const D=a.get(C);if(!D){console.error(`Book not found in map: ${C}`);continue}const{width:F,height:j}=An(D,s,k,p,v);T=Math.max(T,F),k+=j+d}const P=k-u-(n.length>0?d:0);return{width:T,height:P}}function Go(n,a,s,u,d,p,v,k){if(!Array.isArray(n))return console.error(`Stacks is not an array: ${n}`),{width:0,height:0};if(!Number.isFinite(s)||!Number.isFinite(u)||!Number.isFinite(d)||!Number.isFinite(p))return console.error(`Invalid layout parameters: startX=${s}, y=${u}, stackGap=${d}, columnGap=${p}`),{width:0,height:0};let T=s,P=0;for(const C of n){if(!Array.isArray(C)){console.error(`Stack is not an array: ${C}`);continue}const{width:D,height:F}=uo(C,a,T,u,d,v,k);P=Math.max(P,F),T+=D+p}return{width:T-s-(n.length>0?p:0),height:P}}function qo(n,a,s,u,d){if(!n||!Array.isArray(n.chapters))return console.error(`Invalid Psalms book structure: ${n==null?void 0:n.name}`),{width:0,height:0};if(!Number.isFinite(a)||!Number.isFinite(s))return console.error(`Invalid coordinates for Psalms: (${a}, ${s})`),{width:0,height:0};const p=Math.min(dn,n.chapters.length);dn>n.chapters.length&&console.warn(`Psalms split point ${dn} exceeds chapter count ${n.chapters.length}, using ${p}`);let v=s,k=0;for(let j=0;j<p;j++){const Y=n.chapters[j];if(j>=n.chapters.length){console.error(`Chapter index ${j} out of bounds for Psalms (${n.chapters.length} chapters)`);break}const{width:Z,height:ye}=bn(n.name,j,Y,a,v,u,d);k=Math.max(k,Z),v+=ye}const T=v-s,P=a+k+Hn;let C=s,D=0;for(let j=p;j<n.chapters.length;j++){const Y=n.chapters[j];if(j>=n.chapters.length){console.error(`Chapter index ${j} out of bounds for Psalms (${n.chapters.length} chapters)`);break}const{width:Z,height:ye}=bn(n.name,j,Y,P,C,u,d);D=Math.max(D,Z),C+=ye}const F=C-s;return{width:k+Hn+D,height:Math.max(T,F)}}function Wo(n,a,s,u){if(!Array.isArray(n))return console.error(`Nevi'im books is not an array: ${n}`),0;if(!Number.isFinite(a))return console.error(`Invalid Nevi'im section Y: ${a}`),0;const d=n.filter(C=>C&&!Un.has(C.name)),p=n.filter(C=>C&&Un.has(C.name)),v=new Map(p.map(C=>[C.name,C])),{height:k,nextX:T}=co(d,0,a,Vt,s,u),{height:P}=Go(ao,v,T,a,io,Vt,s,u);return Math.max(k,P)}function Yo(n,a,s,u){if(!Array.isArray(n))return console.error(`Ketuvim books is not an array: ${n}`),0;if(!Number.isFinite(a))return console.error(`Invalid Ketuvim section Y: ${a}`),0;const d=new Map(n.filter(T=>T&&T.name).map(T=>[T.name,T]));let p=0,v=0;const k=n.filter(T=>T&&!zo.has(T.name));for(const T of k){if(!T){console.error("Encountered null or undefined book in Ketuvim");continue}const{width:P,height:C}=T.name==="Psalms"?qo(T,p,a,s,u):An(T,p,a,s,u);v=Math.max(v,C),p+=P+Vt;for(const D of so){if(!D||!Array.isArray(D.books)){console.error(`Invalid Ketuvim stack config: ${D}`);continue}if(T.name===D.insertAfter){const{width:F,height:j}=uo(D.books,d,p,a,io,s,u);v=Math.max(v,j),p+=F+Vt}}}return v}function Xo(n,a,s,u){if(!Array.isArray(n))return console.error(`Torah books is not an array: ${n}`),0;if(!Number.isFinite(a))return console.error(`Invalid Torah section Y: ${a}`),0;const{height:d}=co(n,0,a,Vt,s,u);return d}function Jo(n){if(!n||typeof n!="object")return console.error("Invalid torahData: not an object"),[];if(!Array.isArray(n.books))return console.error("Invalid torahData: books is not an array"),[];if(n.books.length===0)return console.warn("Empty books array in torahData"),[];const a=[],s={value:0},u=[],d=[],p=[];for(const P of n.books){if(!P||typeof P!="object"){console.error(`Invalid book in torahData: ${P}`);continue}if(!P.name||typeof P.name!="string"){console.error(`Book missing valid name: ${JSON.stringify(P)}`);continue}const C=Bo(P.name);C==="torah"?u.push(P):C==="neviim"?d.push(P):C==="ketuvim"?p.push(P):console.warn(`Book ${P.name} has unknown section: ${C}`)}u.length===0&&console.warn("Torah section is empty"),d.length===0&&console.warn("Neviim section is empty"),p.length===0&&console.warn("Ketuvim section is empty");let v=0;const k=Xo(u,v,s,a);v+=k+Fn;const T=Wo(d,v,s,a);return v+=T+Fn,Yo(p,v,s,a),a}function Zo(n){if(!Array.isArray(n))return console.error("getLayoutBounds: verses is not an array"),{width:0,height:0};if(n.length===0)return console.warn("getLayoutBounds: empty verses array"),{width:0,height:0};let a=0,s=0;for(const u of n){if(!u||typeof u!="object"){console.error(`Invalid verse in bounds calculation: ${u}`);continue}if(!Number.isFinite(u.x)||!Number.isFinite(u.y)||!Number.isFinite(u.size)){console.error(`Invalid verse coordinates: ${u.book} ${u.chapter}:${u.verse} at (${u.x}, ${u.y}) size=${u.size}`);continue}(u.x<-2||u.y<-2||u.size<0)&&console.warn(`Suspicious coordinates for verse ${u.book} ${u.chapter}:${u.verse}: (${u.x}, ${u.y}) size=${u.size}`),a=Math.max(a,u.x+u.size),s=Math.max(s,u.y+u.size)}return!Number.isFinite(a)||!Number.isFinite(s)?(console.error(`Invalid bounds calculated: width=${a}, height=${s}`),{width:0,height:0}):{width:a,height:s}}const Qo=10,Kn=13,er=5,tr=50;function nr(n,a){const s={};for(const d of n)s[d.book]||(s[d.book]={minX:d.x,maxX:d.x+d.size,minY:d.y}),s[d.book].maxX=Math.max(s[d.book].maxX,d.x+d.size),s[d.book].minY=Math.min(s[d.book].minY,d.y);const u=document.createElement("div");u.id="book-labels",u.style.cssText="position:fixed;top:0;left:0;pointer-events:none;";for(const[d,p]of Object.entries(s)){const v=document.createElement("div");v.textContent=d,v.style.cssText=`
      position:absolute;
      color:#eee;
      font-family:sans-serif;
      font-weight:700;
      text-shadow:0 1px 3px rgba(0,0,0,0.8);
      white-space:nowrap;
    `,v.dataset.bookName=d,v.dataset.leftX=String(p.minX),v.dataset.topY=String(p.minY),u.appendChild(v)}return a.appendChild(u),u}function wn(n,a,s){const u=Math.max(er,Math.min(tr,Kn*s)),d=Qo*(u/Kn);for(const p of n.children)if(p instanceof HTMLElement){const v=parseFloat(p.dataset.leftX||"0"),k=parseFloat(p.dataset.topY||"0"),T=(v+a.x)*s,P=(k+a.y)*s-u-d;p.style.left=T+"px",p.style.top=P+"px",p.style.fontSize=u+"px"}}async function or(){const n=await fetch("/torahmap/data/all-texts.json");return n.ok?await n.json():(console.error(`Failed to load verse texts: ${n.status}`),{})}function rr(n,a,s,u){var d,p;return((p=(d=n[a])==null?void 0:d[String(s)])==null?void 0:p[String(u)])||null}function nn(n,a){return n===null&&a===null?!0:n===null||a===null?!1:n.book===a.book&&n.chapter===a.chapter&&n.verse===a.verse}function ir(n,a){const s=n.findIndex(u=>u.book===a.book&&u.chapter===a.chapter&&u.verse===a.verse);return s===-1||s>=n.length-1?null:n[s+1]}function ar(n,a){const s=n.findIndex(u=>u.book===a.book&&u.chapter===a.chapter&&u.verse===a.verse);return s<=0?null:n[s-1]}function $e(n,a,s){return`${n}:${a}:${s}`}const sr=1424,cr=1535,In=1425,On=1479,ur=["ו","ה","ב","ל","כ","מ","ש"],lr=["וב","וה","ול","וכ","ומ","וש","מה","שב","של","בה"];let Gt=[],at=null,Lt=null,xn=null;function mt(n){let a="";for(const s of n){const u=s.charCodeAt(0);(u<In||u>On||u===1470||u===1472||u===1475||u===1478)&&(a+=s)}return a}function lo(n){return n.split(/[,،‎\u05F4]/).map(a=>a.trim()).filter(a=>a.length>=Uo)}async function fr(){try{const[n,a,s]=await Promise.all([fetch("/data/word-lemmas.json"),fetch("/data/verse-lemmas.json"),fetch("/data/strongs-to-root.json")]);n.ok&&a.ok&&s.ok?(at=await n.json(),Lt=await a.json(),xn=await s.json()):console.warn("Failed to load lemma data, falling back to substring search")}catch(n){console.warn("Error loading lemma data:",n)}}function Pn(n){if(!at)return null;const a=mt(n);if(at[a])return at[a];for(const s of lr)if(a.startsWith(s)&&a.length>s.length+1){const u=a.slice(s.length);if(at[u])return at[u]}for(const s of ur)if(a.startsWith(s)&&a.length>2){const u=a.slice(s.length);if(at[u])return at[u]}return null}function dr(n){return xn&&xn[n]||null}function st(n){for(const a of n){const s=a.charCodeAt(0);if(s>=sr&&s<=cr)return!0}return!1}function hr(n){Gt=[];for(const a of Lo){const s=n[a];if(!s)continue;const u=Object.keys(s).map(Number).sort((d,p)=>d-p);for(const d of u){const p=s[String(d)],v=Object.keys(p).map(Number).sort((k,T)=>k-T);for(const k of v){const{he:T,en:P}=p[String(k)];Gt.push({book:a,chapter:d,verse:k,hebrewText:mt(T),hebrewOriginal:T,englishText:P.toLowerCase(),englishOriginal:P})}}}}function pr(n){const a=new Set;if(!Lt)return a;for(const[s,u]of Object.entries(Lt))n.some(d=>u.includes(d))&&a.add(s);return a}function mr(n,a){if(!Lt)return-1;const s=Lt[n];if(!s)return-1;for(let u=0;u<s.length;u++)if(a.includes(s[u]))return u;return-1}function fo(n,a){if(a<0)return null;let s=0,u=0;for(;u<n.length&&/\s/.test(n[u]);)u++;for(;s<a&&u<n.length;){for(;u<n.length&&!/\s/.test(n[u]);)u++;for(;u<n.length&&/\s/.test(n[u]);)u++;s++}if(u>=n.length)return null;let d=u;for(;d<n.length&&!/\s/.test(n[d]);)d++;return{start:u,end:d}}function en(n){const a=new Map;for(let s=0;s<n.length;s++){const u=n[s],d=mt(u);for(const p of Gt){const k=p.hebrewText.split(/\s+/).findIndex(T=>T===d);if(k!==-1){const T=fo(p.hebrewOriginal,k);if(T){const P=`${p.book}:${p.chapter}:${p.verse}`;let C=a.get(P);if(C||(C={book:p.book,chapter:p.chapter,verse:p.verse,language:"he",matchingTerms:[]},a.set(P,C)),!C.matchingTerms.some(D=>D.termIndex===s)){const D=T.end-T.start,F=ho(p.hebrewOriginal,T.start,D);C.matchingTerms.push({termIndex:s,snippet:F.text,matchStart:F.matchStart,matchEnd:F.matchEnd})}}}}}return Array.from(a.values())}function gr(n){const a=new Map;if(!at||!Lt)return en(n);const s=[];for(let u=0;u<n.length;u++){const d=Pn(n[u]);d&&d.length>0&&s.push({termIndex:u,lemmas:d})}if(s.length>0){for(const{termIndex:u,lemmas:d}of s){const p=pr(d);for(const v of p){const k=Gt.find(T=>`${T.book}:${T.chapter}:${T.verse}`===v);if(k){let T=a.get(v);if(T||(T={book:k.book,chapter:k.chapter,verse:k.verse,language:"he",matchingTerms:[]},a.set(v,T)),!T.matchingTerms.some(P=>P.termIndex===u)){const P=mr(v,d),C=P>=0?fo(k.hebrewOriginal,P):null;if(C){const D=C.end-C.start,F=ho(k.hebrewOriginal,C.start,D);T.matchingTerms.push({termIndex:u,snippet:F.text,matchStart:F.matchStart,matchEnd:F.matchEnd})}else{const F=en([n[u]]).find(j=>j.book===k.book&&j.chapter===k.chapter&&j.verse===k.verse);if(F&&F.matchingTerms.length>0){const j=F.matchingTerms[0];T.matchingTerms.push({termIndex:u,snippet:j.snippet,matchStart:j.matchStart,matchEnd:j.matchEnd})}else T.matchingTerms.push({termIndex:u,snippet:k.hebrewOriginal.slice(0,60)+(k.hebrewOriginal.length>60?"...":""),matchStart:0,matchEnd:0})}}}}}if(a.size>0)return Array.from(a.values())}return en(n)}function vr(n,a=!1,s="substring"){const u=lo(n);if(u.length===0)return[];const d=st(u[0]);if(d)switch(s){case"word":return en(u);case"root":return gr(u)}const p=new Map;for(let v=0;v<u.length;v++){const k=u[v],T=d?mt(k):k.toLowerCase();for(const P of Gt){const C=d?P.hebrewText:P.englishText,D=d?P.hebrewOriginal:P.englishOriginal;let F=[];if(!d&&a){const j=T.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Y=new RegExp(`\\b${j}\\b`,"gi");let Z;for(;(Z=Y.exec(C))!==null;)F.push({idx:Z.index,len:Z[0].length})}else{const j=C.indexOf(T);j!==-1&&F.push({idx:j,len:T.length})}for(const{idx:j,len:Y}of F){const Z=`${P.book}:${P.chapter}:${P.verse}`,ye=wr(D,j,Y,d);let ue=p.get(Z);ue||(ue={book:P.book,chapter:P.chapter,verse:P.verse,language:d?"he":"en",matchingTerms:[]},p.set(Z,ue)),ue.matchingTerms.some(oe=>oe.termIndex===v)||ue.matchingTerms.push({termIndex:v,snippet:ye.text,matchStart:ye.matchStart,matchEnd:ye.matchEnd})}}}return Array.from(p.values())}function ho(n,a,s){const u=oo,d=ro,p=Math.min(a+s,n.length);let v=Math.max(0,a-d),k=Math.min(n.length,v+u);k===n.length&&k-v<u&&(v=Math.max(0,k-u));let T=n.slice(v,k);const P=a-v,C=p-v;let D=0;return v>0&&(T="..."+T,D=3),k<n.length&&(T=T+"..."),{text:T,matchStart:P+D,matchEnd:Math.min(C+D,T.length)}}function yr(n,a){if(a<0)return 0;let s=0;for(let u=0;u<n.length;u++){if(s===a)return u;const d=n.charCodeAt(u);d>=In&&d<=On&&d!==1470&&d!==1472&&d!==1475&&d!==1478||s++}return n.length}function br(n,a,s){if(a<0||a>=n.length||s<0)return 0;let u=0,d=0;for(let p=a;p<n.length&&d<s;p++){const v=n.charCodeAt(p);v>=In&&v<=On&&v!==1470&&v!==1472&&v!==1475&&v!==1478?u++:d++}return u}function wr(n,a,s,u=!1){const d=oo,p=ro;let v=a,k=a+s;if(u){v=yr(n,a);const Y=br(n,v,s);k=Math.min(v+s+Y,n.length)}let T=Math.max(0,v-p),P=Math.min(n.length,T+d);P===n.length&&P-T<d&&(T=Math.max(0,P-d));let C=n.slice(T,P);const D=v-T,F=k-T;let j=0;return T>0&&(C="..."+C,j=3),P<n.length&&(C=C+"..."),{text:C,matchStart:D+j,matchEnd:Math.min(F+j,C.length)}}function xr(n){const a=new Map;for(const s of n){const u=$e(s.book,s.chapter,s.verse);a.set(u,s.matchingTerms.map(d=>d.termIndex))}return a}const po="torahMap.helpSeen",mo="torahMap.helpTab",go={overview:{title:"Overview",content:`
      <h2>Torah Map</h2>
      <p>An interactive visualization of the entire Tanakh (Hebrew Bible) where every verse has a fixed position.</p>
      <p>The map is divided into three sections, stacked vertically:</p>
      <ul>
        <li><strong>Torah</strong> — The Five Books of Moses</li>
        <li><strong>Nevi'im</strong> — The Prophets</li>
        <li><strong>Ketuvim</strong> — The Writings</li>
      </ul>
      <p>Switch between different analytical overlays to reveal patterns across 23,000+ verses.</p>
      <p class="credits">
        By <a href="https://danyelfisher.info" target="_blank">Danyel Fisher</a> ·
        <a href="https://github.com/danyelf/torahmap" target="_blank">GitHub</a> ·
        Data from <a href="https://www.sefaria.org/" target="_blank">Sefaria</a>
      </p>
    `},controls:{title:"Controls",content:`
      <table class="controls-table">
        <tr><td>Mouse wheel</td><td>Zoom in/out</td></tr>
        <tr><td>Click + drag</td><td>Pan around</td></tr>
        <tr><td>Hover</td><td>Preview verse details</td></tr>
        <tr><td>Click verse</td><td>Pin verse in sidebar</td></tr>
        <tr><td>Click pinned</td><td>Unpin verse</td></tr>
      </table>
    `},overlays:{title:"Overlays",content:`
      <dl class="overlay-list">
        <dt>Text Search</dt>
        <dd>Search Hebrew or English text. Matching verses are highlighted on the map.</dd>

        <dt>Commentary</dt>
        <dd>Heatmap showing commentary density from Sefaria. Filter by source type.</dd>

        <dt>Trop</dt>
        <dd>Visualize cantillation marks (trope). Select a mark to see where it appears.</dd>
      </dl>
    `}};let St=null;function Er(){const n=document.createElement("div");n.id="help-modal",n.className="help-modal",n.innerHTML=`
    <div class="help-backdrop"></div>
    <div class="help-content">
      <div class="help-header">
        <div class="help-tabs">
          <button class="help-tab active" data-tab="overview">Overview</button>
          <button class="help-tab" data-tab="controls">Controls</button>
          <button class="help-tab" data-tab="overlays">Overlays</button>
        </div>
        <button class="help-close">&times;</button>
      </div>
      <div class="help-body"></div>
    </div>
  `;const a=n.querySelector(".help-backdrop"),s=n.querySelector(".help-close"),u=n.querySelectorAll(".help-tab");return a.addEventListener("click",Vn),s.addEventListener("click",Vn),u.forEach(d=>{d.addEventListener("click",()=>{const p=d.dataset.tab;vo(n,p)})}),n}function vo(n,a){localStorage.setItem(mo,a),n.querySelectorAll(".help-tab").forEach(u=>{u.classList.toggle("active",u.dataset.tab===a)});const s=n.querySelector(".help-body");s.innerHTML=go[a].content}function zn(){St||(St=Er(),document.body.appendChild(St));const n=localStorage.getItem(mo),a=n&&go[n]?n:"overview";St.classList.add("visible"),vo(St,a)}function Vn(){St&&(St.classList.remove("visible"),localStorage.setItem(po,"true"))}function Sr(n){const a=document.createElement("button");a.id="help-btn",a.textContent="?",a.title="How to use",a.addEventListener("click",zn),n.appendChild(a),localStorage.getItem(po)||zn()}const yo=.1,bo=10;function kr(n,a,s){return{x:n/2-s.width/2,y:a/2-s.height/2,zoom:1}}function Cr(n){return Math.max(yo,Math.min(bo,n))}function Tr(n,a,s,u,d){return{x:n.x+u*(1/s-1/a),y:n.y+d*(1/s-1/a)}}const Gn=1e6,wo=50,Ar=1e3;function xo(n,a){if(!n)return null;const s=n.trim();return!s||s.length>a||/<[^>]*>/.test(s)||/javascript:/i.test(s)||/on\w+=/i.test(s)?null:s}function Qt(n,a=wo){const s=xo(n,a);return!s||/[/\\|;]/.test(s)?null:s}function Ir(n){const a=xo(n,wo);return!a||!/^[a-zA-Z\s/]+$/.test(a)?null:a}function Or(n){return!n||n.trim()===""?!1:/^[a-zA-Z\u0590-\u05FF\s.]+$/.test(n)}function Pr(n){return n.replace(/<[^>]*>/g,"")}function Mr(){const n=window.location.hash.slice(1),a=new URLSearchParams(n),s={overlayParams:{}},u=a.get("overlay"),d=Qt(u);d&&(s.overlay=d);const p=a.get("verse"),v=Qt(p,100);v&&(s.verse=v);const k=a.get("zoom");if(k){const oe=parseFloat(k);!isNaN(oe)&&oe>=yo&&oe<=bo&&(s.zoom=oe)}const T=a.get("x");if(T){const oe=parseFloat(T);!isNaN(oe)&&isFinite(oe)&&Math.abs(oe)<=Gn&&(s.x=oe)}const P=a.get("y");if(P){const oe=parseFloat(P);!isNaN(oe)&&isFinite(oe)&&Math.abs(oe)<=Gn&&(s.y=oe)}const C=a.get("trop"),D=Qt(C);D&&(s.overlayParams.trop=D);const F=a.get("category"),j=Ir(F);j&&(s.overlayParams.category=j);const Y=a.get("q");if(Y){const oe=Y.trim();oe&&oe.length<=Ar&&(s.overlayParams.q=Pr(oe))}const Z=a.get("ww");Z&&(s.overlayParams.ww=Z);const ye=a.get("hm"),ue=Qt(ye);return ue&&(ue==="substring"||ue==="word"||ue==="root")&&(s.overlayParams.hm=ue),s}function Nr(n){const a=new URLSearchParams;n.overlay&&a.set("overlay",n.overlay),n.verse&&a.set("verse",n.verse),n.zoom!==void 0&&n.zoom!==1&&a.set("zoom",n.zoom.toFixed(2).replace(/\.?0+$/,"")),n.verse||(n.x!==void 0&&a.set("x",n.x.toFixed(1).replace(/\.?0+$/,"")),n.y!==void 0&&a.set("y",n.y.toFixed(1).replace(/\.?0+$/,""))),n.overlayParams.trop&&a.set("trop",n.overlayParams.trop),n.overlayParams.category&&n.overlayParams.category!=="all"&&a.set("category",n.overlayParams.category),n.overlayParams.q&&a.set("q",n.overlayParams.q),n.overlayParams.ww&&a.set("ww",n.overlayParams.ww),n.overlayParams.hm&&a.set("hm",n.overlayParams.hm);const s=a.toString();return s?`#${s}`:""}function Rr(n,a=!1){const s=Nr(n),u=window.location.pathname+window.location.search+s;a?history.pushState(null,"",u):history.replaceState(null,"",u)}function Lr(n){window.addEventListener("popstate",n),window.addEventListener("hashchange",n)}function _r(n,a,s){return`${n.replace(/ /g,".")}.${a}.${s}`}function Dr(n){const a=n.split(".");if(a.length<3||a.length>5)return null;const s=a.pop(),u=a.pop(),d=a.join(" "),p=parseInt(s,10),v=parseInt(u,10);return isNaN(p)||isNaN(v)||p<0||v<0||v>200||p>200||!Or(d)?null:{book:d,chapter:v,verse:p}}function Br(n,a){let s=null;return(...u)=>{s&&clearTimeout(s),s=setTimeout(()=>{n(...u),s=null},a)}}const It=[[.1,.7,.8],[1,.5,0],[.5,1,.2],[1,.2,.8],[1,1,.2]];function qn(n,a){const s=Math.max(0,Math.min(1,n));for(let u=0;u<a.length-1;u++){const d=a[u],p=a[u+1];if(s>=d.t&&s<=p.t){const v=p.t-d.t,k=v>0?(s-d.t)/v:0;return[d.color[0]+k*(p.color[0]-d.color[0]),d.color[1]+k*(p.color[1]-d.color[1]),d.color[2]+k*(p.color[2]-d.color[2])]}}return a[a.length-1].color}function En(n,a,s,u){if((u==null?void 0:u.useLog)??!1){const p=Math.log(a+1),v=Math.log(n+1)/p;return qn(v,s)}else{const p=a>0?n/a:0;return qn(p,s)}}function $r(n,a){return n===0?[.15,.15,.2]:En(n,a,[{t:0,color:[.1,.13,.18]},{t:.25,color:[.1,.23,.38]},{t:.5,color:[.2,.43,.33]},{t:.75,color:[.9,.33,.13]},{t:1,color:[1,.23,.18]}],{useLog:!0})}function Fr(n){const[a,s,u]=n,d=Math.max(a,s,u),p=Math.min(a,s,u),v=(d+p)/2;if(d===p)return{h:0,s:0,l:v};const k=d-p,T=v>.5?k/(2-d-p):k/(d+p);let P;return d===a?P=((s-u)/k+(s<u?6:0))/6:d===s?P=((u-a)/k+2)/6:P=((a-s)/k+4)/6,{h:P*360,s:T,l:v}}function Eo(n){const{h:a,s,l:u}=n;if(s===0)return[u,u,u];const d=(T,P,C)=>(C<0&&(C+=1),C>1&&(C-=1),C<1/6?T+(P-T)*6*C:C<1/2?P:C<2/3?T+(P-T)*(2/3-C)*6:T),p=u<.5?u*(1+s):u+s-u*s,v=2*u-p,k=a/360;return[d(v,p,k+1/3),d(v,p,k),d(v,p,k-1/3)]}let qt={},Ce="total",ut=null,Ct={},So=[];function ko(n,a,s){var d,p;const u=(p=(d=qt[n])==null?void 0:d[String(a)])==null?void 0:p[String(s)];return u?Ce==="total"?u.total:u.categories[Ce]||0:0}function Wn(){if(Ct[Ce]!==void 0)return Ct[Ce];let n=0;for(const a of So){const s=ko(a.book,a.chapter,a.verse);s>n&&(n=s)}return Ct[Ce]=n,n}const jr={id:"commentary",name:"Commentary Density",async init(){try{const n=await fetch("/torahmap/data/commentary-counts.json");if(!n.ok){console.error(`Failed to load commentary-counts.json: ${n.status}`);return}qt=await n.json()}catch(n){console.error("Failed to parse commentary-counts.json:",n)}},destroy(){Ct={},ut=null},onUpdate(n){ut=n},getVerseColor(n){const a=ko(n.book,n.chapter,n.verse),s=Wn();return $r(a,s)},renderControls(n){const a=document.createElement("div");a.className="commentary-controls",a.innerHTML=`
      <label for="category-select">Category:</label>
      <select id="category-select">
        <option value="total">All Commentary</option>
        <option value="Talmud">Talmud</option>
        <option value="Midrash">Midrash</option>
        <option value="Halakhah">Halakhah</option>
        <option value="Jewish Thought">Jewish Thought</option>
        <option value="Chasidut">Chasidut</option>
        <option value="Kabbalah">Kabbalah</option>
        <option value="Musar">Musar</option>
      </select>
    `;const s=a.querySelector("select");s.value=Ce,s.addEventListener("change",()=>{Ce=s.value,Ct={},ut==null||ut()}),n.appendChild(a)},renderLegend(n){const a=Wn(),s=Math.log(a+1),u=[0];let d=1;for(;d<=a;)u.push(d),d*=10;u[u.length-1]<a&&u.push(a),n.innerHTML=`
      <div class="legend-gradient"></div>
      <div class="legend-ticks">
        ${u.map(p=>{const v=p===0?0:Math.log(p+1)/s*100,k=p>=1e3?`${p/1e3}k`:String(p);return`<span class="tick" style="left: ${v}%">${k}</span>`}).join("")}
      </div>
    `},getHoverInfo(n){var u,d;const a=(d=(u=qt[n.book])==null?void 0:u[String(n.chapter)])==null?void 0:d[String(n.verse)];if(!a)return null;if(Ce==="total")return`${a.total} links`;const s=a.categories[Ce];return s?`${s} ${Ce}`:`no ${Ce}`},getUrlParams(){return Ce==="total"?{}:{cat:Ce}},applyUrlParams(n){const a=n.get("cat");a&&(Ce=a,Ct={},ut==null||ut())},getLinkSubtitle(n){const a=Kr(n.book,n.chapter,n.verse);if(!a)return null;const s=Ce==="total"?"linked texts":`${Ce} links`;return`${a} ${s}`}};function Hr(n){So=n.verses,Ct={},Ce="total"}function Ur(n,a,s){var d,p;const u=(p=(d=qt[n])==null?void 0:d[String(a)])==null?void 0:p[String(s)];return(u==null?void 0:u.total)??null}function Kr(n,a,s){var d,p;const u=(p=(d=qt[n])==null?void 0:d[String(a)])==null?void 0:p[String(s)];return u?Ce==="total"?u.total:u.categories[Ce]??null:null}function zr(){const n=document.getElementById("verse-sidebar");return{sidebar:n,ref:(n==null?void 0:n.querySelector(".ref-text"))??null,overlayInfo:(n==null?void 0:n.querySelector(".overlay-info"))??null,hebrew:(n==null?void 0:n.querySelector(".verse-hebrew"))??null,english:(n==null?void 0:n.querySelector(".verse-english"))??null,link:(n==null?void 0:n.querySelector(".sefaria-link"))??null,linkSubtitle:(n==null?void 0:n.querySelector(".link-subtitle"))??null,closeBtn:(n==null?void 0:n.querySelector(".close-btn"))??null}}function Vr(n,a,s,u=null){var v;const p=`https://www.sefaria.org/${n.replace(/ /g,"_")}.${a}.${s}`;if((u==null?void 0:u.id)==="commentary"){const k=(v=u.getUrlParams)==null?void 0:v.call(u),T=k==null?void 0:k.cat;if(T)return`${p}?with=${encodeURIComponent(T)}`}return`${p}?with=all`}function Gr(n,a,s,u,d,p=!1){var Y,Z,ye,ue,oe;const{sidebar:v,ref:k,overlayInfo:T,hebrew:P,english:C,link:D,linkSubtitle:F}=n;if(!v)return;if(!a){v.classList.remove("visible"),v.classList.remove("pinned");return}const j=d(s,a.book,a.chapter,a.verse);if(k&&(k.textContent=`${a.book} ${a.chapter}:${a.verse}`),T){const le=(Y=u==null?void 0:u.renderSidebarInfo)==null?void 0:Y.call(u,a,p);if(le)typeof le=="string"?T.innerHTML=le:T.replaceChildren(le);else{const ge=(Z=u==null?void 0:u.getHoverInfo)==null?void 0:Z.call(u,a);T.textContent=ge||""}}if(P){const le=(j==null?void 0:j.he)||"Loading...",ge=(ye=u==null?void 0:u.highlightVerseText)==null?void 0:ye.call(u,le,"he");ge&&ge!==le?typeof ge=="string"?P.innerHTML=ge:P.replaceChildren(ge):P.textContent=le}if(C){const le=(j==null?void 0:j.en)||"Loading...",ge=(ue=u==null?void 0:u.highlightVerseText)==null?void 0:ue.call(u,le,"en");ge&&ge!==le?typeof ge=="string"?C.innerHTML=ge:C.replaceChildren(ge):C.textContent=le}if(D&&(D.href=Vr(a.book,a.chapter,a.verse,u)),F){const le=(oe=u==null?void 0:u.getLinkSubtitle)==null?void 0:oe.call(u,a);if(le)F.textContent=le;else{const ge=Ur(a.book,a.chapter,a.verse);F.textContent=ge?`${ge} linked texts`:""}}v.classList.add("visible"),p?v.classList.add("pinned"):v.classList.remove("pinned")}function qr(){return{isDragging:!1,hoveredVerse:null,dragStart:{x:0,y:0}}}function Wr(n,a,s){n.isDragging=!0,n.dragStart={x:a,y:s}}function Yr(n){n.isDragging=!1}function Xr(n,a){n.hoveredVerse=a}function Jr(n){n.isDragging=!1,n.hoveredVerse=null}const xe={FUZZY_RADIUS:10,MIN_BRIGHTNESS:.4,BRIGHTNESS_RANGE:.4,OUTLINE_COLOR:[.6,.6,.6],BLEED_PIXELS:3,HIGHLIGHT_COLOR:[.2,.9,1],PINNED_OUTLINE_COLOR:[.2,.9,1],HOVER_OUTLINE_COLOR:[1,1,1],HOVER_WHILE_PINNED_OUTLINE_COLOR:[1,.8,.2],DIM_FACTOR:.3,BRIGHTNESS_FACTOR:1.5,DESATURATE_FACTOR:.2,RARE_NO_MATCH_COLOR:[.25,.25,.25]};function Zr(n,a,s){return{x:n/s.zoom-s.x,y:a/s.zoom-s.y}}function Qr(n,a,s){return n>=s.x&&n<s.x+s.size&&a>=s.y&&a<s.y+s.size}function ei(n,a,s){for(const u of n)if(Qr(a,s,u))return u;return null}function ti(n,a,s){let u=null,d=xe.FUZZY_RADIUS*xe.FUZZY_RADIUS;for(const p of n){const v=p.x+p.size/2,k=p.y+p.size/2,T=a-v,P=s-k,C=T*T+P*P;C<d&&(u=p,d=C)}return u}function hn(n,a,s,u){const{x:d,y:p}=Zr(s,u,a),v=ei(n,d,p);return v||ti(n,d,p)}function ni(n){const a=xe.MIN_BRIGHTNESS+yn(n*3)*xe.BRIGHTNESS_RANGE;return[a,a,a]}function oi(n,a){return(n==null?void 0:n.getVerseColor(a))??null}function ri(n,a){if(a){if(Array.isArray(n[0]))return n.map(s=>[Math.min(1,s[0]*xe.BRIGHTNESS_FACTOR),Math.min(1,s[1]*xe.BRIGHTNESS_FACTOR),Math.min(1,s[2]*xe.BRIGHTNESS_FACTOR)]);{const s=n;return[Math.min(1,s[0]*xe.BRIGHTNESS_FACTOR),Math.min(1,s[1]*xe.BRIGHTNESS_FACTOR),Math.min(1,s[2]*xe.BRIGHTNESS_FACTOR)]}}else return xe.HIGHLIGHT_COLOR}function ii(n,a,s,u){return n.map((d,p)=>{const v=oi(a,d),k=v!==null,T=k?v:ni(p),P=nn(s,d),C=nn(u,d);return{hasOverlayColor:k,baseColor:T,isHovered:P,isPinned:C,isHoveredWhilePinned:P&&u!==null&&!C}})}function ai(n){return n.map(a=>{let s=a.baseColor;return a.isHovered&&(s=ri(s,a.hasOverlayColor)),s})}const si=`#version 300 es
  uniform vec2 u_resolution;
  uniform vec2 u_pan;
  uniform float u_zoom;

  in vec2 a_position;
  in vec3 a_color;
  in vec3 a_color2;
  in vec3 a_color3;
  in vec3 a_color4;
  in float a_colorCount;
  in vec2 a_uv;
  in vec2 a_seed;

  out vec3 v_color;
  out vec3 v_color2;
  out vec3 v_color3;
  out vec3 v_color4;
  flat out int v_colorCount;
  out vec2 v_uv;
  out vec2 v_seed;

  void main() {
    vec2 pos = (a_position + u_pan) * u_zoom;
    vec2 clipSpace = (pos / u_resolution) * 2.0 - 1.0;
    gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);
    v_color = a_color;
    v_color2 = a_color2;
    v_color3 = a_color3;
    v_color4 = a_color4;
    v_colorCount = int(a_colorCount);
    v_uv = a_uv;
    v_seed = a_seed;
  }
`,ci=`#version 300 es
  precision mediump float;
  in vec3 v_color;
  in vec3 v_color2;
  in vec3 v_color3;
  in vec3 v_color4;
  flat in int v_colorCount;
  in vec2 v_uv;
  in vec2 v_seed;
  out vec4 fragColor;

  // Simple hash for dithering noise and stipple selection
  float hash(vec2 p) {
    return fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453);
  }

  // Second hash with different coefficients for variety
  float hash2(vec2 p) {
    return fract(sin(dot(p, vec2(39.346, 11.135))) * 83758.5453);
  }

  void main() {
    vec3 color;

    if (v_colorCount <= 1) {
      // Single color - use directly
      color = v_color;
    } else {
      // Multiple colors with bleed effect
      // UV < 0 or > 1 means we're in the bleed zone
      bool inBleedZone = v_uv.x < 0.0 || v_uv.x > 1.0 || v_uv.y < 0.0 || v_uv.y > 1.0;

      if (inBleedZone) {
        // In bleed zone: sparse scattered pixels
        // Use seed + UV to create unique pattern per verse
        vec2 scatterCoord = floor(v_uv * 8.0) + v_seed * 0.1;
        float scatter = hash(scatterCoord);
        float scatter2 = hash2(scatterCoord);

        // Only render ~30% of pixels in bleed zone (sparse scatter)
        if (scatter > 0.3) {
          discard;
        }

        // Pick a color from the available colors
        int idx = int(floor(scatter2 * float(v_colorCount)));
        if (idx == 0) {
          color = v_color;
        } else if (idx == 1) {
          color = v_color2;
        } else if (idx == 2) {
          color = v_color3;
        } else {
          color = v_color4;
        }
      } else {
        // Inside verse: use seed-varied stipple pattern
        // Combine UV with verse seed for unique pattern per verse
        // Use a 5x5 grid with per-verse offset for more organic feel
        vec2 blockCoord = floor(v_uv * 5.0 + fract(v_seed * 0.0731) * 5.0);
        float h = hash(blockCoord + v_seed * 0.0137);
        int idx = int(floor(h * float(v_colorCount)));

        // Select color based on hash
        if (idx == 0) {
          color = v_color;
        } else if (idx == 1) {
          color = v_color2;
        } else if (idx == 2) {
          color = v_color3;
        } else {
          color = v_color4;
        }
      }
    }

    // Add subtle dithering noise to break up moiré patterns (UV-based for zoom stability)
    vec2 noiseCoord = floor(v_uv * 12.0);
    float noise = (hash(noiseCoord + v_seed * 0.01) - 0.5) * 0.1;
    color = color + noise;

    fragColor = vec4(color, 1.0);
  }
`,ui=`#version 300 es
  uniform vec2 u_resolution;
  uniform vec2 u_pan;
  uniform float u_zoom;

  in vec2 a_position;

  void main() {
    vec2 pos = (a_position + u_pan) * u_zoom;
    vec2 clipSpace = (pos / u_resolution) * 2.0 - 1.0;
    gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);
  }
`,li=`#version 300 es
  precision mediump float;
  uniform vec3 u_color;
  out vec4 fragColor;

  void main() {
    fragColor = vec4(u_color, 1.0);
  }
`;function fi(n){const a=n.getContext("webgl2",{antialias:!0});if(!a)throw new Error("WebGL2 not supported");return a}function on(n,a,s){const u=n.createShader(a);if(!u)throw new Error("Failed to create shader");if(n.shaderSource(u,s),n.compileShader(u),!n.getShaderParameter(u,n.COMPILE_STATUS))throw new Error(n.getShaderInfoLog(u)||"Shader compilation failed");return u}function di(n){const a=on(n,n.VERTEX_SHADER,si),s=on(n,n.FRAGMENT_SHADER,ci),u=n.createProgram();if(!u)throw new Error("Failed to create program");if(n.attachShader(u,a),n.attachShader(u,s),n.linkProgram(u),!n.getProgramParameter(u,n.LINK_STATUS))throw new Error(n.getProgramInfoLog(u)||"Program linking failed");return{program:u,attribs:{position:n.getAttribLocation(u,"a_position"),color:n.getAttribLocation(u,"a_color"),color2:n.getAttribLocation(u,"a_color2"),color3:n.getAttribLocation(u,"a_color3"),color4:n.getAttribLocation(u,"a_color4"),colorCount:n.getAttribLocation(u,"a_colorCount"),uv:n.getAttribLocation(u,"a_uv"),seed:n.getAttribLocation(u,"a_seed")},uniforms:{resolution:n.getUniformLocation(u,"u_resolution"),pan:n.getUniformLocation(u,"u_pan"),zoom:n.getUniformLocation(u,"u_zoom")}}}function hi(n){const a=on(n,n.VERTEX_SHADER,ui),s=on(n,n.FRAGMENT_SHADER,li),u=n.createProgram();if(!u)throw new Error("Failed to create program");if(n.attachShader(u,a),n.attachShader(u,s),n.linkProgram(u),!n.getProgramParameter(u,n.LINK_STATUS))throw new Error(n.getProgramInfoLog(u)||"Program linking failed");return{program:u,attribs:{position:n.getAttribLocation(u,"a_position")},uniforms:{resolution:n.getUniformLocation(u,"u_resolution"),pan:n.getUniformLocation(u,"u_pan"),zoom:n.getUniformLocation(u,"u_zoom"),color:n.getUniformLocation(u,"u_color")}}}function pi(n){return Array.isArray(n)&&Array.isArray(n[0])}function Co(n,a,s=xe.OUTLINE_COLOR){const p=new Float32Array(n.length*6*19);let v=0;for(let k=0;k<n.length;k++){const T=n[k],P=a==null?void 0:a[k];let C;Array.isArray(P)&&P.length===0?C=[s]:pi(P)?C=P.slice(0,4):C=[P||s];const D=C.length,F=D>1,j=F?xe.BLEED_PIXELS:0,Y=T.x-j,Z=T.y-j,ye=T.x+T.size-2+j,ue=T.y+T.size-2+j,oe=F?-j/(T.size-2):0,le=F?1+j/(T.size-2):1,ge=T.x,Tt=T.y;for(;C.length<4;)C.push([0,0,0]);const Fe=(ot,At,rt,ze)=>{p[v++]=ot,p[v++]=At;for(let Ve=0;Ve<4;Ve++)p[v++]=C[Ve][0],p[v++]=C[Ve][1],p[v++]=C[Ve][2];p[v++]=D,p[v++]=rt,p[v++]=ze,p[v++]=ge,p[v++]=Tt};Fe(Y,Z,oe,oe),Fe(ye,Z,le,oe),Fe(Y,ue,oe,le),Fe(Y,ue,oe,le),Fe(ye,Z,le,oe),Fe(ye,ue,le,le)}return p}function To(n,a){const s=n.createBuffer();if(!s)throw new Error("Failed to create buffer");return n.bindBuffer(n.ARRAY_BUFFER,s),n.bufferData(n.ARRAY_BUFFER,a,n.STATIC_DRAW),s}function mi(n,a={}){const s=a.thickness??2,u=a.color??xe.OUTLINE_COLOR,d=19,p=6,v=4,k=new Float32Array(v*p*d),T=n.x-s,P=n.y-s,C=n.x+n.size-2+s,D=n.y+n.size-2+s,F=n.x,j=n.y;let Y=0;const Z=(ue,oe)=>{k[Y++]=ue,k[Y++]=oe;for(let le=0;le<4;le++)k[Y++]=u[0],k[Y++]=u[1],k[Y++]=u[2];k[Y++]=1,k[Y++]=0,k[Y++]=0,k[Y++]=F,k[Y++]=j},ye=(ue,oe,le,ge)=>{Z(ue,oe),Z(le,oe),Z(ue,ge),Z(ue,ge),Z(le,oe),Z(le,ge)};return ye(T,P,C,P+s),ye(C-s,P,C,D),ye(T,D-s,C,D),ye(T,P,T+s,D),k}function gi(n){const a=fi(n),s={main:di(a),outline:hi(a)};return{gl:a,programs:s,canvas:n}}function vi(n,a,s){const u=Co(a);return{buffer:To(n,u),outlineBuffer:null,hoverOutlineBuffer:null,verses:a,dpr:s}}function yi(n,a,s){const u=Co(a.verses,s);n.bindBuffer(n.ARRAY_BUFFER,a.buffer),n.bufferData(n.ARRAY_BUFFER,u,n.STATIC_DRAW)}function bi(n,a,s,u,d){const{gl:p,programs:v,canvas:k}=n,{buffer:T,verses:P,dpr:C}=a;p.viewport(0,0,k.width,k.height),p.clearColor(.1,.1,.1,1),p.clear(p.COLOR_BUFFER_BIT),p.useProgram(v.main.program),p.uniform2f(v.main.uniforms.resolution,k.width,k.height),p.uniform2f(v.main.uniforms.pan,s.x,s.y),p.uniform1f(v.main.uniforms.zoom,s.zoom*C),p.bindBuffer(p.ARRAY_BUFFER,T);const D=19*4;if(p.enableVertexAttribArray(v.main.attribs.position),p.vertexAttribPointer(v.main.attribs.position,2,p.FLOAT,!1,D,0),p.enableVertexAttribArray(v.main.attribs.color),p.vertexAttribPointer(v.main.attribs.color,3,p.FLOAT,!1,D,2*4),p.enableVertexAttribArray(v.main.attribs.color2),p.vertexAttribPointer(v.main.attribs.color2,3,p.FLOAT,!1,D,5*4),p.enableVertexAttribArray(v.main.attribs.color3),p.vertexAttribPointer(v.main.attribs.color3,3,p.FLOAT,!1,D,8*4),p.enableVertexAttribArray(v.main.attribs.color4),p.vertexAttribPointer(v.main.attribs.color4,3,p.FLOAT,!1,D,11*4),p.enableVertexAttribArray(v.main.attribs.colorCount),p.vertexAttribPointer(v.main.attribs.colorCount,1,p.FLOAT,!1,D,14*4),p.enableVertexAttribArray(v.main.attribs.uv),p.vertexAttribPointer(v.main.attribs.uv,2,p.FLOAT,!1,D,15*4),p.enableVertexAttribArray(v.main.attribs.seed),p.vertexAttribPointer(v.main.attribs.seed,2,p.FLOAT,!1,D,17*4),p.drawArrays(p.TRIANGLES,0,P.length*6),u&&!nn(u,d)){const F=d?xe.HOVER_WHILE_PINNED_OUTLINE_COLOR:xe.HOVER_OUTLINE_COLOR;a.hoverOutlineBuffer=Yn(n,a,u,F,a.hoverOutlineBuffer,s)}d&&(a.outlineBuffer=Yn(n,a,d,xe.PINNED_OUTLINE_COLOR,a.outlineBuffer,s)),window.bookLabels&&wn(window.bookLabels,{x:s.x,y:s.y},s.zoom)}function Yn(n,a,s,u,d,p){const{gl:v,programs:k,canvas:T}=n,{dpr:P}=a,C=mi({x:s.x,y:s.y,size:s.size},{thickness:2,color:u});let D=d;D?(v.bindBuffer(v.ARRAY_BUFFER,D),v.bufferData(v.ARRAY_BUFFER,C,v.STATIC_DRAW)):D=To(v,C),v.useProgram(k.outline.program),v.uniform2f(k.outline.uniforms.resolution,T.width,T.height),v.uniform2f(k.outline.uniforms.pan,p.x,p.y),v.uniform1f(k.outline.uniforms.zoom,p.zoom*P),v.uniform3f(k.outline.uniforms.color,...u),v.bindBuffer(v.ARRAY_BUFFER,D);const F=19*4;return v.enableVertexAttribArray(k.outline.attribs.position),v.vertexAttribPointer(k.outline.attribs.position,2,v.FLOAT,!1,F,0),v.drawArrays(v.TRIANGLES,0,24),D}const Mn=new Map;function jt(n){Mn.set(n.id,n)}function wi(n){return Mn.get(n)}function xi(){return Array.from(Mn.values())}const Ao=[{unicode:"֒",codePoint:1426,name:"Segol",hebrewName:"סגול"},{unicode:"֓",codePoint:1427,name:"Shalshelet",hebrewName:"שלשלת"},{unicode:"֔",codePoint:1428,name:"Zaqef Qatan",hebrewName:"זקף קטן"},{unicode:"֕",codePoint:1429,name:"Zaqef Gadol",hebrewName:"זקף גדול"},{unicode:"֖",codePoint:1430,name:"Tipcha",hebrewName:"טפחא"},{unicode:"֗",codePoint:1431,name:"Revia",hebrewName:"רביע"},{unicode:"֘",codePoint:1432,name:"Zarqa",hebrewName:"זרקא"},{unicode:"֙",codePoint:1433,name:"Pashta",hebrewName:"פשטא"},{unicode:"֚",codePoint:1434,name:"Yetiv",hebrewName:"יתיב"},{unicode:"֛",codePoint:1435,name:"Tevir",hebrewName:"תביר"},{unicode:"֜",codePoint:1436,name:"Geresh",hebrewName:"גרש"},{unicode:"֝",codePoint:1437,name:"Geresh Muqdam",hebrewName:"גרש מוקדם"},{unicode:"֞",codePoint:1438,name:"Gershayim",hebrewName:"גרשיים"},{unicode:"֟",codePoint:1439,name:"Karnei Parah",hebrewName:"קרני פרה"},{unicode:"֠",codePoint:1440,name:"Telisha Gedola",hebrewName:"תלישא גדולה"},{unicode:"֡",codePoint:1441,name:"Pazer",hebrewName:"פזר"},{unicode:"֣",codePoint:1443,name:"Munach",hebrewName:"מונח"},{unicode:"֤",codePoint:1444,name:"Mahapakh",hebrewName:"מהפך"},{unicode:"֥",codePoint:1445,name:"Merkha",hebrewName:"מרכא"},{unicode:"֦",codePoint:1446,name:"Merkha Kefula",hebrewName:"מרכא כפולה"},{unicode:"֧",codePoint:1447,name:"Darga",hebrewName:"דרגא"},{unicode:"֨",codePoint:1448,name:"Qadma",hebrewName:"קדמא"},{unicode:"֩",codePoint:1449,name:"Telisha Qetana",hebrewName:"תלישא קטנה"},{unicode:"֪",codePoint:1450,name:"Yerah Ben Yomo",hebrewName:"ירח בן יומו"},{unicode:"֫",codePoint:1451,name:"Ole",hebrewName:"עולה"},{unicode:"֬",codePoint:1452,name:"Iluy",hebrewName:"אילוי"},{unicode:"֭",codePoint:1453,name:"Dehi",hebrewName:"דחי"},{unicode:"֮",codePoint:1454,name:"Zinor",hebrewName:"זינור"},{unicode:"֑",codePoint:1425,name:"Etnachta",hebrewName:"אתנחתא"},{unicode:"֢",codePoint:1442,name:"Atnah Hafukh",hebrewName:"אתנח הפוך"},{unicode:"֯",codePoint:1455,name:"Masora Circle",hebrewName:"עיגול מסורה"}];new Map(Ao.map(n=>[n.unicode,n]));const Xn={RARE:50,UNCOMMON:500};function Kt(n){return n<Xn.RARE?"rare":n<Xn.UNCOMMON?"uncommon":"common"}function Ei(n){const a=[];for(const s of n){const u=s.codePointAt(0);u&&u>=1425&&u<=1455&&a.push(s)}return a}function Si(n){const a=new Map,s=Ei(n);for(const u of s)a.set(u,(a.get(u)||0)+1);return a}function ki(n){const a=new Map;for(const s of Ao)a.set(s.unicode,{unicode:s.unicode,name:s.name,hebrewName:s.hebrewName,totalCount:0,verses:[]});for(const[s,u]of Object.entries(n))for(const[d,p]of Object.entries(u)){const v=parseInt(d,10);for(const[k,T]of Object.entries(p)){const P=parseInt(k,10),C=Si(T.he);for(const[D,F]of C){const j=a.get(D);j&&(j.totalCount+=F,j.verses.push({book:s,chapter:v,verse:P,count:F}))}}}return a}function Ci(n){return Array.from(n.values()).filter(a=>a.totalCount>0).sort((a,s)=>a.totalCount-s.totalCount)}let Jn=new Map,rn=[],Ee=null,ft=null,Wt=new Map,Nt=1,an="common";const Ti=[1,.84,0];function fn(){if(Wt.clear(),!!Ee){an=Kt(Ee.totalCount);for(const n of Ee.verses){const a=$e(n.book,n.chapter,n.verse);Wt.set(a,n.count)}Nt=1;for(const n of Ee.verses)n.count>Nt&&(Nt=n.count)}}const Ai=[{t:0,color:[.4,.2,.6]},{t:1,color:[.9,.4,.95]}],Ii=[{t:0,color:[.2,.1,.3]},{t:.33,color:[.4,.2,.5]},{t:.66,color:[.7,.3,.7]},{t:1,color:[.95,.6,.9]}];function Oi(n){if(!Ee)return null;Wt.size===0&&fn();const a=$e(n.book,n.chapter,n.verse),s=Wt.get(a)||0;return an==="rare"?s>0?Ti:xe.RARE_NO_MATCH_COLOR:an==="uncommon"?s===0?[.25,.25,.28]:En(s,Nt,Ai):s===0?[.25,.23,.28]:En(s,Nt,Ii,{useLog:!0})}function Pi(n){n.innerHTML=`
    <div class="trop-controls">
      <label style="margin-bottom: 8px;">Select Trop Mark</label>
      <div class="trop-chart"></div>
      <div class="trop-info"></div>
    </div>
  `;const a=n.querySelector(".trop-chart"),s=n.querySelector(".trop-info");let u=null;for(const d of rn){const p=document.createElement("button");p.textContent="ב"+d.unicode,p.title=`${d.name} (${d.hebrewName})`;const v=Kt(d.totalCount);if(v==="rare"&&p.classList.add("rare"),p.addEventListener("mouseenter",()=>{const k=v==="rare"?"Rare":v==="uncommon"?"Uncommon":"Common";s.textContent=`${d.name} (${d.hebrewName}) · ${d.totalCount.toLocaleString()} occurrences · ${k}`}),p.addEventListener("mouseleave",()=>{if(!u)s.textContent="";else{const k=rn.find(T=>T.unicode===(u==null?void 0:u.dataset.unicode));if(k){const T=Kt(k.totalCount),P=T==="rare"?"Rare":T==="uncommon"?"Uncommon":"Common";s.textContent=`${k.name} (${k.hebrewName}) · ${k.totalCount.toLocaleString()} · ${P}`}}}),p.addEventListener("click",()=>{u===p?(p.classList.remove("selected"),u=null,Ee=null,s.textContent=""):(u&&u.classList.remove("selected"),p.classList.add("selected"),u=p,Ee=d),fn(),ft==null||ft()}),p.dataset.unicode=d.unicode,a.appendChild(p),Ee&&d.unicode===Ee.unicode){p.classList.add("selected"),u=p;const k=Kt(d.totalCount),T=k==="rare"?"Rare":k==="uncommon"?"Uncommon":"Common";s.textContent=`${d.name} (${d.hebrewName}) · ${d.totalCount.toLocaleString()} · ${T}`}}}const Mi={id:"trop",name:"Cantillation (Trop)",async init(){},destroy(){ft=null,Wt.clear(),Nt=1,an="common"},onUpdate(n){ft=n},getVerseColor(n){return Oi(n)},renderControls(n){Pi(n)},renderLegend(n){if(!Ee){n.innerHTML='<div style="color: #666; font-size: 11px;">Select a trop mark above</div>';return}Kt(Ee.totalCount)==="rare"?n.innerHTML=`
        <div class="legend-row"><span class="swatch" style="background: rgb(255, 214, 0)"></span><span>Contains ${Ee.name}</span></div>
        <div class="legend-row"><span class="swatch" style="background: rgb(64, 64, 64)"></span><span>Does not contain</span></div>
      `:n.innerHTML=`
        <div class="legend-gradient" style="background: linear-gradient(to right, #3f3b47, #5a3f7a, #a060a0, #e090c0);"></div>
        <div style="display: flex; justify-content: space-between; font-size: 10px; color: #888;">
          <span>0</span>
          <span>Count</span>
          <span>Max</span>
        </div>
      `},getHoverInfo(n){if(!Ee)return null;const a=Ee.verses.find(s=>s.book===n.book&&s.chapter===n.chapter&&s.verse===n.verse);return a?`${Ee.name} ×${a.count}`:null},getUrlParams(){return Ee?{trop:Ee.name.toLowerCase().replace(/\s+/g,"-")}:{}},applyUrlParams(n){const a=n.get("trop");if(a){const s=rn.find(u=>u.name.toLowerCase().replace(/\s+/g,"-")===a);s&&(Ee=s,fn(),ft==null||ft())}},highlightVerseText(n,a){return a!=="he"||!Ee?n:Ri(n,Ee.unicode)}};function Ni(n){Jn=ki(n.verseTexts),rn=Ci(Jn),Ee=null,fn()}function Ri(n,a){const s=[];let u=0;for(;u<n.length;){const d=n[u];if(d===a)if(s.length>0){const p=[];for(;s.length>0;){const k=s[s.length-1].codePointAt(0)||0;if(k>=1425&&k<=1479)p.unshift(s.pop());else{p.unshift(s.pop());break}}p.push(d),s.push(`<mark class="trop-highlight">${p.join("")}</mark>`)}else s.push(`<mark class="trop-highlight">${d}</mark>`);else s.push(d);u++}return s.join("")}var Li=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _i(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Io={exports:{}};/*!
 * 
 *   simple-keyboard v3.8.93
 *   https://github.com/hodgef/simple-keyboard
 *
 *   Copyright (c) Francisco Hodge (https://github.com/hodgef) and project contributors.
 *
 *   This source code is licensed under the MIT license found in the
 *   LICENSE file in the root directory of this source tree.
 *
 */(function(n,a){(function(s,u){n.exports=u()})(Li,function(){return function(){var s={34:function(c,f,e){var t=e(4901);c.exports=function(o){return typeof o=="object"?o!==null:t(o)}},81:function(c,f,e){var t=e(9565),o=e(9306),r=e(8551),i=e(6823),l=e(851),h=TypeError;c.exports=function(m,g){var y=arguments.length<2?l(m):g;if(o(y))return r(t(y,m));throw new h(i(m)+" is not iterable")}},235:function(c,f,e){var t=e(9213).forEach,o=e(4598)("forEach");c.exports=o?[].forEach:function(r){return t(this,r,arguments.length>1?arguments[1]:void 0)}},283:function(c,f,e){var t=e(9504),o=e(9039),r=e(4901),i=e(9297),l=e(3724),h=e(350).CONFIGURABLE,m=e(3706),g=e(1181),y=g.enforce,E=g.get,w=String,b=Object.defineProperty,S=t("".slice),x=t("".replace),I=t([].join),A=l&&!o(function(){return b(function(){},"length",{value:8}).length!==8}),O=String(String).split("String"),N=c.exports=function(M,$,L){S(w($),0,7)==="Symbol("&&($="["+x(w($),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),L&&L.getter&&($="get "+$),L&&L.setter&&($="set "+$),(!i(M,"name")||h&&M.name!==$)&&(l?b(M,"name",{value:$,configurable:!0}):M.name=$),A&&L&&i(L,"arity")&&M.length!==L.arity&&b(M,"length",{value:L.arity});try{L&&i(L,"constructor")&&L.constructor?l&&b(M,"prototype",{writable:!1}):M.prototype&&(M.prototype=void 0)}catch{}var R=y(M);return i(R,"source")||(R.source=I(O,typeof $=="string"?$:"")),M};Function.prototype.toString=N(function(){return r(this)&&E(this).source||m(this)},"toString")},298:function(c,f,e){var t=e(2195),o=e(5397),r=e(8480).f,i=e(7680),l=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];c.exports.f=function(h){return l&&t(h)==="Window"?function(m){try{return r(m)}catch{return i(l)}}(h):r(o(h))}},350:function(c,f,e){var t=e(3724),o=e(9297),r=Function.prototype,i=t&&Object.getOwnPropertyDescriptor,l=o(r,"name"),h=l&&(function(){}).name==="something",m=l&&(!t||t&&i(r,"name").configurable);c.exports={EXISTS:l,PROPER:h,CONFIGURABLE:m}},397:function(c,f,e){var t=e(7751);c.exports=t("document","documentElement")},421:function(c){c.exports={}},511:function(c,f,e){var t=e(9167),o=e(9297),r=e(1951),i=e(4913).f;c.exports=function(l){var h=t.Symbol||(t.Symbol={});o(h,l)||i(h,l,{value:r.f(l)})}},566:function(c,f,e){var t=e(9504),o=e(9306),r=e(34),i=e(9297),l=e(7680),h=e(616),m=Function,g=t([].concat),y=t([].join),E={};c.exports=h?m.bind:function(w){var b=o(this),S=b.prototype,x=l(arguments,1),I=function(){var A=g(x,l(arguments));return this instanceof I?function(O,N,M){if(!i(E,N)){for(var $=[],L=0;L<N;L++)$[L]="a["+L+"]";E[N]=m("C,a","return new C("+y($,",")+")")}return E[N](O,M)}(b,A.length,A):b.apply(w,A)};return r(S)&&(I.prototype=S),I}},597:function(c,f,e){var t=e(9039),o=e(8227),r=e(9519),i=o("species");c.exports=function(l){return r>=51||!t(function(){var h=[];return(h.constructor={})[i]=function(){return{foo:1}},h[l](Boolean).foo!==1})}},616:function(c,f,e){var t=e(9039);c.exports=!t(function(){var o=(function(){}).bind();return typeof o!="function"||o.hasOwnProperty("prototype")})},655:function(c,f,e){var t=e(6955),o=String;c.exports=function(r){if(t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return o(r)}},687:function(c,f,e){var t=e(4913).f,o=e(9297),r=e(8227)("toStringTag");c.exports=function(i,l,h){i&&!h&&(i=i.prototype),i&&!o(i,r)&&t(i,r,{configurable:!0,value:l})}},706:function(c,f,e){var t=e(350).PROPER,o=e(9039),r=e(7452);c.exports=function(i){return o(function(){return!!r[i]()||"​᠎"[i]()!=="​᠎"||t&&r[i].name!==i})}},739:function(c,f,e){var t=e(6518),o=e(9039),r=e(8981),i=e(2777);t({target:"Date",proto:!0,arity:1,forced:o(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1})},{toJSON:function(l){var h=r(this),m=i(h,"number");return typeof m!="number"||isFinite(m)?h.toISOString():null}})},741:function(c){var f=Math.ceil,e=Math.floor;c.exports=Math.trunc||function(t){var o=+t;return(o>0?e:f)(o)}},744:function(c,f,e){var t=e(9565),o=e(9504),r=e(9228),i=e(8551),l=e(34),h=e(7750),m=e(2293),g=e(7829),y=e(8014),E=e(655),w=e(5966),b=e(6682),S=e(8429),x=e(9039),I=S.UNSUPPORTED_Y,A=Math.min,O=o([].push),N=o("".slice),M=!x(function(){var L=/(?:)/,R=L.exec;L.exec=function(){return R.apply(this,arguments)};var H="ab".split(L);return H.length!==2||H[0]!=="a"||H[1]!=="b"}),$="abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length;r("split",function(L,R,H){var U="0".split(void 0,0).length?function(_,ee){return _===void 0&&ee===0?[]:t(R,this,_,ee)}:R;return[function(_,ee){var V=h(this),G=l(_)?w(_,L):void 0;return G?t(G,_,V,ee):t(U,E(V),_,ee)},function(_,ee){var V=i(this),G=E(_);if(!$){var pe=H(U,V,G,ee,U!==R);if(pe.done)return pe.value}var fe=m(V,RegExp),W=V.unicode,ne=(V.ignoreCase?"i":"")+(V.multiline?"m":"")+(V.unicode?"u":"")+(I?"g":"y"),Q=new fe(I?"^(?:"+V.source+")":V,ne),X=ee===void 0?4294967295:ee>>>0;if(X===0)return[];if(G.length===0)return b(Q,G)===null?[G]:[];for(var te=0,re=0,K=[];re<G.length;){Q.lastIndex=I?0:re;var q,z=b(Q,I?N(G,re):G);if(z===null||(q=A(y(Q.lastIndex+(I?re:0)),G.length))===te)re=g(G,re,W);else{if(O(K,N(G,te,re)),K.length===X)return K;for(var J=1;J<=z.length-1;J++)if(O(K,z[J]),K.length===X)return K;re=te=q}}return O(K,N(G,te)),K}]},$||!M,I)},757:function(c,f,e){var t=e(7751),o=e(4901),r=e(1625),i=e(7040),l=Object;c.exports=i?function(h){return typeof h=="symbol"}:function(h){var m=t("Symbol");return o(m)&&r(m.prototype,l(h))}},788:function(c,f,e){var t=e(34),o=e(2195),r=e(8227)("match");c.exports=function(i){var l;return t(i)&&((l=i[r])!==void 0?!!l:o(i)==="RegExp")}},825:function(c,f,e){var t=e(6518),o=e(7751),r=e(8745),i=e(566),l=e(5548),h=e(8551),m=e(34),g=e(2360),y=e(9039),E=o("Reflect","construct"),w=Object.prototype,b=[].push,S=y(function(){function A(){}return!(E(function(){},[],A)instanceof A)}),x=!y(function(){E(function(){})}),I=S||x;t({target:"Reflect",stat:!0,forced:I,sham:I},{construct:function(A,O){l(A),h(O);var N=arguments.length<3?A:l(arguments[2]);if(x&&!S)return E(A,O,N);if(A===N){switch(O.length){case 0:return new A;case 1:return new A(O[0]);case 2:return new A(O[0],O[1]);case 3:return new A(O[0],O[1],O[2]);case 4:return new A(O[0],O[1],O[2],O[3])}var M=[null];return r(b,M,O),new(r(i,A,M))}var $=N.prototype,L=g(m($)?$:w),R=r(A,L,O);return m(R)?R:L}})},851:function(c,f,e){var t=e(6955),o=e(5966),r=e(4117),i=e(6269),l=e(8227)("iterator");c.exports=function(h){if(!r(h))return o(h,l)||o(h,"@@iterator")||i[t(h)]}},926:function(c,f,e){var t=e(9306),o=e(8981),r=e(7055),i=e(6198),l=TypeError,h="Reduce of empty array with no initial value",m=function(g){return function(y,E,w,b){var S=o(y),x=r(S),I=i(S);if(t(E),I===0&&w<2)throw new l(h);var A=g?I-1:0,O=g?-1:1;if(w<2)for(;;){if(A in x){b=x[A],A+=O;break}if(A+=O,g?A<0:I<=A)throw new l(h)}for(;g?A>=0:I>A;A+=O)A in x&&(b=E(b,x[A],A,S));return b}};c.exports={left:m(!1),right:m(!0)}},1034:function(c,f,e){var t=e(9565),o=e(9297),r=e(1625),i=e(5213),l=e(7979),h=RegExp.prototype;c.exports=i.correct?function(m){return m.flags}:function(m){return i.correct||!r(h,m)||o(m,"flags")?m.flags:t(l,m)}},1056:function(c,f,e){var t=e(4913).f;c.exports=function(o,r,i){i in o||t(o,i,{configurable:!0,get:function(){return r[i]},set:function(l){r[i]=l}})}},1072:function(c,f,e){var t=e(1828),o=e(8727);c.exports=Object.keys||function(r){return t(r,o)}},1088:function(c,f,e){var t=e(6518),o=e(9565),r=e(6395),i=e(350),l=e(4901),h=e(3994),m=e(2787),g=e(2967),y=e(687),E=e(6699),w=e(6840),b=e(8227),S=e(6269),x=e(7657),I=i.PROPER,A=i.CONFIGURABLE,O=x.IteratorPrototype,N=x.BUGGY_SAFARI_ITERATORS,M=b("iterator"),$="keys",L="values",R="entries",H=function(){return this};c.exports=function(U,_,ee,V,G,pe,fe){h(ee,_,V);var W,ne,Q,X=function(me){if(me===G&&z)return z;if(!N&&me&&me in K)return K[me];switch(me){case $:case L:case R:return function(){return new ee(this,me)}}return function(){return new ee(this)}},te=_+" Iterator",re=!1,K=U.prototype,q=K[M]||K["@@iterator"]||G&&K[G],z=!N&&q||X(G),J=_==="Array"&&K.entries||q;if(J&&(W=m(J.call(new U)))!==Object.prototype&&W.next&&(r||m(W)===O||(g?g(W,O):l(W[M])||w(W,M,H)),y(W,te,!0,!0),r&&(S[te]=H)),I&&G===L&&q&&q.name!==L&&(!r&&A?E(K,"name",L):(re=!0,z=function(){return o(q,this)})),G)if(ne={values:X(L),keys:pe?z:X($),entries:X(R)},fe)for(Q in ne)(N||re||!(Q in K))&&w(K,Q,ne[Q]);else t({target:_,proto:!0,forced:N||re},ne);return r&&!fe||K[M]===z||w(K,M,z,{name:G}),S[_]=z,ne}},1181:function(c,f,e){var t,o,r,i=e(8622),l=e(4576),h=e(34),m=e(6699),g=e(9297),y=e(7629),E=e(6119),w=e(421),b="Object already initialized",S=l.TypeError,x=l.WeakMap;if(i||y.state){var I=y.state||(y.state=new x);I.get=I.get,I.has=I.has,I.set=I.set,t=function(O,N){if(I.has(O))throw new S(b);return N.facade=O,I.set(O,N),N},o=function(O){return I.get(O)||{}},r=function(O){return I.has(O)}}else{var A=E("state");w[A]=!0,t=function(O,N){if(g(O,A))throw new S(b);return N.facade=O,m(O,A,N),N},o=function(O){return g(O,A)?O[A]:{}},r=function(O){return g(O,A)}}c.exports={set:t,get:o,has:r,enforce:function(O){return r(O)?o(O):t(O,{})},getterFor:function(O){return function(N){var M;if(!h(N)||(M=o(N)).type!==O)throw new S("Incompatible receiver, "+O+" required");return M}}}},1240:function(c,f,e){var t=e(9504);c.exports=t(1.1.valueOf)},1278:function(c,f,e){var t=e(6518),o=e(3724),r=e(5031),i=e(5397),l=e(7347),h=e(4659);t({target:"Object",stat:!0,sham:!o},{getOwnPropertyDescriptors:function(m){for(var g,y,E=i(m),w=l.f,b=r(E),S={},x=0;b.length>x;)(y=w(E,g=b[x++]))!==void 0&&h(S,g,y);return S}})},1291:function(c,f,e){var t=e(741);c.exports=function(o){var r=+o;return r!=r||r===0?0:t(r)}},1296:function(c,f,e){var t=e(4495);c.exports=t&&!!Symbol.for&&!!Symbol.keyFor},1436:function(c,f,e){var t=e(8227)("match");c.exports=function(o){var r=/./;try{"/./"[o](r)}catch{try{return r[t]=!1,"/./"[o](r)}catch{}}return!1}},1469:function(c,f,e){var t=e(7433);c.exports=function(o,r){return new(t(o))(r===0?0:r)}},1480:function(c,f,e){var t=e(6518),o=e(9039),r=e(298).f;t({target:"Object",stat:!0,forced:o(function(){return!Object.getOwnPropertyNames(1)})},{getOwnPropertyNames:r})},1510:function(c,f,e){var t=e(6518),o=e(7751),r=e(9297),i=e(655),l=e(5745),h=e(1296),m=l("string-to-symbol-registry"),g=l("symbol-to-string-registry");t({target:"Symbol",stat:!0,forced:!h},{for:function(y){var E=i(y);if(r(m,E))return m[E];var w=o("Symbol")(E);return m[E]=w,g[w]=E,w}})},1625:function(c,f,e){var t=e(9504);c.exports=t({}.isPrototypeOf)},1699:function(c,f,e){var t=e(6518),o=e(9504),r=e(5749),i=e(7750),l=e(655),h=e(1436),m=o("".indexOf);t({target:"String",proto:!0,forced:!h("includes")},{includes:function(g){return!!~m(l(i(this)),l(r(g)),arguments.length>1?arguments[1]:void 0)}})},1761:function(c,f,e){var t=e(9565),o=e(9504),r=e(9228),i=e(8551),l=e(34),h=e(8014),m=e(655),g=e(7750),y=e(5966),E=e(7829),w=e(1034),b=e(6682),S=o("".indexOf);r("match",function(x,I,A){return[function(O){var N=g(this),M=l(O)?y(O,x):void 0;return M?t(M,O,N):new RegExp(O)[x](m(N))},function(O){var N=i(this),M=m(O),$=A(I,N,M);if($.done)return $.value;var L=m(w(N));if(S(L,"g")===-1)return b(N,M);var R=S(L,"u")!==-1;N.lastIndex=0;for(var H,U=[],_=0;(H=b(N,M))!==null;){var ee=m(H[0]);U[_]=ee,ee===""&&(N.lastIndex=E(M,h(N.lastIndex),R)),_++}return _===0?null:U}]})},1828:function(c,f,e){var t=e(9504),o=e(9297),r=e(5397),i=e(9617).indexOf,l=e(421),h=t([].push);c.exports=function(m,g){var y,E=r(m),w=0,b=[];for(y in E)!o(l,y)&&o(E,y)&&h(b,y);for(;g.length>w;)o(E,y=g[w++])&&(~i(b,y)||h(b,y));return b}},1951:function(c,f,e){var t=e(8227);f.f=t},2008:function(c,f,e){var t=e(6518),o=e(9213).filter;t({target:"Array",proto:!0,forced:!e(597)("filter")},{filter:function(r){return o(this,r,arguments.length>1?arguments[1]:void 0)}})},2010:function(c,f,e){var t=e(3724),o=e(350).EXISTS,r=e(9504),i=e(2106),l=Function.prototype,h=r(l.toString),m=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,g=r(m.exec);t&&!o&&i(l,"name",{configurable:!0,get:function(){try{return g(m,h(this))[1]}catch{return""}}})},2062:function(c,f,e){var t=e(6518),o=e(9213).map;t({target:"Array",proto:!0,forced:!e(597)("map")},{map:function(r){return o(this,r,arguments.length>1?arguments[1]:void 0)}})},2087:function(c,f,e){var t=e(34),o=Math.floor;c.exports=Number.isInteger||function(r){return!t(r)&&isFinite(r)&&o(r)===r}},2106:function(c,f,e){var t=e(283),o=e(4913);c.exports=function(r,i,l){return l.get&&t(l.get,i,{getter:!0}),l.set&&t(l.set,i,{setter:!0}),o.f(r,i,l)}},2140:function(c,f,e){var t={};t[e(8227)("toStringTag")]="z",c.exports=String(t)==="[object z]"},2195:function(c,f,e){var t=e(9504),o=t({}.toString),r=t("".slice);c.exports=function(i){return r(o(i),8,-1)}},2211:function(c,f,e){var t=e(9039);c.exports=!t(function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype})},2259:function(c,f,e){e(511)("iterator")},2293:function(c,f,e){var t=e(8551),o=e(5548),r=e(4117),i=e(8227)("species");c.exports=function(l,h){var m,g=t(l).constructor;return g===void 0||r(m=t(g)[i])?h:o(m)}},2360:function(c,f,e){var t,o=e(8551),r=e(6801),i=e(8727),l=e(421),h=e(397),m=e(4055),g=e(6119),y="prototype",E="script",w=g("IE_PROTO"),b=function(){},S=function(A){return"<"+E+">"+A+"</"+E+">"},x=function(A){A.write(S("")),A.close();var O=A.parentWindow.Object;return A=null,O},I=function(){try{t=new ActiveXObject("htmlfile")}catch{}var A,O,N;I=typeof document<"u"?document.domain&&t?x(t):(O=m("iframe"),N="java"+E+":",O.style.display="none",h.appendChild(O),O.src=String(N),(A=O.contentWindow.document).open(),A.write(S("document.F=Object")),A.close(),A.F):x(t);for(var M=i.length;M--;)delete I[y][i[M]];return I()};l[w]=!0,c.exports=Object.create||function(A,O){var N;return A!==null?(b[y]=o(A),N=new b,b[y]=null,N[w]=A):N=I(),O===void 0?N:r.f(N,O)}},2478:function(c,f,e){var t=e(9504),o=e(8981),r=Math.floor,i=t("".charAt),l=t("".replace),h=t("".slice),m=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,g=/\$([$&'`]|\d{1,2})/g;c.exports=function(y,E,w,b,S,x){var I=w+y.length,A=b.length,O=g;return S!==void 0&&(S=o(S),O=m),l(x,O,function(N,M){var $;switch(i(M,0)){case"$":return"$";case"&":return y;case"`":return h(E,0,w);case"'":return h(E,I);case"<":$=S[h(M,1,-1)];break;default:var L=+M;if(L===0)return N;if(L>A){var R=r(L/10);return R===0?N:R<=A?b[R-1]===void 0?i(M,1):b[R-1]+i(M,1):N}$=b[L-1]}return $===void 0?"":$})}},2529:function(c){c.exports=function(f,e){return{value:f,done:e}}},2551:function(c,f,e){var t=e(6395),o=e(4576),r=e(9039),i=e(3607);c.exports=t||!r(function(){if(!(i&&i<535)){var l=Math.random();__defineSetter__.call(null,l,function(){}),delete o[l]}})},2637:function(c,f,e){e(6518)({target:"Number",stat:!0},{isInteger:e(2087)})},2675:function(c,f,e){e(6761),e(1510),e(7812),e(3110),e(9773)},2712:function(c,f,e){var t=e(6518),o=e(926).left,r=e(4598),i=e(9519);t({target:"Array",proto:!0,forced:!e(6193)&&i>79&&i<83||!r("reduce")},{reduce:function(l){var h=arguments.length;return o(this,l,h,h>1?arguments[1]:void 0)}})},2762:function(c,f,e){var t=e(6518),o=e(3802).trim;t({target:"String",proto:!0,forced:e(706)("trim")},{trim:function(){return o(this)}})},2777:function(c,f,e){var t=e(9565),o=e(34),r=e(757),i=e(5966),l=e(4270),h=e(8227),m=TypeError,g=h("toPrimitive");c.exports=function(y,E){if(!o(y)||r(y))return y;var w,b=i(y,g);if(b){if(E===void 0&&(E="default"),w=t(b,y,E),!o(w)||r(w))return w;throw new m("Can't convert object to primitive value")}return E===void 0&&(E="number"),l(y,E)}},2787:function(c,f,e){var t=e(9297),o=e(4901),r=e(8981),i=e(6119),l=e(2211),h=i("IE_PROTO"),m=Object,g=m.prototype;c.exports=l?m.getPrototypeOf:function(y){var E=r(y);if(t(E,h))return E[h];var w=E.constructor;return o(w)&&E instanceof w?w.prototype:E instanceof m?g:null}},2796:function(c,f,e){var t=e(9039),o=e(4901),r=/#|\.prototype\./,i=function(y,E){var w=h[l(y)];return w===g||w!==m&&(o(E)?t(E):!!E)},l=i.normalize=function(y){return String(y).replace(r,".").toLowerCase()},h=i.data={},m=i.NATIVE="N",g=i.POLYFILL="P";c.exports=i},2839:function(c,f,e){var t=e(4576).navigator,o=t&&t.userAgent;c.exports=o?String(o):""},2892:function(c,f,e){var t=e(6518),o=e(6395),r=e(3724),i=e(4576),l=e(9167),h=e(9504),m=e(2796),g=e(9297),y=e(3167),E=e(1625),w=e(757),b=e(2777),S=e(9039),x=e(8480).f,I=e(7347).f,A=e(4913).f,O=e(1240),N=e(3802).trim,M="Number",$=i[M],L=l[M],R=$.prototype,H=i.TypeError,U=h("".slice),_=h("".charCodeAt),ee=function(fe){var W,ne,Q,X,te,re,K,q,z=b(fe,"number");if(w(z))throw new H("Cannot convert a Symbol value to a number");if(typeof z=="string"&&z.length>2){if(z=N(z),(W=_(z,0))===43||W===45){if((ne=_(z,2))===88||ne===120)return NaN}else if(W===48){switch(_(z,1)){case 66:case 98:Q=2,X=49;break;case 79:case 111:Q=8,X=55;break;default:return+z}for(re=(te=U(z,2)).length,K=0;K<re;K++)if((q=_(te,K))<48||q>X)return NaN;return parseInt(te,Q)}}return+z},V=m(M,!$(" 0o1")||!$("0b1")||$("+0x1")),G=function(fe){var W,ne=arguments.length<1?0:$(function(Q){var X=b(Q,"number");return typeof X=="bigint"?X:ee(X)}(fe));return E(R,W=this)&&S(function(){O(W)})?y(Object(ne),this,G):ne};G.prototype=R,V&&!o&&(R.constructor=G),t({global:!0,constructor:!0,wrap:!0,forced:V},{Number:G});var pe=function(fe,W){for(var ne,Q=r?x(W):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),X=0;Q.length>X;X++)g(W,ne=Q[X])&&!g(fe,ne)&&A(fe,ne,I(W,ne))};o&&L&&pe(l[M],L),(V||o)&&pe(l[M],$)},2953:function(c,f,e){var t=e(4576),o=e(7400),r=e(9296),i=e(3792),l=e(6699),h=e(687),m=e(8227)("iterator"),g=i.values,y=function(w,b){if(w){if(w[m]!==g)try{l(w,m,g)}catch{w[m]=g}if(h(w,b,!0),o[b]){for(var S in i)if(w[S]!==i[S])try{l(w,S,i[S])}catch{w[S]=i[S]}}}};for(var E in o)y(t[E]&&t[E].prototype,E);y(r,"DOMTokenList")},2967:function(c,f,e){var t=e(6706),o=e(34),r=e(7750),i=e(3506);c.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var l,h=!1,m={};try{(l=t(Object.prototype,"__proto__","set"))(m,[]),h=m instanceof Array}catch{}return function(g,y){return r(g),i(y),o(g)&&(h?l(g,y):g.__proto__=y),g}}():void 0)},3110:function(c,f,e){var t=e(6518),o=e(7751),r=e(8745),i=e(9565),l=e(9504),h=e(9039),m=e(4376),g=e(4901),y=e(5810),E=e(757),w=e(2195),b=e(655),S=e(7680),x=e(8235),I=e(3392),A=e(4495),O=e(7819),N=String,M=o("JSON","stringify"),$=l(/./.exec),L=l("".charAt),R=l("".charCodeAt),H=l("".replace),U=l("".slice),_=l([].push),ee=l(1.1.toString),V=/[\uD800-\uDFFF]/g,G=/^[\uD800-\uDBFF]$/,pe=/^[\uDC00-\uDFFF]$/,fe=I(),W=fe.length,ne=!A||h(function(){var K=o("Symbol")("stringify detection");return M([K])!=="[null]"||M({a:K})!=="{}"||M(Object(K))!=="{}"}),Q=h(function(){return M("\uDF06\uD834")!=='"\\udf06\\ud834"'||M("\uDEAD")!=='"\\udead"'}),X=ne?function(K,q){var z=S(arguments),J=re(q);if(g(J)||K!==void 0&&!E(K))return z[1]=function(me,ie){if(g(J)&&(ie=i(J,this,N(me),ie)),!E(ie))return ie},r(M,null,z)}:M,te=function(K,q,z){var J=L(z,q-1),me=L(z,q+1);return $(G,K)&&!$(pe,me)||$(pe,K)&&!$(G,J)?"\\u"+ee(R(K,0),16):K},re=function(K){if(g(K))return K;if(m(K)){for(var q=K.length,z=[],J=0;J<q;J++){var me=K[J];typeof me=="string"?_(z,me):typeof me!="number"&&w(me)!=="Number"&&w(me)!=="String"||_(z,b(me))}var ie=z.length,se=!0;return function(ke,we){if(se)return se=!1,we;if(m(this))return we;for(var Ne=0;Ne<ie;Ne++)if(z[Ne]===ke)return we}}};M&&t({target:"JSON",stat:!0,arity:3,forced:ne||Q||!O},{stringify:function(K,q,z){var J=re(q),me=[],ie=X(K,function(je,Pe){var qe=g(J)?i(J,this,N(je),Pe):Pe;return!O&&y(qe)?fe+(_(me,qe.rawJSON)-1):qe},z);if(typeof ie!="string"||(Q&&(ie=H(ie,V,te)),O))return ie;for(var se="",ke=ie.length,we=0;we<ke;we++){var Ne=L(ie,we);if(Ne==='"'){var Ye=x(ie,++we).end-1,Te=U(ie,we,Ye);se+=U(Te,0,W)===fe?me[U(Te,W)]:'"'+Te+'"',we=Ye}else se+=Ne}return se}})},3167:function(c,f,e){var t=e(4901),o=e(34),r=e(2967);c.exports=function(i,l,h){var m,g;return r&&t(m=l.constructor)&&m!==h&&o(g=m.prototype)&&g!==h.prototype&&r(i,g),i}},3179:function(c,f,e){var t=e(2140),o=e(6955);c.exports=t?{}.toString:function(){return"[object "+o(this)+"]"}},3392:function(c,f,e){var t=e(9504),o=0,r=Math.random(),i=t(1.1.toString);c.exports=function(l){return"Symbol("+(l===void 0?"":l)+")_"+i(++o+r,36)}},3418:function(c,f,e){var t=e(6518),o=e(7916);t({target:"Array",stat:!0,forced:!e(4428)(function(r){Array.from(r)})},{from:o})},3500:function(c,f,e){var t=e(4576),o=e(7400),r=e(9296),i=e(235),l=e(6699),h=function(g){if(g&&g.forEach!==i)try{l(g,"forEach",i)}catch{g.forEach=i}};for(var m in o)o[m]&&h(t[m]&&t[m].prototype);h(r)},3506:function(c,f,e){var t=e(3925),o=String,r=TypeError;c.exports=function(i){if(t(i))return i;throw new r("Can't set "+o(i)+" as a prototype")}},3517:function(c,f,e){var t=e(9504),o=e(9039),r=e(4901),i=e(6955),l=e(7751),h=e(3706),m=function(){},g=l("Reflect","construct"),y=/^\s*(?:class|function)\b/,E=t(y.exec),w=!y.test(m),b=function(x){if(!r(x))return!1;try{return g(m,[],x),!0}catch{return!1}},S=function(x){if(!r(x))return!1;switch(i(x)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return w||!!E(y,h(x))}catch{return!0}};S.sham=!0,c.exports=!g||o(function(){var x;return b(b.call)||!b(Object)||!b(function(){x=!0})||x})?S:b},3607:function(c,f,e){var t=e(2839).match(/AppleWebKit\/(\d+)\./);c.exports=!!t&&+t[1]},3635:function(c,f,e){var t=e(9039),o=e(4576).RegExp;c.exports=t(function(){var r=o(".","s");return!(r.dotAll&&r.test(`
`)&&r.flags==="s")})},3640:function(c,f,e){var t=e(8551),o=e(4270),r=TypeError;c.exports=function(i){if(t(this),i==="string"||i==="default")i="string";else if(i!=="number")throw new r("Incorrect hint");return o(this,i)}},3706:function(c,f,e){var t=e(9504),o=e(4901),r=e(7629),i=t(Function.toString);o(r.inspectSource)||(r.inspectSource=function(l){return i(l)}),c.exports=r.inspectSource},3709:function(c,f,e){var t=e(2839).match(/firefox\/(\d+)/i);c.exports=!!t&&+t[1]},3717:function(c,f){f.f=Object.getOwnPropertySymbols},3724:function(c,f,e){var t=e(9039);c.exports=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},3763:function(c,f,e){var t=e(2839);c.exports=/MSIE|Trident/.test(t)},3792:function(c,f,e){var t=e(5397),o=e(6469),r=e(6269),i=e(1181),l=e(4913).f,h=e(1088),m=e(2529),g=e(6395),y=e(3724),E="Array Iterator",w=i.set,b=i.getterFor(E);c.exports=h(Array,"Array",function(x,I){w(this,{type:E,target:t(x),index:0,kind:I})},function(){var x=b(this),I=x.target,A=x.index++;if(!I||A>=I.length)return x.target=null,m(void 0,!0);switch(x.kind){case"keys":return m(A,!1);case"values":return m(I[A],!1)}return m([A,I[A]],!1)},"values");var S=r.Arguments=r.Array;if(o("keys"),o("values"),o("entries"),!g&&y&&S.name!=="values")try{l(S,"name",{value:"values"})}catch{}},3802:function(c,f,e){var t=e(9504),o=e(7750),r=e(655),i=e(7452),l=t("".replace),h=RegExp("^["+i+"]+"),m=RegExp("(^|[^"+i+"])["+i+"]+$"),g=function(y){return function(E){var w=r(o(E));return 1&y&&(w=l(w,h,"")),2&y&&(w=l(w,m,"$1")),w}};c.exports={start:g(1),end:g(2),trim:g(3)}},3851:function(c,f,e){var t=e(6518),o=e(9039),r=e(5397),i=e(7347).f,l=e(3724);t({target:"Object",stat:!0,forced:!l||o(function(){i(1)}),sham:!l},{getOwnPropertyDescriptor:function(h,m){return i(r(h),m)}})},3925:function(c,f,e){var t=e(34);c.exports=function(o){return t(o)||o===null}},3994:function(c,f,e){var t=e(7657).IteratorPrototype,o=e(2360),r=e(6980),i=e(687),l=e(6269),h=function(){return this};c.exports=function(m,g,y,E){var w=g+" Iterator";return m.prototype=o(t,{next:r(+!E,y)}),i(m,w,!1,!0),l[w]=h,m}},4055:function(c,f,e){var t=e(4576),o=e(34),r=t.document,i=o(r)&&o(r.createElement);c.exports=function(l){return i?r.createElement(l):{}}},4117:function(c){c.exports=function(f){return f==null}},4209:function(c,f,e){var t=e(8227),o=e(6269),r=t("iterator"),i=Array.prototype;c.exports=function(l){return l!==void 0&&(o.Array===l||i[r]===l)}},4213:function(c,f,e){var t=e(3724),o=e(9504),r=e(9565),i=e(9039),l=e(1072),h=e(3717),m=e(8773),g=e(8981),y=e(7055),E=Object.assign,w=Object.defineProperty,b=o([].concat);c.exports=!E||i(function(){if(t&&E({b:1},E(w({},"a",{enumerable:!0,get:function(){w(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var S={},x={},I=Symbol("assign detection"),A="abcdefghijklmnopqrst";return S[I]=7,A.split("").forEach(function(O){x[O]=O}),E({},S)[I]!==7||l(E({},x)).join("")!==A})?function(S,x){for(var I=g(S),A=arguments.length,O=1,N=h.f,M=m.f;A>O;)for(var $,L=y(arguments[O++]),R=N?b(l(L),N(L)):l(L),H=R.length,U=0;H>U;)$=R[U++],t&&!r(M,L,$)||(I[$]=L[$]);return I}:E},4215:function(c,f,e){var t=e(4576),o=e(2839),r=e(2195),i=function(l){return o.slice(0,l.length)===l};c.exports=i("Bun/")?"BUN":i("Cloudflare-Workers")?"CLOUDFLARE":i("Deno/")?"DENO":i("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":r(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"},4270:function(c,f,e){var t=e(9565),o=e(4901),r=e(34),i=TypeError;c.exports=function(l,h){var m,g;if(h==="string"&&o(m=l.toString)&&!r(g=t(m,l))||o(m=l.valueOf)&&!r(g=t(m,l))||h!=="string"&&o(m=l.toString)&&!r(g=t(m,l)))return g;throw new i("Can't convert object to primitive value")}},4376:function(c,f,e){var t=e(2195);c.exports=Array.isArray||function(o){return t(o)==="Array"}},4423:function(c,f,e){var t=e(6518),o=e(9617).includes,r=e(9039),i=e(6469);t({target:"Array",proto:!0,forced:r(function(){return!Array(1).includes()})},{includes:function(l){return o(this,l,arguments.length>1?arguments[1]:void 0)}}),i("includes")},4428:function(c,f,e){var t=e(8227)("iterator"),o=!1;try{var r=0,i={next:function(){return{done:!!r++}},return:function(){o=!0}};i[t]=function(){return this},Array.from(i,function(){throw 2})}catch{}c.exports=function(l,h){try{if(!h&&!o)return!1}catch{return!1}var m=!1;try{var g={};g[t]=function(){return{next:function(){return{done:m=!0}}}},l(g)}catch{}return m}},4488:function(c,f,e){var t=e(7680),o=Math.floor,r=function(i,l){var h=i.length;if(h<8)for(var m,g,y=1;y<h;){for(g=y,m=i[y];g&&l(i[g-1],m)>0;)i[g]=i[--g];g!==y++&&(i[g]=m)}else for(var E=o(h/2),w=r(t(i,0,E),l),b=r(t(i,E),l),S=w.length,x=b.length,I=0,A=0;I<S||A<x;)i[I+A]=I<S&&A<x?l(w[I],b[A])<=0?w[I++]:b[A++]:I<S?w[I++]:b[A++];return i};c.exports=r},4495:function(c,f,e){var t=e(9519),o=e(9039),r=e(4576).String;c.exports=!!Object.getOwnPropertySymbols&&!o(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41})},4527:function(c,f,e){var t=e(3724),o=e(4376),r=TypeError,i=Object.getOwnPropertyDescriptor,l=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(h){return h instanceof TypeError}}();c.exports=l?function(h,m){if(o(h)&&!i(h,"length").writable)throw new r("Cannot set read only .length");return h.length=m}:function(h,m){return h.length=m}},4554:function(c,f,e){var t=e(6518),o=e(8981),r=e(5610),i=e(1291),l=e(6198),h=e(4527),m=e(6837),g=e(1469),y=e(4659),E=e(4606),w=e(597)("splice"),b=Math.max,S=Math.min;t({target:"Array",proto:!0,forced:!w},{splice:function(x,I){var A,O,N,M,$,L,R=o(this),H=l(R),U=r(x,H),_=arguments.length;for(_===0?A=O=0:_===1?(A=0,O=H-U):(A=_-2,O=S(b(i(I),0),H-U)),m(H+A-O),N=g(R,O),M=0;M<O;M++)($=U+M)in R&&y(N,M,R[$]);if(N.length=O,A<O){for(M=U;M<H-O;M++)L=M+A,($=M+O)in R?R[L]=R[$]:E(R,L);for(M=H;M>H-O+A;M--)E(R,M-1)}else if(A>O)for(M=H-O;M>U;M--)L=M+A-1,($=M+O-1)in R?R[L]=R[$]:E(R,L);for(M=0;M<A;M++)R[M+U]=arguments[M+2];return h(R,H-O+A),N}})},4576:function(c,f,e){var t=function(o){return o&&o.Math===Math&&o};c.exports=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof e.g=="object"&&e.g)||t(typeof this=="object"&&this)||function(){return this}()||Function("return this")()},4598:function(c,f,e){var t=e(9039);c.exports=function(o,r){var i=[][o];return!!i&&t(function(){i.call(null,r||function(){return 1},1)})}},4606:function(c,f,e){var t=e(6823),o=TypeError;c.exports=function(r,i){if(!delete r[i])throw new o("Cannot delete property "+t(i)+" of "+t(r))}},4659:function(c,f,e){var t=e(3724),o=e(4913),r=e(6980);c.exports=function(i,l,h){t?o.f(i,l,r(0,h)):i[l]=h}},4782:function(c,f,e){var t=e(6518),o=e(4376),r=e(3517),i=e(34),l=e(5610),h=e(6198),m=e(5397),g=e(4659),y=e(8227),E=e(597),w=e(7680),b=E("slice"),S=y("species"),x=Array,I=Math.max;t({target:"Array",proto:!0,forced:!b},{slice:function(A,O){var N,M,$,L=m(this),R=h(L),H=l(A,R),U=l(O===void 0?R:O,R);if(o(L)&&(N=L.constructor,(r(N)&&(N===x||o(N.prototype))||i(N)&&(N=N[S])===null)&&(N=void 0),N===x||N===void 0))return w(L,H,U);for(M=new(N===void 0?x:N)(I(U-H,0)),$=0;H<U;H++,$++)H in L&&g(M,$,L[H]);return M.length=$,M}})},4864:function(c,f,e){var t=e(3724),o=e(4576),r=e(9504),i=e(2796),l=e(3167),h=e(6699),m=e(2360),g=e(8480).f,y=e(1625),E=e(788),w=e(655),b=e(1034),S=e(8429),x=e(1056),I=e(6840),A=e(9039),O=e(9297),N=e(1181).enforce,M=e(7633),$=e(8227),L=e(3635),R=e(8814),H=$("match"),U=o.RegExp,_=U.prototype,ee=o.SyntaxError,V=r(_.exec),G=r("".charAt),pe=r("".replace),fe=r("".indexOf),W=r("".slice),ne=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Q=/a/g,X=/a/g,te=new U(Q)!==Q,re=S.MISSED_STICKY,K=S.UNSUPPORTED_Y,q=t&&(!te||re||L||R||A(function(){return X[H]=!1,U(Q)!==Q||U(X)===X||String(U(Q,"i"))!=="/a/i"}));if(i("RegExp",q)){for(var z=function(ie,se){var ke,we,Ne,Ye,Te,je,Pe=y(_,this),qe=E(ie),gt=se===void 0,vt=[],De=ie;if(!Pe&&qe&&gt&&ie.constructor===z)return ie;if((qe||y(_,ie))&&(ie=ie.source,gt&&(se=b(De))),ie=ie===void 0?"":w(ie),se=se===void 0?"":w(se),De=ie,L&&"dotAll"in Q&&(we=!!se&&fe(se,"s")>-1)&&(se=pe(se,/s/g,"")),ke=se,re&&"sticky"in Q&&(Ne=!!se&&fe(se,"y")>-1)&&K&&(se=pe(se,/y/g,"")),R&&(Ye=function(Re){for(var Ae,yt=Re.length,Le=0,Xe="",Ze=[],bt=m(null),wt=!1,ct=!1,Bt=0,it="";Le<=yt;Le++){if((Ae=G(Re,Le))==="\\")Ae+=G(Re,++Le);else if(Ae==="]")wt=!1;else if(!wt)switch(!0){case Ae==="[":wt=!0;break;case Ae==="(":if(Xe+=Ae,W(Re,Le+1,Le+3)==="?:")continue;V(ne,W(Re,Le+1))&&(Le+=2,ct=!0),Bt++;continue;case(Ae===">"&&ct):if(it===""||O(bt,it))throw new ee("Invalid capture group name");bt[it]=!0,Ze[Ze.length]=[it,Bt],ct=!1,it="";continue}ct?it+=Ae:Xe+=Ae}return[Xe,Ze]}(ie),ie=Ye[0],vt=Ye[1]),Te=l(U(ie,se),Pe?this:_,z),(we||Ne||vt.length)&&(je=N(Te),we&&(je.dotAll=!0,je.raw=z(function(Re){for(var Ae,yt=Re.length,Le=0,Xe="",Ze=!1;Le<=yt;Le++)(Ae=G(Re,Le))!=="\\"?Ze||Ae!=="."?(Ae==="["?Ze=!0:Ae==="]"&&(Ze=!1),Xe+=Ae):Xe+="[\\s\\S]":Xe+=Ae+G(Re,++Le);return Xe}(ie),ke)),Ne&&(je.sticky=!0),vt.length&&(je.groups=vt)),ie!==De)try{h(Te,"source",De===""?"(?:)":De)}catch{}return Te},J=g(U),me=0;J.length>me;)x(z,U,J[me++]);_.constructor=z,z.prototype=_,I(o,"RegExp",z,{constructor:!0})}M("RegExp")},4901:function(c){var f=typeof document=="object"&&document.all;c.exports=f===void 0&&f!==void 0?function(e){return typeof e=="function"||e===f}:function(e){return typeof e=="function"}},4913:function(c,f,e){var t=e(3724),o=e(5917),r=e(8686),i=e(8551),l=e(6969),h=TypeError,m=Object.defineProperty,g=Object.getOwnPropertyDescriptor,y="enumerable",E="configurable",w="writable";f.f=t?r?function(b,S,x){if(i(b),S=l(S),i(x),typeof b=="function"&&S==="prototype"&&"value"in x&&w in x&&!x[w]){var I=g(b,S);I&&I[w]&&(b[S]=x.value,x={configurable:E in x?x[E]:I[E],enumerable:y in x?x[y]:I[y],writable:!1})}return m(b,S,x)}:m:function(b,S,x){if(i(b),S=l(S),i(x),o)try{return m(b,S,x)}catch{}if("get"in x||"set"in x)throw new h("Accessors not supported");return"value"in x&&(b[S]=x.value),b}},5031:function(c,f,e){var t=e(7751),o=e(9504),r=e(8480),i=e(3717),l=e(8551),h=o([].concat);c.exports=t("Reflect","ownKeys")||function(m){var g=r.f(l(m)),y=i.f;return y?h(g,y(m)):g}},5213:function(c,f,e){var t=e(4576),o=e(9039),r=t.RegExp,i=!o(function(){var l=!0;try{r(".","d")}catch{l=!1}var h={},m="",g=l?"dgimsy":"gimsy",y=function(b,S){Object.defineProperty(h,b,{get:function(){return m+=S,!0}})},E={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var w in l&&(E.hasIndices="d"),E)y(w,E[w]);return Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(h)!==g||m!==g});c.exports={correct:i}},5276:function(c,f,e){var t=e(6518),o=e(7476),r=e(9617).indexOf,i=e(4598),l=o([].indexOf),h=!!l&&1/l([1],1,-0)<0;t({target:"Array",proto:!0,forced:h||!i("indexOf")},{indexOf:function(m){var g=arguments.length>1?arguments[1]:void 0;return h?l(this,m,g)||0:r(this,m,g)}})},5397:function(c,f,e){var t=e(7055),o=e(7750);c.exports=function(r){return t(o(r))}},5440:function(c,f,e){var t=e(8745),o=e(9565),r=e(9504),i=e(9228),l=e(9039),h=e(8551),m=e(4901),g=e(34),y=e(1291),E=e(8014),w=e(655),b=e(7750),S=e(7829),x=e(5966),I=e(2478),A=e(1034),O=e(6682),N=e(8227)("replace"),M=Math.max,$=Math.min,L=r([].concat),R=r([].push),H=r("".indexOf),U=r("".slice),_="a".replace(/./,"$0")==="$0",ee=!!/./[N]&&/./[N]("a","$0")==="";i("replace",function(V,G,pe){var fe=ee?"$":"$0";return[function(W,ne){var Q=b(this),X=g(W)?x(W,N):void 0;return X?o(X,W,Q,ne):o(G,w(Q),W,ne)},function(W,ne){var Q=h(this),X=w(W);if(typeof ne=="string"&&H(ne,fe)===-1&&H(ne,"$<")===-1){var te=pe(G,Q,X,ne);if(te.done)return te.value}var re=m(ne);re||(ne=w(ne));var K,q=w(A(Q)),z=H(q,"g")!==-1;z&&(K=H(q,"u")!==-1,Q.lastIndex=0);for(var J,me=[];(J=O(Q,X))!==null&&(R(me,J),z);)w(J[0])===""&&(Q.lastIndex=S(X,E(Q.lastIndex),K));for(var ie,se="",ke=0,we=0;we<me.length;we++){for(var Ne,Ye=w((J=me[we])[0]),Te=M($(y(J.index),X.length),0),je=[],Pe=1;Pe<J.length;Pe++)R(je,(ie=J[Pe])===void 0?ie:String(ie));var qe=J.groups;if(re){var gt=L([Ye],je,Te,X);qe!==void 0&&R(gt,qe),Ne=w(t(ne,void 0,gt))}else Ne=I(Ye,X,Te,je,qe,ne);Te>=ke&&(se+=U(X,ke,Te)+Ne,ke=Te+Ye.length)}return se+U(X,ke)}]},!!l(function(){var V=/./;return V.exec=function(){var G=[];return G.groups={a:"7"},G},"".replace(V,"$<a>")!=="7"})||!_||ee)},5548:function(c,f,e){var t=e(3517),o=e(6823),r=TypeError;c.exports=function(i){if(t(i))return i;throw new r(o(i)+" is not a constructor")}},5610:function(c,f,e){var t=e(1291),o=Math.max,r=Math.min;c.exports=function(i,l){var h=t(i);return h<0?o(h+l,0):r(h,l)}},5700:function(c,f,e){var t=e(511),o=e(8242);t("toPrimitive"),o()},5745:function(c,f,e){var t=e(7629);c.exports=function(o,r){return t[o]||(t[o]=r||{})}},5749:function(c,f,e){var t=e(788),o=TypeError;c.exports=function(r){if(t(r))throw new o("The method doesn't accept regular expressions");return r}},5810:function(c,f,e){var t=e(34),o=e(1181).get;c.exports=function(r){if(!t(r))return!1;var i=o(r);return!!i&&i.type==="RawJSON"}},5917:function(c,f,e){var t=e(3724),o=e(9039),r=e(4055);c.exports=!t&&!o(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7})},5966:function(c,f,e){var t=e(9306),o=e(4117);c.exports=function(r,i){var l=r[i];return o(l)?void 0:t(l)}},6080:function(c,f,e){var t=e(7476),o=e(9306),r=e(616),i=t(t.bind);c.exports=function(l,h){return o(l),h===void 0?l:r?i(l,h):function(){return l.apply(h,arguments)}}},6099:function(c,f,e){var t=e(2140),o=e(6840),r=e(3179);t||o(Object.prototype,"toString",r,{unsafe:!0})},6119:function(c,f,e){var t=e(5745),o=e(3392),r=t("keys");c.exports=function(i){return r[i]||(r[i]=o(i))}},6193:function(c,f,e){var t=e(4215);c.exports=t==="NODE"},6198:function(c,f,e){var t=e(8014);c.exports=function(o){return t(o.length)}},6269:function(c){c.exports={}},6319:function(c,f,e){var t=e(8551),o=e(9539);c.exports=function(r,i,l,h){try{return h?i(t(l)[0],l[1]):i(l)}catch(m){o(r,"throw",m)}}},6395:function(c){c.exports=!1},6469:function(c,f,e){var t=e(8227),o=e(2360),r=e(4913).f,i=t("unscopables"),l=Array.prototype;l[i]===void 0&&r(l,i,{configurable:!0,value:o(null)}),c.exports=function(h){l[i][h]=!0}},6518:function(c,f,e){var t=e(4576),o=e(7347).f,r=e(6699),i=e(6840),l=e(9433),h=e(7740),m=e(2796);c.exports=function(g,y){var E,w,b,S,x,I=g.target,A=g.global,O=g.stat;if(E=A?t:O?t[I]||l(I,{}):t[I]&&t[I].prototype)for(w in y){if(S=y[w],b=g.dontCallGetSet?(x=o(E,w))&&x.value:E[w],!m(A?w:I+(O?".":"#")+w,g.forced)&&b!==void 0){if(typeof S==typeof b)continue;h(S,b)}(g.sham||b&&b.sham)&&r(S,"sham",!0),i(E,w,S,g)}}},6682:function(c,f,e){var t=e(9565),o=e(8551),r=e(4901),i=e(2195),l=e(7323),h=TypeError;c.exports=function(m,g){var y=m.exec;if(r(y)){var E=t(y,m,g);return E!==null&&o(E),E}if(i(m)==="RegExp")return t(l,m,g);throw new h("RegExp#exec called on incompatible receiver")}},6699:function(c,f,e){var t=e(3724),o=e(4913),r=e(6980);c.exports=t?function(i,l,h){return o.f(i,l,r(1,h))}:function(i,l,h){return i[l]=h,i}},6706:function(c,f,e){var t=e(9504),o=e(9306);c.exports=function(r,i,l){try{return t(o(Object.getOwnPropertyDescriptor(r,i)[l]))}catch{}}},6761:function(c,f,e){var t=e(6518),o=e(4576),r=e(9565),i=e(9504),l=e(6395),h=e(3724),m=e(4495),g=e(9039),y=e(9297),E=e(1625),w=e(8551),b=e(5397),S=e(6969),x=e(655),I=e(6980),A=e(2360),O=e(1072),N=e(8480),M=e(298),$=e(3717),L=e(7347),R=e(4913),H=e(6801),U=e(8773),_=e(6840),ee=e(2106),V=e(5745),G=e(6119),pe=e(421),fe=e(3392),W=e(8227),ne=e(1951),Q=e(511),X=e(8242),te=e(687),re=e(1181),K=e(9213).forEach,q=G("hidden"),z="Symbol",J="prototype",me=re.set,ie=re.getterFor(z),se=Object[J],ke=o.Symbol,we=ke&&ke[J],Ne=o.RangeError,Ye=o.TypeError,Te=o.QObject,je=L.f,Pe=R.f,qe=M.f,gt=U.f,vt=i([].push),De=V("symbols"),Re=V("op-symbols"),Ae=V("wks"),yt=!Te||!Te[J]||!Te[J].findChild,Le=function(ae,ce,de){var be=je(se,ce);be&&delete se[ce],Pe(ae,ce,de),be&&ae!==se&&Pe(se,ce,be)},Xe=h&&g(function(){return A(Pe({},"a",{get:function(){return Pe(this,"a",{value:7}).a}})).a!==7})?Le:Pe,Ze=function(ae,ce){var de=De[ae]=A(we);return me(de,{type:z,tag:ae,description:ce}),h||(de.description=ce),de},bt=function(ae,ce,de){ae===se&&bt(Re,ce,de),w(ae);var be=S(ce);return w(de),y(De,be)?(de.enumerable?(y(ae,q)&&ae[q][be]&&(ae[q][be]=!1),de=A(de,{enumerable:I(0,!1)})):(y(ae,q)||Pe(ae,q,I(1,A(null))),ae[q][be]=!0),Xe(ae,be,de)):Pe(ae,be,de)},wt=function(ae,ce){w(ae);var de=b(ce),be=O(de).concat(Rn(de));return K(be,function(Ie){h&&!r(ct,de,Ie)||bt(ae,Ie,de[Ie])}),ae},ct=function(ae){var ce=S(ae),de=r(gt,this,ce);return!(this===se&&y(De,ce)&&!y(Re,ce))&&(!(de||!y(this,ce)||!y(De,ce)||y(this,q)&&this[q][ce])||de)},Bt=function(ae,ce){var de=b(ae),be=S(ce);if(de!==se||!y(De,be)||y(Re,be)){var Ie=je(de,be);return!Ie||!y(De,be)||y(de,q)&&de[q][be]||(Ie.enumerable=!0),Ie}},it=function(ae){var ce=qe(b(ae)),de=[];return K(ce,function(be){y(De,be)||y(pe,be)||vt(de,be)}),de},Rn=function(ae){var ce=ae===se,de=qe(ce?Re:b(ae)),be=[];return K(de,function(Ie){!y(De,Ie)||ce&&!y(se,Ie)||vt(be,De[Ie])}),be};m||(ke=function(){if(E(we,this))throw new Ye("Symbol is not a constructor");var ae=arguments.length&&arguments[0]!==void 0?x(arguments[0]):void 0,ce=fe(ae),de=function(be){var Ie=this===void 0?o:this;Ie===se&&r(de,Re,be),y(Ie,q)&&y(Ie[q],ce)&&(Ie[q][ce]=!1);var Ln=I(1,be);try{Xe(Ie,ce,Ln)}catch(_n){if(!(_n instanceof Ne))throw _n;Le(Ie,ce,Ln)}};return h&&yt&&Xe(se,ce,{configurable:!0,set:de}),Ze(ce,ae)},_(we=ke[J],"toString",function(){return ie(this).tag}),_(ke,"withoutSetter",function(ae){return Ze(fe(ae),ae)}),U.f=ct,R.f=bt,H.f=wt,L.f=Bt,N.f=M.f=it,$.f=Rn,ne.f=function(ae){return Ze(W(ae),ae)},h&&(ee(we,"description",{configurable:!0,get:function(){return ie(this).description}}),l||_(se,"propertyIsEnumerable",ct,{unsafe:!0}))),t({global:!0,constructor:!0,wrap:!0,forced:!m,sham:!m},{Symbol:ke}),K(O(Ae),function(ae){Q(ae)}),t({target:z,stat:!0,forced:!m},{useSetter:function(){yt=!0},useSimple:function(){yt=!1}}),t({target:"Object",stat:!0,forced:!m,sham:!h},{create:function(ae,ce){return ce===void 0?A(ae):wt(A(ae),ce)},defineProperty:bt,defineProperties:wt,getOwnPropertyDescriptor:Bt}),t({target:"Object",stat:!0,forced:!m},{getOwnPropertyNames:it}),X(),te(ke,z),pe[q]=!0},6801:function(c,f,e){var t=e(3724),o=e(8686),r=e(4913),i=e(8551),l=e(5397),h=e(1072);f.f=t&&!o?Object.defineProperties:function(m,g){i(m);for(var y,E=l(g),w=h(g),b=w.length,S=0;b>S;)r.f(m,y=w[S++],E[y]);return m}},6823:function(c){var f=String;c.exports=function(e){try{return f(e)}catch{return"Object"}}},6837:function(c){var f=TypeError;c.exports=function(e){if(e>9007199254740991)throw f("Maximum allowed index exceeded");return e}},6840:function(c,f,e){var t=e(4901),o=e(4913),r=e(283),i=e(9433);c.exports=function(l,h,m,g){g||(g={});var y=g.enumerable,E=g.name!==void 0?g.name:h;if(t(m)&&r(m,E,g),g.global)y?l[h]=m:i(h,m);else{try{g.unsafe?l[h]&&(y=!0):delete l[h]}catch{}y?l[h]=m:o.f(l,h,{value:m,enumerable:!1,configurable:!g.nonConfigurable,writable:!g.nonWritable})}return l}},6910:function(c,f,e){var t=e(6518),o=e(9504),r=e(9306),i=e(8981),l=e(6198),h=e(4606),m=e(655),g=e(9039),y=e(4488),E=e(4598),w=e(3709),b=e(3763),S=e(9519),x=e(3607),I=[],A=o(I.sort),O=o(I.push),N=g(function(){I.sort(void 0)}),M=g(function(){I.sort(null)}),$=E("sort"),L=!g(function(){if(S)return S<70;if(!(w&&w>3)){if(b)return!0;if(x)return x<603;var R,H,U,_,ee="";for(R=65;R<76;R++){switch(H=String.fromCharCode(R),R){case 66:case 69:case 70:case 72:U=3;break;case 68:case 71:U=4;break;default:U=2}for(_=0;_<47;_++)I.push({k:H+_,v:U})}for(I.sort(function(V,G){return G.v-V.v}),_=0;_<I.length;_++)H=I[_].k.charAt(0),ee.charAt(ee.length-1)!==H&&(ee+=H);return ee!=="DGBEFHACIJK"}});t({target:"Array",proto:!0,forced:N||!M||!$||!L},{sort:function(R){R!==void 0&&r(R);var H=i(this);if(L)return R===void 0?A(H):A(H,R);var U,_,ee=[],V=l(H);for(_=0;_<V;_++)_ in H&&O(ee,H[_]);for(y(ee,function(G){return function(pe,fe){return fe===void 0?-1:pe===void 0?1:G!==void 0?+G(pe,fe)||0:m(pe)>m(fe)?1:-1}}(R)),U=l(ee),_=0;_<U;)H[_]=ee[_++];for(;_<V;)h(H,_++);return H}})},6955:function(c,f,e){var t=e(2140),o=e(4901),r=e(2195),i=e(8227)("toStringTag"),l=Object,h=r(function(){return arguments}())==="Arguments";c.exports=t?r:function(m){var g,y,E;return m===void 0?"Undefined":m===null?"Null":typeof(y=function(w,b){try{return w[b]}catch{}}(g=l(m),i))=="string"?y:h?r(g):(E=r(g))==="Object"&&o(g.callee)?"Arguments":E}},6969:function(c,f,e){var t=e(2777),o=e(757);c.exports=function(r){var i=t(r,"string");return o(i)?i:i+""}},6980:function(c){c.exports=function(f,e){return{enumerable:!(1&f),configurable:!(2&f),writable:!(4&f),value:e}}},7040:function(c,f,e){var t=e(4495);c.exports=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},7055:function(c,f,e){var t=e(9504),o=e(9039),r=e(2195),i=Object,l=t("".split);c.exports=o(function(){return!i("z").propertyIsEnumerable(0)})?function(h){return r(h)==="String"?l(h,""):i(h)}:i},7323:function(c,f,e){var t,o,r=e(9565),i=e(9504),l=e(655),h=e(7979),m=e(8429),g=e(5745),y=e(2360),E=e(1181).get,w=e(3635),b=e(8814),S=g("native-string-replace",String.prototype.replace),x=RegExp.prototype.exec,I=x,A=i("".charAt),O=i("".indexOf),N=i("".replace),M=i("".slice),$=(o=/b*/g,r(x,t=/a/,"a"),r(x,o,"a"),t.lastIndex!==0||o.lastIndex!==0),L=m.BROKEN_CARET,R=/()??/.exec("")[1]!==void 0;($||R||L||w||b)&&(I=function(H){var U,_,ee,V,G,pe,fe,W=this,ne=E(W),Q=l(H),X=ne.raw;if(X)return X.lastIndex=W.lastIndex,U=r(I,X,Q),W.lastIndex=X.lastIndex,U;var te=ne.groups,re=L&&W.sticky,K=r(h,W),q=W.source,z=0,J=Q;if(re&&(K=N(K,"y",""),O(K,"g")===-1&&(K+="g"),J=M(Q,W.lastIndex),W.lastIndex>0&&(!W.multiline||W.multiline&&A(Q,W.lastIndex-1)!==`
`)&&(q="(?: "+q+")",J=" "+J,z++),_=new RegExp("^(?:"+q+")",K)),R&&(_=new RegExp("^"+q+"$(?!\\s)",K)),$&&(ee=W.lastIndex),V=r(x,re?_:W,J),re?V?(V.input=M(V.input,z),V[0]=M(V[0],z),V.index=W.lastIndex,W.lastIndex+=V[0].length):W.lastIndex=0:$&&V&&(W.lastIndex=W.global?V.index+V[0].length:ee),R&&V&&V.length>1&&r(S,V[0],_,function(){for(G=1;G<arguments.length-2;G++)arguments[G]===void 0&&(V[G]=void 0)}),V&&te)for(V.groups=pe=y(null),G=0;G<te.length;G++)pe[(fe=te[G])[0]]=V[fe[1]];return V}),c.exports=I},7347:function(c,f,e){var t=e(3724),o=e(9565),r=e(8773),i=e(6980),l=e(5397),h=e(6969),m=e(9297),g=e(5917),y=Object.getOwnPropertyDescriptor;f.f=t?y:function(E,w){if(E=l(E),w=h(w),g)try{return y(E,w)}catch{}if(m(E,w))return i(!o(r.f,E,w),E[w])}},7400:function(c){c.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},7427:function(c,f,e){var t=e(6518),o=e(3724),r=e(2551),i=e(9306),l=e(8981),h=e(4913);o&&t({target:"Object",proto:!0,forced:r},{__defineGetter__:function(m,g){h.f(l(this),m,{get:i(g),enumerable:!0,configurable:!0})}})},7433:function(c,f,e){var t=e(4376),o=e(3517),r=e(34),i=e(8227)("species"),l=Array;c.exports=function(h){var m;return t(h)&&(m=h.constructor,(o(m)&&(m===l||t(m.prototype))||r(m)&&(m=m[i])===null)&&(m=void 0)),m===void 0?l:m}},7452:function(c){c.exports=`	
\v\f\r                　\u2028\u2029\uFEFF`},7476:function(c,f,e){var t=e(2195),o=e(9504);c.exports=function(r){if(t(r)==="Function")return o(r)}},7495:function(c,f,e){var t=e(6518),o=e(7323);t({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},7629:function(c,f,e){var t=e(6395),o=e(4576),r=e(9433),i="__core-js_shared__",l=c.exports=o[i]||r(i,{});(l.versions||(l.versions=[])).push({version:"3.47.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"})},7633:function(c,f,e){var t=e(7751),o=e(2106),r=e(8227),i=e(3724),l=r("species");c.exports=function(h){var m=t(h);i&&m&&!m[l]&&o(m,l,{configurable:!0,get:function(){return this}})}},7657:function(c,f,e){var t,o,r,i=e(9039),l=e(4901),h=e(34),m=e(2360),g=e(2787),y=e(6840),E=e(8227),w=e(6395),b=E("iterator"),S=!1;[].keys&&("next"in(r=[].keys())?(o=g(g(r)))!==Object.prototype&&(t=o):S=!0),!h(t)||i(function(){var x={};return t[b].call(x)!==x})?t={}:w&&(t=m(t)),l(t[b])||y(t,b,function(){return this}),c.exports={IteratorPrototype:t,BUGGY_SAFARI_ITERATORS:S}},7680:function(c,f,e){var t=e(9504);c.exports=t([].slice)},7740:function(c,f,e){var t=e(9297),o=e(5031),r=e(7347),i=e(4913);c.exports=function(l,h,m){for(var g=o(h),y=i.f,E=r.f,w=0;w<g.length;w++){var b=g[w];t(l,b)||m&&t(m,b)||y(l,b,E(h,b))}}},7750:function(c,f,e){var t=e(4117),o=TypeError;c.exports=function(r){if(t(r))throw new o("Can't call method on "+r);return r}},7751:function(c,f,e){var t=e(4576),o=e(4901);c.exports=function(r,i){return arguments.length<2?(l=t[r],o(l)?l:void 0):t[r]&&t[r][i];var l}},7764:function(c,f,e){var t=e(8183).charAt,o=e(655),r=e(1181),i=e(1088),l=e(2529),h="String Iterator",m=r.set,g=r.getterFor(h);i(String,"String",function(y){m(this,{type:h,string:o(y),index:0})},function(){var y,E=g(this),w=E.string,b=E.index;return b>=w.length?l(void 0,!0):(y=t(w,b),E.index+=y.length,l(y,!1))})},7812:function(c,f,e){var t=e(6518),o=e(9297),r=e(757),i=e(6823),l=e(5745),h=e(1296),m=l("symbol-to-string-registry");t({target:"Symbol",stat:!0,forced:!h},{keyFor:function(g){if(!r(g))throw new TypeError(i(g)+" is not a symbol");if(o(m,g))return m[g]}})},7819:function(c,f,e){var t=e(9039);c.exports=!t(function(){var o="9007199254740993",r=JSON.rawJSON(o);return!JSON.isRawJSON(r)||JSON.stringify(r)!==o})},7829:function(c,f,e){var t=e(8183).charAt;c.exports=function(o,r,i){return r+(i?t(o,r).length:1)}},7916:function(c,f,e){var t=e(6080),o=e(9565),r=e(8981),i=e(6319),l=e(4209),h=e(3517),m=e(6198),g=e(4659),y=e(81),E=e(851),w=Array;c.exports=function(b){var S=r(b),x=h(this),I=arguments.length,A=I>1?arguments[1]:void 0,O=A!==void 0;O&&(A=t(A,I>2?arguments[2]:void 0));var N,M,$,L,R,H,U=E(S),_=0;if(!U||this===w&&l(U))for(N=m(S),M=x?new this(N):w(N);N>_;_++)H=O?A(S[_],_):S[_],g(M,_,H);else for(M=x?new this:[],R=(L=y(S,U)).next;!($=o(R,L)).done;_++)H=O?i(L,A,[$.value,_],!0):$.value,g(M,_,H);return M.length=_,M}},7979:function(c,f,e){var t=e(8551);c.exports=function(){var o=t(this),r="";return o.hasIndices&&(r+="d"),o.global&&(r+="g"),o.ignoreCase&&(r+="i"),o.multiline&&(r+="m"),o.dotAll&&(r+="s"),o.unicode&&(r+="u"),o.unicodeSets&&(r+="v"),o.sticky&&(r+="y"),r}},8014:function(c,f,e){var t=e(1291),o=Math.min;c.exports=function(r){var i=t(r);return i>0?o(i,9007199254740991):0}},8183:function(c,f,e){var t=e(9504),o=e(1291),r=e(655),i=e(7750),l=t("".charAt),h=t("".charCodeAt),m=t("".slice),g=function(y){return function(E,w){var b,S,x=r(i(E)),I=o(w),A=x.length;return I<0||I>=A?y?"":void 0:(b=h(x,I))<55296||b>56319||I+1===A||(S=h(x,I+1))<56320||S>57343?y?l(x,I):b:y?m(x,I,I+2):S-56320+(b-55296<<10)+65536}};c.exports={codeAt:g(!1),charAt:g(!0)}},8227:function(c,f,e){var t=e(4576),o=e(5745),r=e(9297),i=e(3392),l=e(4495),h=e(7040),m=t.Symbol,g=o("wks"),y=h?m.for||m:m&&m.withoutSetter||i;c.exports=function(E){return r(g,E)||(g[E]=l&&r(m,E)?m[E]:y("Symbol."+E)),g[E]}},8235:function(c,f,e){var t=e(9504),o=e(9297),r=SyntaxError,i=parseInt,l=String.fromCharCode,h=t("".charAt),m=t("".slice),g=t(/./.exec),y={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},E=/^[\da-f]{4}$/i,w=/^[\u0000-\u001F]$/;c.exports=function(b,S){for(var x=!0,I="";S<b.length;){var A=h(b,S);if(A==="\\"){var O=m(b,S,S+2);if(o(y,O))I+=y[O],S+=2;else{if(O!=="\\u")throw new r('Unknown escape sequence: "'+O+'"');var N=m(b,S+=2,S+4);if(!g(E,N))throw new r("Bad Unicode escape at: "+S);I+=l(i(N,16)),S+=4}}else{if(A==='"'){x=!1,S++;break}if(g(w,A))throw new r("Bad control character in string literal at: "+S);I+=A,S++}}if(x)throw new r("Unterminated string at: "+S);return{value:I,end:S}}},8242:function(c,f,e){var t=e(9565),o=e(7751),r=e(8227),i=e(6840);c.exports=function(){var l=o("Symbol"),h=l&&l.prototype,m=h&&h.valueOf,g=r("toPrimitive");h&&!h[g]&&i(h,g,function(y){return t(m,this)},{arity:1})}},8344:function(c,f,e){e(8543)},8429:function(c,f,e){var t=e(9039),o=e(4576).RegExp,r=t(function(){var h=o("a","y");return h.lastIndex=2,h.exec("abcd")!==null}),i=r||t(function(){return!o("a","y").sticky}),l=r||t(function(){var h=o("^r","gy");return h.lastIndex=2,h.exec("str")!==null});c.exports={BROKEN_CARET:l,MISSED_STICKY:i,UNSUPPORTED_Y:r}},8480:function(c,f,e){var t=e(1828),o=e(8727).concat("length","prototype");f.f=Object.getOwnPropertyNames||function(r){return t(r,o)}},8543:function(c,f,e){var t=e(6518),o=e(9565),r=e(7476),i=e(3994),l=e(2529),h=e(7750),m=e(8014),g=e(655),y=e(8551),E=e(34),w=e(2195),b=e(788),S=e(1034),x=e(5966),I=e(6840),A=e(9039),O=e(8227),N=e(2293),M=e(7829),$=e(6682),L=e(1181),R=e(6395),H=O("matchAll"),U="RegExp String",_=U+" Iterator",ee=L.set,V=L.getterFor(_),G=RegExp.prototype,pe=TypeError,fe=r("".indexOf),W=r("".matchAll),ne=!!W&&!A(function(){W("a",/./)}),Q=i(function(te,re,K,q){ee(this,{type:_,regexp:te,string:re,global:K,unicode:q,done:!1})},U,function(){var te=V(this);if(te.done)return l(void 0,!0);var re=te.regexp,K=te.string,q=$(re,K);return q===null?(te.done=!0,l(void 0,!0)):te.global?(g(q[0])===""&&(re.lastIndex=M(K,m(re.lastIndex),te.unicode)),l(q,!1)):(te.done=!0,l(q,!1))}),X=function(te){var re,K,q,z=y(this),J=g(te),me=N(z,RegExp),ie=g(S(z));return re=new me(me===RegExp?z.source:z,ie),K=!!~fe(ie,"g"),q=!!~fe(ie,"u"),re.lastIndex=m(z.lastIndex),new Q(re,J,K,q)};t({target:"String",proto:!0,forced:ne},{matchAll:function(te){var re,K,q,z,J=h(this);if(E(te)){if(b(te)&&(re=g(h(S(te))),!~fe(re,"g")))throw new pe("`.matchAll` does not allow non-global regexes");if(ne)return W(J,te);if((q=x(te,H))===void 0&&R&&w(te)==="RegExp"&&(q=X),q)return o(q,te,J)}else if(ne)return W(J,te);return K=g(J),z=new RegExp(te,"g"),R?o(X,z,K):z[H](K)}}),R||H in G||I(G,H,X)},8551:function(c,f,e){var t=e(34),o=String,r=TypeError;c.exports=function(i){if(t(i))return i;throw new r(o(i)+" is not an object")}},8598:function(c,f,e){var t=e(6518),o=e(9504),r=e(7055),i=e(5397),l=e(4598),h=o([].join);t({target:"Array",proto:!0,forced:r!==Object||!l("join",",")},{join:function(m){return h(i(this),m===void 0?",":m)}})},8622:function(c,f,e){var t=e(4576),o=e(4901),r=t.WeakMap;c.exports=o(r)&&/native code/.test(String(r))},8686:function(c,f,e){var t=e(3724),o=e(9039);c.exports=t&&o(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},8706:function(c,f,e){var t=e(6518),o=e(9039),r=e(4376),i=e(34),l=e(8981),h=e(6198),m=e(6837),g=e(4659),y=e(1469),E=e(597),w=e(8227),b=e(9519),S=w("isConcatSpreadable"),x=b>=51||!o(function(){var A=[];return A[S]=!1,A.concat()[0]!==A}),I=function(A){if(!i(A))return!1;var O=A[S];return O!==void 0?!!O:r(A)};t({target:"Array",proto:!0,arity:1,forced:!x||!E("concat")},{concat:function(A){var O,N,M,$,L,R=l(this),H=y(R,0),U=0;for(O=-1,M=arguments.length;O<M;O++)if(I(L=O===-1?R:arguments[O]))for($=h(L),m(U+$),N=0;N<$;N++,U++)N in L&&g(H,U,L[N]);else m(U+1),g(H,U++,L);return H.length=U,H}})},8727:function(c){c.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8745:function(c,f,e){var t=e(616),o=Function.prototype,r=o.apply,i=o.call;c.exports=typeof Reflect=="object"&&Reflect.apply||(t?i.bind(r):function(){return i.apply(r,arguments)})},8773:function(c,f){var e={}.propertyIsEnumerable,t=Object.getOwnPropertyDescriptor,o=t&&!e.call({1:2},1);f.f=o?function(r){var i=t(this,r);return!!i&&i.enumerable}:e},8781:function(c,f,e){var t=e(350).PROPER,o=e(6840),r=e(8551),i=e(655),l=e(9039),h=e(1034),m="toString",g=RegExp.prototype,y=g[m],E=l(function(){return y.call({source:"a",flags:"b"})!=="/a/b"}),w=t&&y.name!==m;(E||w)&&o(g,m,function(){var b=r(this);return"/"+i(b.source)+"/"+i(h(b))},{unsafe:!0})},8814:function(c,f,e){var t=e(9039),o=e(4576).RegExp;c.exports=t(function(){var r=o("(?<a>b)","g");return r.exec("b").groups.a!=="b"||"b".replace(r,"$<a>c")!=="bc"})},8981:function(c,f,e){var t=e(7750),o=Object;c.exports=function(r){return o(t(r))}},9039:function(c){c.exports=function(f){try{return!!f()}catch{return!0}}},9085:function(c,f,e){var t=e(6518),o=e(4213);t({target:"Object",stat:!0,arity:2,forced:Object.assign!==o},{assign:o})},9167:function(c,f,e){var t=e(4576);c.exports=t},9213:function(c,f,e){var t=e(6080),o=e(9504),r=e(7055),i=e(8981),l=e(6198),h=e(1469),m=o([].push),g=function(y){var E=y===1,w=y===2,b=y===3,S=y===4,x=y===6,I=y===7,A=y===5||x;return function(O,N,M,$){for(var L,R,H=i(O),U=r(H),_=l(U),ee=t(N,M),V=0,G=$||h,pe=E?G(O,_):w||I?G(O,0):void 0;_>V;V++)if((A||V in U)&&(R=ee(L=U[V],V,H),y))if(E)pe[V]=R;else if(R)switch(y){case 3:return!0;case 5:return L;case 6:return V;case 2:m(pe,L)}else switch(y){case 4:return!1;case 7:m(pe,L)}return x?-1:b||S?S:pe}};c.exports={forEach:g(0),map:g(1),filter:g(2),some:g(3),every:g(4),find:g(5),findIndex:g(6),filterReject:g(7)}},9228:function(c,f,e){e(7495);var t=e(9565),o=e(6840),r=e(7323),i=e(9039),l=e(8227),h=e(6699),m=l("species"),g=RegExp.prototype;c.exports=function(y,E,w,b){var S=l(y),x=!i(function(){var N={};return N[S]=function(){return 7},""[y](N)!==7}),I=x&&!i(function(){var N=!1,M=/a/;if(y==="split"){var $={};$[m]=function(){return M},(M={constructor:$,flags:""})[S]=/./[S]}return M.exec=function(){return N=!0,null},M[S](""),!N});if(!x||!I||w){var A=/./[S],O=E(S,""[y],function(N,M,$,L,R){var H=M.exec;return H===r||H===g.exec?x&&!R?{done:!0,value:t(A,M,$,L)}:{done:!0,value:t(N,$,M,L)}:{done:!1}});o(String.prototype,y,O[0]),o(g,S,O[1])}b&&h(g[S],"sham",!0)}},9296:function(c,f,e){var t=e(4055)("span").classList,o=t&&t.constructor&&t.constructor.prototype;c.exports=o===Object.prototype?void 0:o},9297:function(c,f,e){var t=e(9504),o=e(8981),r=t({}.hasOwnProperty);c.exports=Object.hasOwn||function(i,l){return r(o(i),l)}},9306:function(c,f,e){var t=e(4901),o=e(6823),r=TypeError;c.exports=function(i){if(t(i))return i;throw new r(o(i)+" is not a function")}},9432:function(c,f,e){var t=e(6518),o=e(8981),r=e(1072);t({target:"Object",stat:!0,forced:e(9039)(function(){r(1)})},{keys:function(i){return r(o(i))}})},9433:function(c,f,e){var t=e(4576),o=Object.defineProperty;c.exports=function(r,i){try{o(t,r,{value:i,configurable:!0,writable:!0})}catch{t[r]=i}return i}},9463:function(c,f,e){var t=e(6518),o=e(3724),r=e(4576),i=e(9504),l=e(9297),h=e(4901),m=e(1625),g=e(655),y=e(2106),E=e(7740),w=r.Symbol,b=w&&w.prototype;if(o&&h(w)&&(!("description"in b)||w().description!==void 0)){var S={},x=function(){var L=arguments.length<1||arguments[0]===void 0?void 0:g(arguments[0]),R=m(b,this)?new w(L):L===void 0?w():w(L);return L===""&&(S[R]=!0),R};E(x,w),x.prototype=b,b.constructor=x;var I=String(w("description detection"))==="Symbol(description detection)",A=i(b.valueOf),O=i(b.toString),N=/^Symbol\((.*)\)[^)]+$/,M=i("".replace),$=i("".slice);y(b,"description",{configurable:!0,get:function(){var L=A(this);if(l(S,L))return"";var R=O(L),H=I?$(R,7,-1):M(R,N,"$1");return H===""?void 0:H}}),t({global:!0,constructor:!0,forced:!0},{Symbol:x})}},9504:function(c,f,e){var t=e(616),o=Function.prototype,r=o.call,i=t&&o.bind.bind(r,r);c.exports=t?i:function(l){return function(){return r.apply(l,arguments)}}},9519:function(c,f,e){var t,o,r=e(4576),i=e(2839),l=r.process,h=r.Deno,m=l&&l.versions||h&&h.version,g=m&&m.v8;g&&(o=(t=g.split("."))[0]>0&&t[0]<4?1:+(t[0]+t[1])),!o&&i&&(!(t=i.match(/Edge\/(\d+)/))||t[1]>=74)&&(t=i.match(/Chrome\/(\d+)/))&&(o=+t[1]),c.exports=o},9539:function(c,f,e){var t=e(9565),o=e(8551),r=e(5966);c.exports=function(i,l,h){var m,g;o(i);try{if(!(m=r(i,"return"))){if(l==="throw")throw h;return h}m=t(m,i)}catch(y){g=!0,m=y}if(l==="throw")throw h;if(g)throw m;return o(m),h}},9565:function(c,f,e){var t=e(616),o=Function.prototype.call;c.exports=t?o.bind(o):function(){return o.apply(o,arguments)}},9572:function(c,f,e){var t=e(9297),o=e(6840),r=e(3640),i=e(8227)("toPrimitive"),l=Date.prototype;t(l,i)||o(l,i,r)},9617:function(c,f,e){var t=e(5397),o=e(5610),r=e(6198),i=function(l){return function(h,m,g){var y=t(h),E=r(y);if(E===0)return!l&&-1;var w,b=o(g,E);if(l&&m!=m){for(;E>b;)if((w=y[b++])!=w)return!0}else for(;E>b;b++)if((l||b in y)&&y[b]===m)return l||b||0;return!l&&-1}};c.exports={includes:i(!0),indexOf:i(!1)}},9773:function(c,f,e){var t=e(6518),o=e(4495),r=e(9039),i=e(3717),l=e(8981);t({target:"Object",stat:!0,forced:!o||r(function(){i.f(1)})},{getOwnPropertySymbols:function(h){var m=i.f;return m?m(l(h)):[]}})}},u={};function d(c){var f=u[c];if(f!==void 0)return f.exports;var e=u[c]={exports:{}};return s[c].call(e.exports,e,e.exports,d),e.exports}d.d=function(c,f){for(var e in f)d.o(f,e)&&!d.o(c,e)&&Object.defineProperty(c,e,{enumerable:!0,get:f[e]})},d.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),d.o=function(c,f){return Object.prototype.hasOwnProperty.call(c,f)},d.r=function(c){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})};var p={};d.r(p),d.d(p,{SimpleKeyboard:function(){return Dt},default:function(){return B}}),d(5276),d(8598),d(4782),d(4554),d(2010),d(7427),d(6099),d(7495),d(8781),d(5440),d(744),d(2762),typeof Element>"u"||"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),typeof self<"u"&&"document"in self&&((!("classList"in document.createElement("_"))||document.createElementNS&&!("classList"in document.createElementNS("http://www.w3.org/2000/svg","g")))&&function(c){if("Element"in c){var f="classList",e="prototype",t=c.Element[e],o=Object,r=String[e].trim||function(){return this.replace(/^\s+|\s+$/g,"")},i=Array[e].indexOf||function(w){for(var b=0,S=this.length;b<S;b++)if(b in this&&this[b]===w)return b;return-1},l=function(w,b){this.name=w,this.code=DOMException[w],this.message=b},h=function(w,b){if(b==="")throw new l("SYNTAX_ERR","The token must not be empty.");if(/\s/.test(b))throw new l("INVALID_CHARACTER_ERR","The token must not contain space characters.");return i.call(w,b)},m=function(w){for(var b=r.call(w.getAttribute("class")||""),S=b?b.split(/\s+/):[],x=0,I=S.length;x<I;x++)this.push(S[x]);this._updateClassName=function(){w.setAttribute("class",this.toString())}},g=m[e]=[],y=function(){return new m(this)};if(l[e]=Error[e],g.item=function(w){return this[w]||null},g.contains=function(w){return~h(this,w+"")},g.add=function(){var w,b=arguments,S=0,x=b.length,I=!1;do~h(this,w=b[S]+"")||(this.push(w),I=!0);while(++S<x);I&&this._updateClassName()},g.remove=function(){var w,b,S=arguments,x=0,I=S.length,A=!1;do for(b=h(this,w=S[x]+"");~b;)this.splice(b,1),A=!0,b=h(this,w);while(++x<I);A&&this._updateClassName()},g.toggle=function(w,b){var S=this.contains(w),x=S?b!==!0&&"remove":b!==!1&&"add";return x&&this[x](w),b===!0||b===!1?b:!S},g.replace=function(w,b){var S=h(w+"");~S&&(this.splice(S,1,b),this._updateClassName())},g.toString=function(){return this.join(" ")},o.defineProperty){var E={get:y,enumerable:!0,configurable:!0};try{o.defineProperty(t,f,E)}catch(w){w.number!==void 0&&w.number!==-2146823252||(E.enumerable=!1,o.defineProperty(t,f,E))}}else o[e].__defineGetter__&&t.__defineGetter__(f,y)}}(self),function(){var c=document.createElement("_");if(c.classList.add("c1","c2"),!c.classList.contains("c2")){var f=function(t){var o=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(r){var i,l=arguments.length;for(i=0;i<l;i++)r=arguments[i],o.call(this,r)}};f("add"),f("remove")}if(c.classList.toggle("c3",!1),c.classList.contains("c3")){var e=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,o){return 1 in arguments&&!this.contains(t)==!o?o:e.call(this,t)}}"replace"in document.createElement("_").classList||(DOMTokenList.prototype.replace=function(t,o){var r=this.toString().split(" "),i=r.indexOf(t+"");~i&&(r=r.slice(i),this.remove.apply(this,r),this.add(o),this.add.apply(this,r.slice(1)))}),c=null}()),d(2675),d(9463),d(2259),d(5700),d(8706),d(2008),d(3418),d(4423),d(3792),d(2062),d(6910),d(739),d(9572),d(2892),d(9085),d(3851),d(1278),d(9432),d(4864),d(1699),d(7764),d(8344),d(3500),d(2953),d(2712),d(2637),d(1480),d(825),d(1761);function v(c){return function(f){if(Array.isArray(f))return T(f)}(c)||function(f){if(typeof Symbol<"u"&&f[Symbol.iterator]!=null||f["@@iterator"]!=null)return Array.from(f)}(c)||k(c)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function k(c,f){if(c){if(typeof c=="string")return T(c,f);var e={}.toString.call(c).slice(8,-1);return e==="Object"&&c.constructor&&(e=c.constructor.name),e==="Map"||e==="Set"?Array.from(c):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?T(c,f):void 0}}function T(c,f){(f==null||f>c.length)&&(f=c.length);for(var e=0,t=Array(f);e<f;e++)t[e]=c[e];return t}function P(c){return P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},P(c)}function C(c,f){for(var e=0;e<f.length;e++){var t=f[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(c,F(t.key),t)}}function D(c,f,e){return(f=F(f))in c?Object.defineProperty(c,f,{value:e,enumerable:!0,configurable:!0,writable:!0}):c[f]=e,c}function F(c){var f=function(e,t){if(P(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var r=o.call(e,t);if(P(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}(c,"string");return P(f)=="symbol"?f:f+""}var j=function(){return c=function t(o){var r=o.getOptions,i=o.getCaretPosition,l=o.getCaretPositionEnd,h=o.dispatch;(function(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")})(this,t),D(this,"getOptions",void 0),D(this,"getCaretPosition",void 0),D(this,"getCaretPositionEnd",void 0),D(this,"dispatch",void 0),D(this,"maxLengthReached",void 0),D(this,"isStandardButton",function(m){return m&&!(m[0]==="{"&&m[m.length-1]==="}")}),this.getOptions=r,this.getCaretPosition=i,this.getCaretPositionEnd=l,this.dispatch=h,t.bindMethods(t,this)},f=[{key:"getButtonType",value:function(t){return t.includes("{")&&t.includes("}")&&t!=="{//}"?"functionBtn":"standardBtn"}},{key:"getButtonClass",value:function(t){var o=this.getButtonType(t),r=t.replace("{","").replace("}",""),i="";return o!=="standardBtn"&&(i=" hg-button-".concat(r)),"hg-".concat(o).concat(i)}},{key:"getDefaultDiplay",value:function(){return{"{bksp}":"backspace","{backspace}":"backspace","{enter}":"< enter","{shift}":"shift","{shiftleft}":"shift","{shiftright}":"shift","{alt}":"alt","{s}":"shift","{tab}":"tab","{lock}":"caps","{capslock}":"caps","{accept}":"Submit","{space}":" ","{//}":" ","{esc}":"esc","{escape}":"esc","{f1}":"f1","{f2}":"f2","{f3}":"f3","{f4}":"f4","{f5}":"f5","{f6}":"f6","{f7}":"f7","{f8}":"f8","{f9}":"f9","{f10}":"f10","{f11}":"f11","{f12}":"f12","{numpaddivide}":"/","{numlock}":"lock","{arrowup}":"↑","{arrowleft}":"←","{arrowdown}":"↓","{arrowright}":"→","{prtscr}":"print","{scrolllock}":"scroll","{pause}":"pause","{insert}":"ins","{home}":"home","{pageup}":"up","{delete}":"del","{forwarddelete}":"del","{end}":"end","{pagedown}":"down","{numpadmultiply}":"*","{numpadsubtract}":"-","{numpadadd}":"+","{numpadenter}":"enter","{period}":".","{numpaddecimal}":".","{numpad0}":"0","{numpad1}":"1","{numpad2}":"2","{numpad3}":"3","{numpad4}":"4","{numpad5}":"5","{numpad6}":"6","{numpad7}":"7","{numpad8}":"8","{numpad9}":"9"}}},{key:"getButtonDisplayName",value:function(t,o){return(o=arguments.length>2&&arguments[2]!==void 0&&arguments[2]?Object.assign({},this.getDefaultDiplay(),o):o||this.getDefaultDiplay())[t]||t}},{key:"getUpdatedInput",value:function(t,o,r){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r,l=arguments.length>4&&arguments[4]!==void 0&&arguments[4],h=this.getOptions(),m=[r,i,l],g=o;return(t==="{bksp}"||t==="{backspace}")&&g.length>0?g=this.removeAt.apply(this,[g].concat(m)):(t==="{delete}"||t==="{forwarddelete}")&&g.length>0?g=this.removeForwardsAt.apply(this,[g].concat(m)):t==="{space}"?g=this.addStringAt.apply(this,[g," "].concat(m)):t!=="{tab}"||typeof h.tabCharOnTab=="boolean"&&h.tabCharOnTab===!1?t!=="{enter}"&&t!=="{numpadenter}"||!h.newLineOnEnter?t.includes("numpad")&&Number.isInteger(Number(t[t.length-2]))?g=this.addStringAt.apply(this,[g,t[t.length-2]].concat(m)):t==="{numpaddivide}"?g=this.addStringAt.apply(this,[g,"/"].concat(m)):t==="{numpadmultiply}"?g=this.addStringAt.apply(this,[g,"*"].concat(m)):t==="{numpadsubtract}"?g=this.addStringAt.apply(this,[g,"-"].concat(m)):t==="{numpadadd}"?g=this.addStringAt.apply(this,[g,"+"].concat(m)):t==="{numpaddecimal}"?g=this.addStringAt.apply(this,[g,"."].concat(m)):t==="{"||t==="}"?g=this.addStringAt.apply(this,[g,t].concat(m)):t.includes("{")||t.includes("}")||(g=this.addStringAt.apply(this,[g,t].concat(m))):g=this.addStringAt.apply(this,[g,`
`].concat(m)):g=this.addStringAt.apply(this,[g,"	"].concat(m)),h.debug&&console.log("Input will be: "+g),g}},{key:"updateCaretPos",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0&&arguments[1],r=this.updateCaretPosAction(t,o);this.dispatch(function(i){i.setCaretPosition(r)})}},{key:"updateCaretPosAction",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0&&arguments[1],r=this.getOptions(),i=this.getCaretPosition();return i!=null&&(o?i>0&&(i-=t):i+=t),r.debug&&console.log("Caret at:",i),i}},{key:"addStringAt",value:function(t,o){var r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:t.length,h=arguments.length>4&&arguments[4]!==void 0&&arguments[4];return i||i===0?(r=[t.slice(0,i),o,t.slice(l)].join(""),this.isMaxLengthReached()||h&&this.updateCaretPos(o.length)):r=t+o,r}},{key:"removeAt",value:function(t){var o,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.length,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,l=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(r===0&&i===0)return t;if(r===i){var h=/([\uD800-\uDBFF][\uDC00-\uDFFF])/g;r&&r>=0?t.substring(r-2,r).match(h)?(o=t.substr(0,r-2)+t.substr(r),l&&this.updateCaretPos(2,!0)):(o=t.substr(0,r-1)+t.substr(r),l&&this.updateCaretPos(1,!0)):t.slice(-2).match(h)?(o=t.slice(0,-2),l&&this.updateCaretPos(2,!0)):(o=t.slice(0,-1),l&&this.updateCaretPos(1,!0))}else o=t.slice(0,r)+t.slice(i),l&&this.dispatch(function(m){m.setCaretPosition(r)});return o}},{key:"removeForwardsAt",value:function(t){var o,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.length,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,l=arguments.length>3&&arguments[3]!==void 0&&arguments[3];return t!=null&&t.length&&r!==null?(r===i?o=t.substring(r,r+2).match(/([\uD800-\uDBFF][\uDC00-\uDFFF])/g)?t.substr(0,r)+t.substr(r+2):t.substr(0,r)+t.substr(r+1):(o=t.slice(0,r)+t.slice(i),l&&this.dispatch(function(h){h.setCaretPosition(r)})),o):t}},{key:"handleMaxLength",value:function(t,o){var r=this.getOptions(),i=r.maxLength,l=t[r.inputName||"default"],h=o.length-1>=i;if(o.length<=l.length)return!1;if(Number.isInteger(i))return r.debug&&console.log("maxLength (num) reached:",h),h?(this.maxLengthReached=!0,!0):(this.maxLengthReached=!1,!1);if(P(i)==="object"){var m=o.length-1>=i[r.inputName||"default"];return r.debug&&console.log("maxLength (obj) reached:",m),m?(this.maxLengthReached=!0,!0):(this.maxLengthReached=!1,!1)}}},{key:"isMaxLengthReached",value:function(){return!!this.maxLengthReached}},{key:"isTouchDevice",value:function(){return"ontouchstart"in window||navigator.maxTouchPoints}},{key:"pointerEventsSupported",value:function(){return!!window.PointerEvent}},{key:"camelCase",value:function(t){return t?t.toLowerCase().trim().split(/[.\-_\s]/g).reduce(function(o,r){return r.length?o+r[0].toUpperCase()+r.slice(1):o}):""}},{key:"chunkArray",value:function(t,o){return v(Array(Math.ceil(t.length/o))).map(function(r,i){return t.slice(o*i,o+o*i)})}},{key:"escapeRegex",value:function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}},{key:"getRtlOffset",value:function(t,o){var r=t,i=o.indexOf("‫");return i<t&&i!=-1&&r--,o.indexOf("‬")<t&&i!=-1&&r--,r<0?0:r}},{key:"isConstructor",value:function(t){try{Reflect.construct(String,[],t)}catch{return!1}return!0}}],e=[{key:"bindMethods",value:function(t,o){var r,i=function(h,m){var g=typeof Symbol<"u"&&h[Symbol.iterator]||h["@@iterator"];if(!g){if(Array.isArray(h)||(g=k(h))||m){g&&(h=g);var y=0,E=function(){};return{s:E,n:function(){return y>=h.length?{done:!0}:{done:!1,value:h[y++]}},e:function(x){throw x},f:E}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var w,b=!0,S=!1;return{s:function(){g=g.call(h)},n:function(){var x=g.next();return b=x.done,x},e:function(x){S=!0,w=x},f:function(){try{b||g.return==null||g.return()}finally{if(S)throw w}}}}(Object.getOwnPropertyNames(t.prototype));try{for(i.s();!(r=i.n()).done;){var l=r.value;l==="constructor"||l==="bindMethods"||(o[l]=o[l].bind(o))}}catch(h){i.e(h)}finally{i.f()}}}],f&&C(c.prototype,f),e&&C(c,e),Object.defineProperty(c,"prototype",{writable:!1}),c;var c,f,e}();D(j,"noop",function(){});var Y=j;function Z(c){return Z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},Z(c)}function ye(c,f){for(var e=0;e<f.length;e++){var t=f[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(c,oe(t.key),t)}}function ue(c,f,e){return(f=oe(f))in c?Object.defineProperty(c,f,{value:e,enumerable:!0,configurable:!0,writable:!0}):c[f]=e,c}function oe(c){var f=function(e,t){if(Z(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var r=o.call(e,t);if(Z(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}(c,"string");return Z(f)=="symbol"?f:f+""}var le=function(){return c=function t(o){var r=this,i=o.dispatch,l=o.getOptions;(function(h,m){if(!(h instanceof m))throw new TypeError("Cannot call a class as a function")})(this,t),ue(this,"getOptions",void 0),ue(this,"dispatch",void 0),ue(this,"isModifierKey",function(h){return h.altKey||h.ctrlKey||h.shiftKey||["Tab","CapsLock","Esc","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(h.code||h.key||r.keyCodeToKey(h==null?void 0:h.keyCode))}),this.dispatch=i,this.getOptions=l,Y.bindMethods(t,this)},f=[{key:"handleHighlightKeyDown",value:function(t){var o=this.getOptions();o.physicalKeyboardHighlightPreventDefault&&this.isModifierKey(t)&&(t.preventDefault(),t.stopImmediatePropagation());var r=this.getSimpleKeyboardLayoutKey(t);this.dispatch(function(i){var l,h,m=i.getButtonElement(r),g=i.getButtonElement("{".concat(r,"}"));if(m)l=m,h=r;else{if(!g)return;l=g,h="{".concat(r,"}")}var y,E,w,b,S=function(I){I.style.background=o.physicalKeyboardHighlightBgColor||"#dadce4",I.style.color=o.physicalKeyboardHighlightTextColor||"black"};if(l)if(Array.isArray(l)){if(l.forEach(function(I){return S(I)}),o.physicalKeyboardHighlightPress)if(o.physicalKeyboardHighlightPressUsePointerEvents)(y=l[0])===null||y===void 0||(E=y.onpointerdown)===null||E===void 0||E.call(y,t);else if(o.physicalKeyboardHighlightPressUseClick){var x;(x=l[0])===null||x===void 0||x.click()}else i.handleButtonClicked(h,t)}else S(l),o.physicalKeyboardHighlightPress&&(o.physicalKeyboardHighlightPressUsePointerEvents?(w=l)===null||w===void 0||(b=w.onpointerdown)===null||b===void 0||b.call(w,t):o.physicalKeyboardHighlightPressUseClick?l.click():i.handleButtonClicked(h,t))})}},{key:"handleHighlightKeyUp",value:function(t){var o=this.getOptions();o.physicalKeyboardHighlightPreventDefault&&this.isModifierKey(t)&&(t.preventDefault(),t.stopImmediatePropagation());var r=this.getSimpleKeyboardLayoutKey(t);this.dispatch(function(i){var l,h,m,g=i.getButtonElement(r)||i.getButtonElement("{".concat(r,"}")),y=function(E){E.removeAttribute&&E.removeAttribute("style")};g&&(Array.isArray(g)?(g.forEach(function(E){return y(E)}),o.physicalKeyboardHighlightPressUsePointerEvents&&((l=g[0])===null||l===void 0||(h=l.onpointerup)===null||h===void 0||h.call(l,t))):(y(g),o.physicalKeyboardHighlightPressUsePointerEvents&&(g==null||(m=g.onpointerup)===null||m===void 0||m.call(g,t))))})}},{key:"getSimpleKeyboardLayoutKey",value:function(t){var o,r="",i=t.code||t.key||this.keyCodeToKey(t==null?void 0:t.keyCode);return(r=i!=null&&i.includes("Numpad")||i!=null&&i.includes("Shift")||i!=null&&i.includes("Space")||i!=null&&i.includes("Backspace")||i!=null&&i.includes("Control")||i!=null&&i.includes("Alt")||i!=null&&i.includes("Meta")?t.code||"":t.key||this.keyCodeToKey(t==null?void 0:t.keyCode)||"").length>1?(o=r)===null||o===void 0?void 0:o.toLowerCase():r}},{key:"keyCodeToKey",value:function(t){return{8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"Meta",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9",106:"NumpadMultiply",107:"NumpadAdd",109:"NumpadSubtract",110:"NumpadDecimal",111:"NumpadDivide",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}[t]||""}}],f&&ye(c.prototype,f),e&&ye(c,e),Object.defineProperty(c,"prototype",{writable:!1}),c;var c,f,e}();function ge(c){return ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},ge(c)}function Tt(c,f){for(var e=0;e<f.length;e++){var t=f[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(c,ot(t.key),t)}}function Fe(c,f,e){return(f=ot(f))in c?Object.defineProperty(c,f,{value:e,enumerable:!0,configurable:!0,writable:!0}):c[f]=e,c}function ot(c){var f=function(e,t){if(ge(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var r=o.call(e,t);if(ge(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}(c,"string");return ge(f)=="symbol"?f:f+""}var At=function(){return c=function t(o){var r=o.utilities,i=o.options;(function(l,h){if(!(l instanceof h))throw new TypeError("Cannot call a class as a function")})(this,t),Fe(this,"utilities",void 0),Fe(this,"options",void 0),Fe(this,"candidateBoxElement",void 0),Fe(this,"pageIndex",0),Fe(this,"pageSize",void 0),this.utilities=r,this.options=i,Y.bindMethods(t,this),this.pageSize=this.utilities.getOptions().layoutCandidatesPageSize||5},f=[{key:"destroy",value:function(){this.candidateBoxElement&&(this.candidateBoxElement.remove(),this.pageIndex=0)}},{key:"show",value:function(t){var o=this,r=t.candidateValue,i=t.targetElement,l=t.onSelect;if(r&&r.length){var h=this.utilities.chunkArray(r.split(" "),this.pageSize);this.renderPage({candidateListPages:h,targetElement:i,pageIndex:this.pageIndex,nbPages:h.length,onItemSelected:function(m,g){l(m,g),o.destroy()}})}}},{key:"renderPage",value:function(t){var o,r=this,i=t.candidateListPages,l=t.targetElement,h=t.pageIndex,m=t.nbPages,g=t.onItemSelected;(o=this.candidateBoxElement)===null||o===void 0||o.remove(),this.candidateBoxElement=document.createElement("div"),this.candidateBoxElement.className="hg-candidate-box";var y=document.createElement("ul");y.className="hg-candidate-box-list",i[h].forEach(function(A){var O,N=document.createElement("li"),M=function(){var $=new(r.options.useTouchEvents?TouchEvent:MouseEvent)("click");return Object.defineProperty($,"target",{value:N}),$};N.className="hg-candidate-box-list-item",N.innerHTML=((O=r.options.display)===null||O===void 0?void 0:O[A])||A,r.options.useTouchEvents?N.ontouchstart=function($){return g(A,$||M())}:N.onclick=function(){var $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:M();return g(A,$)},y.appendChild(N)});var E=h>0,w=document.createElement("div");w.classList.add("hg-candidate-box-prev"),E&&w.classList.add("hg-candidate-box-btn-active");var b=function(){E&&r.renderPage({candidateListPages:i,targetElement:l,pageIndex:h-1,nbPages:m,onItemSelected:g})};this.options.useTouchEvents?w.ontouchstart=b:w.onclick=b,this.candidateBoxElement.appendChild(w),this.candidateBoxElement.appendChild(y);var S=h<m-1,x=document.createElement("div");x.classList.add("hg-candidate-box-next"),S&&x.classList.add("hg-candidate-box-btn-active");var I=function(){S&&r.renderPage({candidateListPages:i,targetElement:l,pageIndex:h+1,nbPages:m,onItemSelected:g})};this.options.useTouchEvents?x.ontouchstart=I:x.onclick=I,this.candidateBoxElement.appendChild(x),l.prepend(this.candidateBoxElement)}}],f&&Tt(c.prototype,f),e&&Tt(c,e),Object.defineProperty(c,"prototype",{writable:!1}),c;var c,f,e}(),rt=At;function ze(c){return function(f){if(Array.isArray(f))return Ve(f)}(c)||function(f){if(typeof Symbol<"u"&&f[Symbol.iterator]!=null||f["@@iterator"]!=null)return Array.from(f)}(c)||function(f,e){if(f){if(typeof f=="string")return Ve(f,e);var t={}.toString.call(f).slice(8,-1);return t==="Object"&&f.constructor&&(t=f.constructor.name),t==="Map"||t==="Set"?Array.from(f):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ve(f,e):void 0}}(c)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ve(c,f){(f==null||f>c.length)&&(f=c.length);for(var e=0,t=Array(f);e<f;e++)t[e]=c[e];return t}function Ge(c){return Ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},Ge(c)}function _t(c,f){var e=Object.keys(c);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(c);f&&(t=t.filter(function(o){return Object.getOwnPropertyDescriptor(c,o).enumerable})),e.push.apply(e,t)}return e}function Xt(c,f){for(var e=0;e<f.length;e++){var t=f[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(c,Jt(t.key),t)}}function he(c,f,e){return(f=Jt(f))in c?Object.defineProperty(c,f,{value:e,enumerable:!0,configurable:!0,writable:!0}):c[f]=e,c}function Jt(c){var f=function(e,t){if(Ge(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var r=o.call(e,t);if(Ge(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}(c,"string");return Ge(f)=="symbol"?f:f+""}var Zt=function(){return c=function t(o,r){var i=this;if(function(b,S){if(!(b instanceof S))throw new TypeError("Cannot call a class as a function")}(this,t),he(this,"input",void 0),he(this,"options",void 0),he(this,"utilities",void 0),he(this,"caretPosition",void 0),he(this,"caretPositionEnd",void 0),he(this,"keyboardDOM",void 0),he(this,"keyboardPluginClasses",void 0),he(this,"keyboardDOMClass",void 0),he(this,"buttonElements",void 0),he(this,"currentInstanceName",void 0),he(this,"allKeyboardInstances",void 0),he(this,"keyboardInstanceNames",void 0),he(this,"isFirstKeyboardInstance",void 0),he(this,"physicalKeyboard",void 0),he(this,"modules",void 0),he(this,"activeButtonClass",void 0),he(this,"holdInteractionTimeout",void 0),he(this,"holdTimeout",void 0),he(this,"isMouseHold",void 0),he(this,"initialized",void 0),he(this,"candidateBox",void 0),he(this,"keyboardRowsDOM",void 0),he(this,"defaultName","default"),he(this,"activeInputElement",null),he(this,"handleParams",function(b,S){var x,I,A;if(typeof b=="string")x=b.split(".").join(""),I=document.querySelector(".".concat(x)),A=S;else if(b instanceof HTMLDivElement){if(!b.className)throw console.warn("Any DOM element passed as parameter must have a class."),new Error("KEYBOARD_DOM_CLASS_ERROR");x=b.className.split(" ")[0],I=b,A=S}else x="simple-keyboard",I=document.querySelector(".".concat(x)),A=b;return{keyboardDOMClass:x,keyboardDOM:I,options:A}}),he(this,"getOptions",function(){return i.options}),he(this,"getCaretPosition",function(){return i.caretPosition}),he(this,"getCaretPositionEnd",function(){return i.caretPositionEnd}),he(this,"registerModule",function(b,S){i.modules[b]||(i.modules[b]={}),S(i.modules[b])}),he(this,"getKeyboardClassString",function(){for(var b=arguments.length,S=new Array(b),x=0;x<b;x++)S[x]=arguments[x];return[i.keyboardDOMClass].concat(S).filter(function(I){return!!I}).join(" ")}),typeof window<"u"){var l=this.handleParams(o,r),h=l.keyboardDOMClass,m=l.keyboardDOM,g=l.options,y=g===void 0?{}:g;this.utilities=new Y({getOptions:this.getOptions,getCaretPosition:this.getCaretPosition,getCaretPositionEnd:this.getCaretPositionEnd,dispatch:this.dispatch}),this.caretPosition=null,this.caretPositionEnd=null,this.keyboardDOM=m,this.options=function(b){for(var S=1;S<arguments.length;S++){var x=arguments[S]!=null?arguments[S]:{};S%2?_t(Object(x),!0).forEach(function(I){he(b,I,x[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(x)):_t(Object(x)).forEach(function(I){Object.defineProperty(b,I,Object.getOwnPropertyDescriptor(x,I))})}return b}({layoutName:"default",theme:"hg-theme-default",inputName:"default",preventMouseDownDefault:!1,enableLayoutCandidates:!0,excludeFromLayout:{}},y),this.keyboardPluginClasses="",Y.bindMethods(t,this);var E=this.options.inputName,w=E===void 0?this.defaultName:E;if(this.input={},this.input[w]="",this.keyboardDOMClass=h,this.buttonElements={},window.SimpleKeyboardInstances||(window.SimpleKeyboardInstances={}),this.currentInstanceName=this.utilities.camelCase(this.keyboardDOMClass),window.SimpleKeyboardInstances[this.currentInstanceName]=this,this.allKeyboardInstances=window.SimpleKeyboardInstances,this.keyboardInstanceNames=Object.keys(window.SimpleKeyboardInstances),this.isFirstKeyboardInstance=this.keyboardInstanceNames[0]===this.currentInstanceName,this.physicalKeyboard=new le({dispatch:this.dispatch,getOptions:this.getOptions}),this.candidateBox=this.options.enableLayoutCandidates?new rt({utilities:this.utilities,options:this.options}):null,!this.keyboardDOM)throw console.warn('".'.concat(h,'" was not found in the DOM.')),new Error("KEYBOARD_DOM_ERROR");this.render(),this.modules={},this.loadModules()}},f=[{key:"setCaretPosition",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t;this.caretPosition=t,this.caretPositionEnd=o}},{key:"getInputCandidates",value:function(t){var o=this,r=this.options,i=r.layoutCandidates,l=r.layoutCandidatesCaseSensitiveMatch;if(!i||Ge(i)!=="object")return{};var h=Object.keys(i).filter(function(y){var E=t.substring(0,o.getCaretPositionEnd()||0)||t,w=new RegExp("".concat(o.utilities.escapeRegex(y),"$"),l?"g":"gi");return!!ze(E.matchAll(w)).length});if(h.length>1){var m=h.sort(function(y,E){return E.length-y.length})[0];return{candidateKey:m,candidateValue:i[m]}}if(h.length){var g=h[0];return{candidateKey:g,candidateValue:i[g]}}return{}}},{key:"showCandidatesBox",value:function(t,o,r){var i=this;this.candidateBox&&this.candidateBox.show({candidateValue:o,targetElement:r,onSelect:function(l,h){var m=i.options,g=m.layoutCandidatesCaseSensitiveMatch,y=m.disableCandidateNormalization,E=m.enableLayoutCandidatesKeyPress,w=l;y||(w=l.normalize("NFD")),typeof i.options.beforeInputUpdate=="function"&&i.options.beforeInputUpdate(i);var b=i.getInput(i.options.inputName,!0),S=i.getCaretPositionEnd()||0,x=b.substring(0,S||0)||b,I=new RegExp("".concat(i.utilities.escapeRegex(t),"$"),g?"g":"gi"),A=x.replace(I,w),O=b.replace(x,A),N=A.length-x.length,M=(S||b.length)+N;M<0&&(M=0),i.setInput(O,i.options.inputName,!0),i.setCaretPosition(M),E&&typeof i.options.onKeyPress=="function"&&i.options.onKeyPress(l,h),typeof i.options.onChange=="function"&&i.options.onChange(i.getInput(i.options.inputName,!0),h),typeof i.options.onChangeAll=="function"&&i.options.onChangeAll(i.getAllInputs(),h)}})}},{key:"handleButtonClicked",value:function(t,o){var r=this.options,i=r.inputName,l=i===void 0?this.defaultName:i,h=r.debug;if(t!=="{//}"){this.input[l]||(this.input[l]=""),typeof this.options.beforeInputUpdate=="function"&&this.options.beforeInputUpdate(this);var m=this.utilities.getUpdatedInput(t,this.input[l],this.caretPosition,this.caretPositionEnd);if(this.utilities.isStandardButton(t)&&this.activeInputElement&&this.input[l]&&this.input[l]===m&&this.caretPosition===0&&this.caretPositionEnd===m.length)return this.setInput("",this.options.inputName,!0),this.setCaretPosition(0),this.activeInputElement.value="",this.activeInputElement.setSelectionRange(0,0),void this.handleButtonClicked(t,o);if(typeof this.options.onKeyPress=="function"&&this.options.onKeyPress(t,o),this.input[l]!==m&&(!this.options.inputPattern||this.options.inputPattern&&this.inputPatternIsValid(m))){if(this.options.maxLength&&this.utilities.handleMaxLength(this.input,m))return;var g=this.utilities.getUpdatedInput(t,this.input[l],this.caretPosition,this.caretPositionEnd,!0);if(this.setInput(g,this.options.inputName,!0),h&&console.log("Input changed:",this.getAllInputs()),this.options.debug&&console.log("Caret at: ",this.getCaretPosition(),this.getCaretPositionEnd(),"(".concat(this.keyboardDOMClass,")"),o==null?void 0:o.type),this.options.syncInstanceInputs&&this.syncInstanceInputs(),typeof this.options.onChange=="function"&&this.options.onChange(this.getInput(this.options.inputName,!0),o),typeof this.options.onChangeAll=="function"&&this.options.onChangeAll(this.getAllInputs(),o),o!=null&&o.target&&this.options.enableLayoutCandidates){var y,E=this.getInputCandidates(m),w=E.candidateKey,b=E.candidateValue;w&&b?this.showCandidatesBox(w,b,this.keyboardDOM):(y=this.candidateBox)===null||y===void 0||y.destroy()}}this.caretPositionEnd&&this.caretPosition!==this.caretPositionEnd&&(this.setCaretPosition(this.caretPositionEnd,this.caretPositionEnd),this.activeInputElement&&this.activeInputElement.setSelectionRange(this.caretPositionEnd,this.caretPositionEnd),this.options.debug&&console.log("Caret position aligned",this.caretPosition)),h&&console.log("Key pressed:",t)}}},{key:"getMouseHold",value:function(){return this.isMouseHold}},{key:"setMouseHold",value:function(t){this.options.syncInstanceInputs?this.dispatch(function(o){o.isMouseHold=t}):this.isMouseHold=t}},{key:"handleButtonMouseDown",value:function(t,o){var r=this;o&&(this.options.preventMouseDownDefault&&o.preventDefault(),this.options.stopMouseDownPropagation&&o.stopPropagation(),o.target.classList.add(this.activeButtonClass)),this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),this.holdTimeout&&clearTimeout(this.holdTimeout),this.setMouseHold(!0),this.options.disableButtonHold||(this.holdTimeout=window.setTimeout(function(){(r.getMouseHold()&&(!t.includes("{")&&!t.includes("}")||t==="{delete}"||t==="{backspace}"||t==="{bksp}"||t==="{space}"||t==="{tab}")||t==="{arrowright}"||t==="{arrowleft}"||t==="{arrowup}"||t==="{arrowdown}")&&(r.options.debug&&console.log("Button held:",t),r.handleButtonHold(t)),clearTimeout(r.holdTimeout)},500))}},{key:"handleButtonMouseUp",value:function(t,o){var r=this;o&&(this.options.preventMouseUpDefault&&o.preventDefault&&o.preventDefault(),this.options.stopMouseUpPropagation&&o.stopPropagation&&o.stopPropagation(),!(o.target===this.keyboardDOM||o.target&&this.keyboardDOM.contains(o.target)||this.candidateBox&&this.candidateBox.candidateBoxElement&&(o.target===this.candidateBox.candidateBoxElement||o.target&&this.candidateBox.candidateBoxElement.contains(o.target)))&&this.candidateBox&&this.candidateBox.destroy()),this.recurseButtons(function(i){i.classList.remove(r.activeButtonClass)}),this.setMouseHold(!1),this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),t&&typeof this.options.onKeyReleased=="function"&&this.options.onKeyReleased(t,o)}},{key:"handleKeyboardContainerMouseDown",value:function(t){this.options.preventMouseDownDefault&&t.preventDefault()}},{key:"handleButtonHold",value:function(t){var o=this;this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),this.holdInteractionTimeout=window.setTimeout(function(){o.getMouseHold()?(o.handleButtonClicked(t),o.handleButtonHold(t)):clearTimeout(o.holdInteractionTimeout)},100)}},{key:"syncInstanceInputs",value:function(){var t=this;this.dispatch(function(o){o.replaceInput(t.input),o.setCaretPosition(t.caretPosition,t.caretPositionEnd)})}},{key:"clearInput",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.inputName||this.defaultName;this.input[t]="",this.setCaretPosition(0),this.options.syncInstanceInputs&&this.syncInstanceInputs()}},{key:"getInput",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.inputName||this.defaultName,o=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return this.options.syncInstanceInputs&&!o&&this.syncInstanceInputs(),this.options.rtl?"‫"+this.input[t].replace("‫","").replace("‬","")+"‬":this.input[t]}},{key:"getAllInputs",value:function(){var t=this,o={};return Object.keys(this.input).forEach(function(r){o[r]=t.getInput(r,!0)}),o}},{key:"setInput",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.inputName||this.defaultName,r=arguments.length>2?arguments[2]:void 0;this.input[o]=t,!r&&this.options.syncInstanceInputs&&this.syncInstanceInputs()}},{key:"replaceInput",value:function(t){this.input=t}},{key:"setOptions",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=this.changedOptions(t);this.options=Object.assign(this.options,t),o.length&&(this.options.debug&&console.log("changedOptions",o),this.onSetOptions(o),this.render())}},{key:"changedOptions",value:function(t){var o=this;return Object.keys(t).filter(function(r){return JSON.stringify(t[r])!==JSON.stringify(o.options[r])})}},{key:"onSetOptions",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];t.includes("layoutName")&&this.candidateBox&&this.candidateBox.destroy(),(t.includes("layoutCandidatesPageSize")||t.includes("layoutCandidates"))&&this.candidateBox&&(this.candidateBox.destroy(),this.candidateBox=new rt({utilities:this.utilities,options:this.options}))}},{key:"resetRows",value:function(){this.keyboardRowsDOM&&this.keyboardRowsDOM.remove(),this.keyboardDOM.className=this.keyboardDOMClass,this.keyboardDOM.setAttribute("data-skInstance",this.currentInstanceName),this.buttonElements={}}},{key:"dispatch",value:function(t){if(!window.SimpleKeyboardInstances)throw console.warn("SimpleKeyboardInstances is not defined. Dispatch cannot be called."),new Error("INSTANCES_VAR_ERROR");return Object.keys(window.SimpleKeyboardInstances).forEach(function(o){t(window.SimpleKeyboardInstances[o],o)})}},{key:"addButtonTheme",value:function(t,o){var r=this;o&&t&&(t.split(" ").forEach(function(i){o.split(" ").forEach(function(l){r.options.buttonTheme||(r.options.buttonTheme=[]);var h=!1;r.options.buttonTheme.map(function(m){if(m!=null&&m.class.split(" ").includes(l)){h=!0;var g=m.buttons.split(" ");g.includes(i)||(h=!0,g.push(i),m.buttons=g.join(" "))}return m}),h||r.options.buttonTheme.push({class:l,buttons:t})})}),this.render())}},{key:"removeButtonTheme",value:function(t,o){var r=this;if(!t&&!o)return this.options.buttonTheme=[],void this.render();t&&Array.isArray(this.options.buttonTheme)&&this.options.buttonTheme.length&&(t.split(" ").forEach(function(i){var l;(l=r.options)===null||l===void 0||(l=l.buttonTheme)===null||l===void 0||l.map(function(h,m){if(h&&o&&o.includes(h.class)||!o){var g,y,E=(g=h)===null||g===void 0?void 0:g.buttons.split(" ").filter(function(w){return w!==i});h&&E!=null&&E.length?h.buttons=E.join(" "):((y=r.options.buttonTheme)===null||y===void 0||y.splice(m,1),h=null)}return h})}),this.render())}},{key:"getButtonElement",value:function(t){var o,r=this.buttonElements[t];return r&&(o=r.length>1?r:r[0]),o}},{key:"inputPatternIsValid",value:function(t){var o,r=this.options.inputPattern;if((o=r instanceof RegExp?r:r[this.options.inputName||this.defaultName])&&t){var i=o.test(t);return this.options.debug&&console.log('inputPattern ("'.concat(o,'"): ').concat(i?"passed":"did not pass!")),i}return!0}},{key:"setEventListeners",value:function(){if(this.isFirstKeyboardInstance||!this.allKeyboardInstances){this.options.debug&&console.log("Caret handling started (".concat(this.keyboardDOMClass,")"));var t=this.options.physicalKeyboardHighlightPreventDefault,o=t!==void 0&&t;document.addEventListener("keyup",this.handleKeyUp,o),document.addEventListener("keydown",this.handleKeyDown,o),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchend",this.handleTouchEnd),this.options.updateCaretOnSelectionChange&&document.addEventListener("selectionchange",this.handleSelectionChange),document.addEventListener("select",this.handleSelect)}}},{key:"handleKeyUp",value:function(t){this.caretEventHandler(t),this.options.physicalKeyboardHighlight&&this.physicalKeyboard.handleHighlightKeyUp(t)}},{key:"handleKeyDown",value:function(t){this.options.physicalKeyboardHighlight&&this.physicalKeyboard.handleHighlightKeyDown(t)}},{key:"handleMouseUp",value:function(t){this.caretEventHandler(t)}},{key:"handleTouchEnd",value:function(t){this.caretEventHandler(t)}},{key:"handleSelect",value:function(t){this.caretEventHandler(t)}},{key:"handleSelectionChange",value:function(t){navigator.userAgent.includes("Firefox")||this.caretEventHandler(t)}},{key:"caretEventHandler",value:function(t){var o,r=this;t.target.tagName&&(o=t.target.tagName.toLowerCase()),this.dispatch(function(i){var l=t.target===i.keyboardDOM||t.target&&i.keyboardDOM.contains(t.target);if(r.options.syncInstanceInputs&&Array.isArray(t.path)&&(l=t.path.some(function(g){var y;return g==null||(y=g.hasAttribute)===null||y===void 0?void 0:y.call(g,"data-skInstance")})),(o==="textarea"||o==="input"&&["text","search","url","tel","password"].includes(t.target.type))&&!i.options.disableCaretPositioning){var h=t.target.selectionStart,m=t.target.selectionEnd;i.options.rtl&&(h=i.utilities.getRtlOffset(h,i.getInput()),m=i.utilities.getRtlOffset(m,i.getInput())),i.setCaretPosition(h,m),i.activeInputElement=t.target,i.options.debug&&console.log("Caret at: ",i.getCaretPosition(),i.getCaretPositionEnd(),t&&t.target.tagName.toLowerCase(),"(".concat(i.keyboardDOMClass,")"),t==null?void 0:t.type)}else!i.options.disableCaretPositioning&&l||(t==null?void 0:t.type)==="selectionchange"||(i.setCaretPosition(null),i.activeInputElement=null,i.options.debug&&console.log('Caret position reset due to "'.concat(t==null?void 0:t.type,'" event'),t))})}},{key:"recurseButtons",value:function(t){var o=this;t&&Object.keys(this.buttonElements).forEach(function(r){return o.buttonElements[r].forEach(t)})}},{key:"destroy",value:function(){this.options.debug&&console.log("Destroying simple-keyboard instance: ".concat(this.currentInstanceName));var t=this.options.physicalKeyboardHighlightPreventDefault,o=t!==void 0&&t;document.removeEventListener("keyup",this.handleKeyUp,o),document.removeEventListener("keydown",this.handleKeyDown,o),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchend",this.handleTouchEnd),document.removeEventListener("select",this.handleSelect),this.options.updateCaretOnSelectionChange&&document.removeEventListener("selectionchange",this.handleSelectionChange),document.onpointerup=null,document.ontouchend=null,document.ontouchcancel=null,document.onmouseup=null,this.recurseButtons(function(r){r&&(r.onpointerdown=null,r.onpointerup=null,r.onpointercancel=null,r.ontouchstart=null,r.ontouchend=null,r.ontouchcancel=null,r.onclick=null,r.onmousedown=null,r.onmouseup=null,r.remove(),r=null)}),this.keyboardDOM.onpointerdown=null,this.keyboardDOM.ontouchstart=null,this.keyboardDOM.onmousedown=null,this.resetRows(),this.candidateBox&&(this.candidateBox.destroy(),this.candidateBox=null),this.activeInputElement=null,this.keyboardDOM.removeAttribute("data-skInstance"),this.keyboardDOM.innerHTML="",window.SimpleKeyboardInstances[this.currentInstanceName]=null,delete window.SimpleKeyboardInstances[this.currentInstanceName],this.initialized=!1}},{key:"getButtonThemeClasses",value:function(t){var o=this.options.buttonTheme,r=[];return Array.isArray(o)&&o.forEach(function(i){if(i&&i.class&&typeof i.class=="string"&&i.buttons&&typeof i.buttons=="string"){var l=i.class.split(" ");i.buttons.split(" ").includes(t)&&(r=[].concat(ze(r),ze(l)))}else console.warn('Incorrect "buttonTheme". Please check the documentation.',i)}),r}},{key:"setDOMButtonAttributes",value:function(t,o){var r=this.options.buttonAttributes;Array.isArray(r)&&r.forEach(function(i){i.attribute&&typeof i.attribute=="string"&&i.value&&typeof i.value=="string"?i.buttons&&typeof i.buttons=="string"?i.buttons.split(" ").includes(t)&&o(i.attribute,i.value):o(i.attribute,i.value):console.warn('Incorrect "buttonAttributes". Please check the documentation.',i)})}},{key:"onTouchDeviceDetected",value:function(){this.processAutoTouchEvents(),this.disableContextualWindow()}},{key:"disableContextualWindow",value:function(){window.oncontextmenu=function(t){var o;if((o=t.target.classList)!==null&&o!==void 0&&o.contains("hg-button"))return t.preventDefault(),t.stopPropagation(),!1}}},{key:"processAutoTouchEvents",value:function(){this.options.autoUseTouchEvents&&(this.options.useTouchEvents=!0,this.options.debug&&console.log("autoUseTouchEvents: Touch device detected, useTouchEvents enabled."))}},{key:"onInit",value:function(){this.options.debug&&console.log("".concat(this.keyboardDOMClass," Initialized")),this.setEventListeners(),typeof this.options.onInit=="function"&&this.options.onInit(this)}},{key:"beforeFirstRender",value:function(){this.utilities.isTouchDevice()&&this.onTouchDeviceDetected(),typeof this.options.beforeFirstRender=="function"&&this.options.beforeFirstRender(this),this.isFirstKeyboardInstance&&this.utilities.pointerEventsSupported()&&!this.options.useTouchEvents&&!this.options.useMouseEvents&&this.options.debug&&console.log("Using PointerEvents as it is supported by this browser"),this.options.useTouchEvents&&this.options.debug&&console.log("useTouchEvents has been enabled. Only touch events will be used.")}},{key:"beforeRender",value:function(){typeof this.options.beforeRender=="function"&&this.options.beforeRender(this)}},{key:"onRender",value:function(){typeof this.options.onRender=="function"&&this.options.onRender(this)}},{key:"onModulesLoaded",value:function(){typeof this.options.onModulesLoaded=="function"&&this.options.onModulesLoaded(this)}},{key:"loadModules",value:function(){var t=this;Array.isArray(this.options.modules)&&(this.options.modules.forEach(function(o){var r=t.utilities.isConstructor(o)?new o(t):o(t);r.init&&r.init(t)}),this.keyboardPluginClasses="modules-loaded",this.render(),this.onModulesLoaded())}},{key:"getModuleProp",value:function(t,o){return!!this.modules[t]&&this.modules[t][o]}},{key:"getModulesList",value:function(){return Object.keys(this.modules)}},{key:"parseRowDOMContainers",value:function(t,o,r,i){var l=this,h=Array.from(t.children),m=0;return h.length&&r.forEach(function(g,y){var E=i[y];if(!(E&&E>g))return!1;var w=g-m,b=E-m,S=document.createElement("div");S.className+="hg-button-container";var x="".concat(l.options.layoutName,"-r").concat(o,"c").concat(y);S.setAttribute("data-skUID",x);var I=h.splice(w,b-w+1);m+=b-w,I.forEach(function(A){return S.appendChild(A)}),h.splice(w,0,S),t.innerHTML="",h.forEach(function(A){return t.appendChild(A)}),l.options.debug&&console.log("rowDOMContainer",I,w,b,m+1)}),t}},{key:"render",value:function(){var t=this;this.resetRows(),this.initialized||this.beforeFirstRender(),this.beforeRender();var o="hg-layout-".concat(this.options.layoutName),r=this.options.layout||{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]},i=this.options.useTouchEvents||!1,l=i?"hg-touch-events":"",h=this.options.useMouseEvents||!1,m=this.options.disableRowButtonContainers;this.keyboardDOM.className=this.getKeyboardClassString(this.options.theme,o,this.keyboardPluginClasses,l),this.keyboardDOM.setAttribute("data-skInstance",this.currentInstanceName),this.keyboardRowsDOM=document.createElement("div"),this.keyboardRowsDOM.className="hg-rows",r[this.options.layoutName||this.defaultName].forEach(function(g,y){var E=g.split(" ");t.options.excludeFromLayout&&t.options.excludeFromLayout[t.options.layoutName||t.defaultName]&&(E=E.filter(function(x){return t.options.excludeFromLayout&&!t.options.excludeFromLayout[t.options.layoutName||t.defaultName].includes(x)}));var w=document.createElement("div");w.className+="hg-row";var b=[],S=[];E.forEach(function(x,I){var A,O=!m&&typeof x=="string"&&x.length>1&&x.indexOf("[")===0,N=!m&&typeof x=="string"&&x.length>1&&x.indexOf("]")===x.length-1;O&&(b.push(I),x=x.replace(/\[/g,"")),N&&(S.push(I),x=x.replace(/\]/g,""));var M=t.utilities.getButtonClass(x),$=t.utilities.getButtonDisplayName(x,t.options.display,t.options.mergeDisplay),L=t.options.useButtonTag?"button":"div",R=document.createElement(L);R.className+="hg-button ".concat(M),(A=R.classList).add.apply(A,ze(t.getButtonThemeClasses(x))),t.setDOMButtonAttributes(x,function(_,ee){R.setAttribute(_,ee)}),t.activeButtonClass="hg-activeButton",!t.utilities.pointerEventsSupported()||i||h?i?(R.ontouchstart=function(_){t.handleButtonClicked(x,_),t.handleButtonMouseDown(x,_)},R.ontouchend=function(_){t.handleButtonMouseUp(x,_)},R.ontouchcancel=function(_){t.handleButtonMouseUp(x,_)}):(R.onclick=function(_){t.setMouseHold(!1),typeof t.options.onKeyReleased=="function"||t.options.useMouseEvents&&t.options.clickOnMouseDown||t.handleButtonClicked(x,_)},R.onmousedown=function(_){(typeof t.options.onKeyReleased=="function"||t.options.useMouseEvents&&t.options.clickOnMouseDown)&&!t.isMouseHold&&t.handleButtonClicked(x,_),t.handleButtonMouseDown(x,_)},R.onmouseup=function(_){t.handleButtonMouseUp(x,_)}):(R.onpointerdown=function(_){t.handleButtonClicked(x,_),t.handleButtonMouseDown(x,_)},R.onpointerup=function(_){t.handleButtonMouseUp(x,_)},R.onpointercancel=function(_){t.handleButtonMouseUp(x,_)}),R.setAttribute("data-skBtn",x);var H="".concat(t.options.layoutName,"-r").concat(y,"b").concat(I);R.setAttribute("data-skBtnUID",H);var U=document.createElement("span");U.innerHTML=$,R.appendChild(U),t.buttonElements[x]||(t.buttonElements[x]=[]),t.buttonElements[x].push(R),w.appendChild(R)}),w=t.parseRowDOMContainers(w,y,b,S),t.keyboardRowsDOM.appendChild(w)}),this.keyboardDOM.appendChild(this.keyboardRowsDOM),this.onRender(),this.initialized||(this.initialized=!0,!this.utilities.pointerEventsSupported()||i||h?i?(document.ontouchend=function(g){return t.handleButtonMouseUp(void 0,g)},document.ontouchcancel=function(g){return t.handleButtonMouseUp(void 0,g)},this.keyboardDOM.ontouchstart=function(g){return t.handleKeyboardContainerMouseDown(g)}):i||(document.onmouseup=function(g){return t.handleButtonMouseUp(void 0,g)},this.keyboardDOM.onmousedown=function(g){return t.handleKeyboardContainerMouseDown(g)}):(document.onpointerup=function(g){return t.handleButtonMouseUp(void 0,g)},this.keyboardDOM.onpointerdown=function(g){return t.handleKeyboardContainerMouseDown(g)}),this.onInit())}}],f&&Xt(c.prototype,f),e&&Xt(c,e),Object.defineProperty(c,"prototype",{writable:!1}),c;var c,f,e}(),Dt=Zt,B=Dt;return p}()})})(Io);var Di=Io.exports;const Bi=_i(Di),sn={a:"א",b:"ב",g:"ג",d:"ד",h:"ה",v:"ו",w:"ו",z:"ז",j:"ח",y:"י",k:"כ",l:"ל",m:"מ",n:"נ",s:"ס",e:"ע",p:"פ",f:"פ",c:"צ",q:"ק",r:"ר",x:"ש",t:"ת"},Zn={};for(const n in sn){const a=sn[n];Zn[a]||(Zn[a]=n)}let pt=null,Ke=null,kt=null;const $i={default:["ק ו ע ר ת י פ {bksp}","א ס ד פ ג ה ח כ ל","ז ש צ ו ב נ מ","{space}"]};function Fi(n){kt&&n.removeEventListener("keydown",kt),kt=a=>{const s=a.key.toLowerCase();if(s.length===1&&sn[s]){a.preventDefault();const u=sn[s],d=n.selectionStart??0,p=n.selectionEnd??0,v=n.value,k=v.slice(0,d)+u+v.slice(p);n.value=k;const T=d+u.length;n.setSelectionRange(T,T),pt&&pt.setInput(k),n.dispatchEvent(new Event("input",{bubbles:!0}))}},n.addEventListener("keydown",kt)}function ji(n){Ke=n;let a=document.getElementById("hebrew-keyboard-container");a||(a=document.createElement("div"),a.id="hebrew-keyboard-container",a.className="hebrew-keyboard-container",document.body.appendChild(a)),pt?Ke=n:(pt=new Bi(a,{layout:$i,theme:"hg-theme-default hebrew-keyboard-theme",display:{"{bksp}":"⌫","{space}":" ",ק:`q
ק`,ו:`w/v
ו`,ע:`e
ע`,ר:`r
ר`,ת:`t
ת`,י:`y
י`,פ:`p/f
פ`,א:`a
א`,ס:`s
ס`,ד:`d
ד`,ג:`g
ג`,ה:`h
ה`,ח:`j
ח`,כ:`k
כ`,ל:`l
ל`,ז:`z
ז`,ש:`x
ש`,צ:`c
צ`,ב:`b
ב`,נ:`n
נ`,מ:`m
מ`},onChange:s=>{Ke&&(Ke.value=s,Ke.dispatchEvent(new Event("input",{bubbles:!0})))},onKeyPress:s=>{s==="{bksp}"&&Ki()}}),Hi()),pt.setInput(n.value),Ui(n,a),a.style.display="block",Fi(n)}function Hi(){if(!pt)return;document.querySelectorAll(".hebrew-keyboard-theme .hg-button").forEach(a=>{const s=a.textContent;if(!s||s.includes("{")||!s.includes(`
`))return;const[u,d]=s.split(`
`);a.innerHTML=`
      <span>
        <span class="keycap-english">${u}</span>
        <span class="keycap-hebrew">${d}</span>
      </span>
    `})}function Ui(n,a){const s=document.getElementById("controls");if(!s)return;const u=s.getBoundingClientRect();a.style.left=`${u.right+16}px`,a.style.top=`${u.top}px`}function Ki(){if(Ke&&pt){const n=Ke.selectionStart??0,a=Ke.selectionEnd??0,s=Ke.value;let u,d;if(n!==a)u=s.slice(0,n)+s.slice(a),d=n;else if(n>0)u=s.slice(0,n-1)+s.slice(n),d=n-1;else return;Ke.value=u,pt.setInput(u),Ke.setSelectionRange(d,d),Ke.dispatchEvent(new Event("input",{bubbles:!0}))}}function Qn(){const n=document.getElementById("hebrew-keyboard-container");n&&(n.style.display="none"),Ke&&kt&&(Ke.removeEventListener("keydown",kt),kt=null)}function pn(){const n=document.getElementById("hebrew-keyboard-container");return n?n.style.display==="block":!1}function Oo(n){return`rgb(${Math.round(n[0]*255)}, ${Math.round(n[1]*255)}, ${Math.round(n[2]*255)})`}let Po=[],He="",Se=[],nt=[],cn=new Map,Ot=!1,Je="substring",et=null,un=null,Pt=[],Mt=[],dt=[],ve=null,We=null,xt=null,Ue=null,Oe=null,_e=null,Et=null;function zi(n){var a;Po=n.verses,(a=n.callbacks)!=null&&a.onVerseClick&&(un=n.callbacks.onVerseClick)}function Ht(n){if(He=n,Se=lo(n),Se.length===0)nt=[],cn=new Map,Pt=[],Mt=[],dt=[];else{const a=st(Se[0]);if(a&&Je==="root"){Pt=[],Mt=[],dt=[];for(const u of Se){const d=Pn(u);if(Pt.push(d!==null&&d.length>0),Mt.push(d),d&&d.length>0){const p=dr(d[0]);dt.push(p)}else dt.push(null)}}else Pt=[],Mt=[],dt=[];const s=Ot&&Se.length>0&&!a;nt=vr(n,s,a?Je:"substring"),cn=xr(nt)}Mo(),et==null||et()}function Mo(){if(!Ue)return;Ue.querySelectorAll(".search-result").forEach(u=>u.remove());const a=Ue.querySelector("#search-count");if(nt.length===0){Ue.classList.remove("visible"),a&&(a.textContent="");return}if(a){const u=Se.length>1?` (${Se.length} terms)`:"";a.textContent=`${nt.length}${nt.length>=100?"+":""} results${u}`}const s=nt.slice(0,10);for(const u of s){const d=document.createElement("div");d.className="search-result";const p=document.createElement("div");p.className="ref";const v=document.createElement("span");v.className="term-indicators";for(const C of u.matchingTerms){const D=document.createElement("span");D.className="term-dot";const F=It[C.termIndex%It.length];D.style.background=Oo(F),v.appendChild(D)}p.appendChild(v),p.appendChild(document.createTextNode(`${u.book} ${u.chapter}:${u.verse}`));const k=document.createElement("div");k.className=`snippet ${u.language==="he"?"rtl":""}`;const T=u.matchingTerms[0],P=Vi(T.snippet,T.matchStart,T.matchEnd,T.termIndex);k.appendChild(P),d.appendChild(p),d.appendChild(k),d.addEventListener("click",()=>{const C=Po.find(D=>D.book===u.book&&D.chapter===u.chapter&&D.verse===u.verse);C&&un&&un(C)}),Ue.appendChild(d)}Ue.classList.add("visible")}function Vi(n,a,s,u){const d=document.createDocumentFragment();a>0&&d.appendChild(document.createTextNode(n.slice(0,a)));const p=document.createElement("mark");return p.className=`term-${u%5}`,p.textContent=n.slice(a,s),d.appendChild(p),s<n.length&&d.appendChild(document.createTextNode(n.slice(s))),d}function No(n){return n>=1425&&n<=1479&&n!==1470&&n!==1472&&n!==1475&&n!==1478}function lt(n,a,s=0){let u=0,d=0;for(let p=s;p<n.length&&d<a;p++){const v=n.charCodeAt(p);No(v)?u++:d++}return a+u}function mn(n){const a=[];let s=0;for(;s<n.length;){for(;s<n.length&&(/\s/.test(n[s])||n.charCodeAt(s)===1470);)s++;if(s>=n.length)break;let u=s;for(;u<n.length&&!(/\s/.test(n[u])||n.charCodeAt(u)===1470);)u++;u>s&&a.push({word:n.slice(s,u),start:s,end:u}),s=u}return a}function Gi(n,a,s){const u=[],d=s?mt(n):n.toLowerCase();for(let p=0;p<a.length;p++){const v=a[p],k=s?mt(v):v.toLowerCase();if(!s&&Ot){const T=k.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),P=new RegExp(`\\b${T}\\b`,"gi");let C;for(;(C=P.exec(n.toLowerCase()))!==null;)u.push({start:C.index,end:C.index+C[0].length,termIndex:p})}else if(s&&Je==="root"){const T=Mt[p];if(!T||T.length===0){const P=mn(d);for(const{word:C,start:D}of P)if(C===k){const F=lt(n,D),j=lt(n,D+C.length);u.push({start:F,end:j,termIndex:p})}}else{const P=mn(d);for(const{word:C,start:D}of P){const F=Pn(C);if(F&&F.some(j=>T.includes(j))){const j=lt(n,D),Y=lt(n,D+C.length);u.push({start:j,end:Y,termIndex:p})}}}}else if(s&&Je==="word"){const T=mn(d);for(const{word:P,start:C}of T)if(P===k){const D=lt(n,C),F=lt(n,C+P.length);u.push({start:D,end:F,termIndex:p})}}else{let T=0;for(;;){const P=d.indexOf(k,T);if(P===-1)break;let C=P,D=P+k.length;s&&(C=lt(n,P),D=lt(n,P+k.length)),u.push({start:C,end:D,termIndex:p}),T=P+1}}}return u}function qi(n){const a=[];for(const s of n)(a.length===0||s.start>=a[a.length-1].end)&&a.push(s);return a}function Wi(n,a){const s=document.createDocumentFragment();let u=0;for(const d of a){d.start>u&&s.appendChild(document.createTextNode(n.slice(u,d.start)));const p=document.createElement("mark");p.className=`term-${d.termIndex%5}`,p.textContent=n.slice(d.start,d.end),s.appendChild(p),u=d.end}return u<n.length&&s.appendChild(document.createTextNode(n.slice(u))),s}function Yi(n,a){const s=document.createDocumentFragment();if(Se.length===0)return s.appendChild(document.createTextNode(n)),s;const d=Gi(n,Se,a==="he");if(d.length===0)return s.appendChild(document.createTextNode(n)),s;d.sort((v,k)=>v.start-k.start||k.end-v.end);const p=qi(d);return Wi(n,p)}const Xi={id:"search",name:"Text Search",getVerseColor(n){if(Se.length===0)return null;const a=$e(n.book,n.chapter,n.verse),s=cn.get(a);if(s&&s.length>0){const d=s.map(p=>It[p%It.length]);return d.length===1?d[0]:d.slice(0,4)}const u=(.4+.2)*xe.DIM_FACTOR;return[u,u,u]},renderControls(n){if(n.innerHTML=`
      <div id="search-container">
        <input type="text" id="search-input" class="keyboardInput" placeholder="Search Hebrew or English...">
        <button id="keyboard-toggle" title="Toggle Hebrew keyboard">א</button>
        <button id="search-clear">&times;</button>
      </div>
      <div id="search-options">
        <label>
          <input type="checkbox" id="whole-word-checkbox">
          Match whole words only
        </label>
      </div>
      <div id="hebrew-mode-container" style="display: none;">
        <div class="hebrew-mode-label">Hebrew search mode:</div>
        <label class="hebrew-mode-option">
          <input type="radio" name="hebrew-mode" value="substring" checked>
          Substring
        </label>
        <label class="hebrew-mode-option">
          <input type="radio" name="hebrew-mode" value="word">
          Whole word
        </label>
        <label class="hebrew-mode-option">
          <input type="radio" name="hebrew-mode" value="root">
          Root (שרש)
        </label>
      </div>
      <div id="search-results">
        <div id="search-count"></div>
      </div>
    `,ve=n.querySelector("#search-input"),We=n.querySelector("#search-clear"),xt=n.querySelector("#keyboard-toggle"),Ue=n.querySelector("#search-results"),Oe=n.querySelector("#whole-word-checkbox"),_e=n.querySelector("#hebrew-mode-container"),ve&&He){ve.value=He;const s=st(He);if(s&&(ve.dir="rtl"),Oe){const u=Oe.closest("#search-options");u&&(u.style.display=s?"none":"block")}_e&&(_e.style.display=s?"block":"none"),We&&(We.style.display=He?"block":"none"),nt.length>0&&Mo()}Oe&&(Oe.checked=Ot),_e&&_e.querySelectorAll('input[name="hebrew-mode"]').forEach(u=>{u.value===Je&&(u.checked=!0)});const a=()=>{if(!ve)return;const s=ve.value,u=s.length>0&&st(s),d=u||pn();if(s.length===0?ve.dir=pn()?"rtl":"ltr":u?ve.dir="rtl":ve.dir="ltr",Oe){const p=Oe.closest("#search-options");p&&(p.style.display=d?"none":"block")}_e&&(_e.style.display=d?"block":"none")};ve==null||ve.addEventListener("paste",s=>{var d;const u=(d=s.clipboardData)==null?void 0:d.getData("text/plain");if(u&&st(u)){s.preventDefault();const p=mt(u),v=ve,k=v.selectionStart??0,T=v.selectionEnd??0,P=v.value;v.value=P.slice(0,k)+p+P.slice(T);const C=k+p.length;v.setSelectionRange(C,C),v.dispatchEvent(new Event("input",{bubbles:!0}))}}),ve==null||ve.addEventListener("input",()=>{const s=ve,u=s.value;if(u&&st(u)){const p=mt(u);if(p!==u){const v=s.selectionStart??u.length;let k=0;for(let P=0;P<Math.min(v,u.length);P++){const C=u.charCodeAt(P);No(C)&&k++}s.value=p;const T=v-k;s.setSelectionRange(T,T)}}const d=s.value.trim();a(),We&&(We.style.display=d?"block":"none"),Ht(d)}),We==null||We.addEventListener("click",()=>{if(ve&&(ve.value="",ve.dir="ltr",We.style.display="none"),Oe){const s=Oe.closest("#search-options");s&&(s.style.display="block")}_e&&(_e.style.display="none"),Ht("")}),Oe==null||Oe.addEventListener("change",()=>{Ot=Oe.checked,He&&Ht(He),et==null||et()}),_e&&_e.querySelectorAll('input[name="hebrew-mode"]').forEach(u=>{u.addEventListener("change",()=>{u.checked&&(Je=u.value,He&&Ht(He),et==null||et())})}),Et&&document.removeEventListener("click",Et),Et=s=>{Ue&&!Ue.contains(s.target)&&s.target!==ve&&s.target!==We&&Ue.classList.remove("visible")},document.addEventListener("click",Et),ve==null||ve.addEventListener("focus",()=>{nt.length>0&&(Ue==null||Ue.classList.add("visible"))}),xt==null||xt.addEventListener("click",()=>{ve&&(pn()?(Qn(),xt.classList.remove("active")):(ji(ve),xt.classList.add("active")),a())})},renderLegend(n){if(n.textContent="",Se.length>0&&nt.length>0){const a=document.createElement("div");a.className="search-legend";for(let u=0;u<Se.length;u++){const d=Se[u],p=It[u%It.length],v=document.createElement("span");v.className="legend-term";const k=document.createElement("span");if(k.className="color-swatch",k.style.background=Oo(p),v.appendChild(k),Je==="root"&&Pt.length>0)if(Pt[u]&&dt[u])v.appendChild(document.createTextNode(`"${dt[u]}" (from "${d}")`));else{v.appendChild(document.createTextNode(`"${d}"`));const T=document.createElement("span");T.className="lemma-indicator",T.textContent=" ↪",T.title="No root data, using whole-word search",T.style.color="#FF9800",v.appendChild(T)}else v.appendChild(document.createTextNode(`"${d}"`));a.appendChild(v),u<Se.length-1&&a.appendChild(document.createTextNode(" "))}const s=document.createElement("div");s.style.color="#888",s.style.fontSize="11px",s.style.marginTop="4px",s.textContent=`${nt.length} matching verses`,n.appendChild(a),n.appendChild(s)}else if(He.length>0&&Se.length===0){const a=document.createElement("div");a.style.color="#888",a.style.fontSize="11px",a.textContent="Type at least 2 characters per term",n.appendChild(a)}else{const a=document.createElement("div");a.style.color="#888",a.style.fontSize="11px",a.textContent="Type to search (comma-separate multiple terms)",n.appendChild(a)}},getHoverInfo(n){if(Se.length===0)return null;const a=$e(n.book,n.chapter,n.verse),s=cn.get(a);if(!s)return null;const u=st(Se[0]);return u&&Je==="root"?`Matches root: ${s.map(p=>{const v=Mt[p],k=dt[p];return v&&v.length>0&&k?`"${k}"`:`"${Se[p]}"`}).join(", ")}`:u&&Je==="word"?`Matches word: ${s.map(p=>`"${Se[p]}"`).join(", ")}`:`Matches: ${s.map(p=>`"${Se[p]}"`).join(", ")}`},onUpdate(n){et=n},destroy(){Qn(),Et&&(document.removeEventListener("click",Et),Et=null),ve=null,We=null,xt=null,Ue=null,Oe=null,_e=null,et=null,un=null},getUrlParams(){const n={};return He&&(n.q=He),Ot&&(n.ww="1"),He&&st(He)&&Je!=="substring"&&(n.hm=Je),n},applyUrlParams(n){const a=n.get("q"),s=n.get("ww"),u=n.get("hm");if(s==="1"&&(Ot=!0,Oe&&(Oe.checked=!0)),(u==="word"||u==="root")&&(Je=u,_e&&_e.querySelectorAll('input[name="hebrew-mode"]').forEach(p=>{p.value===u&&(p.checked=!0)})),a&&(Ht(a),ve)){ve.value=a;const d=st(a);if(d&&(ve.dir="rtl"),Oe){const p=Oe.closest("#search-options");p&&(p.style.display=d?"none":"block")}_e&&(_e.style.display=d?"block":"none"),We&&(We.style.display="block")}},highlightVerseText(n,a){return Yi(n,a)}};function Ji(n){return"torah"in n}function Sn(n,a){const s=n/a*360;return Eo({h:s,s:.8,l:.55})}function eo(n,a){return[Math.min(1,n[0]*a),Math.min(1,n[1]*a),Math.min(1,n[2]*a)]}function to(n,a){const{h:s,s:u,l:d}=Fr(n);return Eo({h:s,s:u*a,l:d})}let Be=null,kn=null,Qe="ashkenazi",Me=null,Ut=null,ht=new Map,tt=new Map,Cn=new Set,tn=new Set,Rt=new Map,zt=0;function Zi(n,a){if(!kn)return 200;const s=kn.books.find(u=>u.name===n);return!s||a<1||a>s.chapters.length?200:s.chapters[a-1]}function gn(n,a){for(let s=n.start.chapter;s<=n.end.chapter;s++){const u=s===n.start.chapter?n.start.verse:1,d=Zi(n.book,s),p=s===n.end.chapter?Math.min(n.end.verse,d):d;for(let v=u;v<=p;v++)a(n.book,s,v)}}function vn(){if(ht.clear(),tt.clear(),Cn.clear(),tn.clear(),Rt.clear(),!Be)return;const n=Be.specialOccasions||[];zt=Be.parshiot.length+n.length;for(let a=0;a<Be.parshiot.length;a++){const s=Be.parshiot[a];Rt.set(s,Sn(a,zt)),gn(s.torah,(d,p,v)=>{const k=$e(d,p,v);ht.set(k,s),Cn.add(k)});const u=s.haftarah[Qe];for(const d of u)gn(d,(p,v,k)=>{const T=$e(p,v,k),P=tt.get(T);P?P.push(s):tt.set(T,[s]),tn.add(T)})}for(let a=0;a<n.length;a++){const s=n[a];Rt.set(s,Sn(Be.parshiot.length+a,zt));const u=s.haftarah[Qe];for(const d of u)gn(d,(p,v,k)=>{const T=$e(p,v,k),P=tt.get(T);P?P.push(s):tt.set(T,[s]),tn.add(T)})}}function no(n){const a=$e(n.book,n.chapter,n.verse);return ht.has(a)||tt.has(a)}const Qi={id:"haftarah",name:"Haftarah",async init(){try{const[n,a]=await Promise.all([fetch("/torahmap/data/haftarah-mappings.json"),fetch("/torahmap/data/tanakh-structure.json")]);if(!n.ok){console.error(`Failed to load haftarah-mappings.json: ${n.status}`);return}if(!a.ok){console.error(`Failed to load tanakh-structure.json: ${a.status}`);return}Be=await n.json(),kn=await a.json(),vn()}catch(n){console.error("Failed to initialize haftarah overlay:",n)}},destroy(){Me=null,Qe="ashkenazi",Ut=null,ht.clear(),tt.clear(),Cn.clear(),tn.clear(),Rt.clear()},onUpdate(n){Ut=n},setHoveredVerse(n){const a=Me?no(Me):!1,s=n?no(n):!1,u=s?n:null;if(!a&&!s)return Me=null,!1;const d=Me?$e(Me.book,Me.chapter,Me.verse):null,p=u?$e(u.book,u.chapter,u.verse):null;return d===p?!1:(Me=u,a||s)},getVerseColor(n){if(!Be)return null;const a=$e(n.book,n.chapter,n.verse),s=ht.get(a),u=tt.get(a);if(s){const d=Rt.get(s);if(!d)return null;if(!Me)return d;const p=$e(Me.book,Me.chapter,Me.verse),v=ht.get(p),k=tt.get(p);return v===s||k&&k.includes(s)?eo(d,xe.BRIGHTNESS_FACTOR):to(d,xe.DESATURATE_FACTOR)}if(u&&u.length>0){const d=u.map(C=>Rt.get(C)).filter(C=>C!==void 0);if(d.length===0)return null;if(!Me)return d.length===1?d[0]:d;const p=$e(Me.book,Me.chapter,Me.verse),v=ht.get(p),k=tt.get(p);if(v&&u.includes(v)||k&&k.some(C=>u.includes(C))){const C=d.map(D=>eo(D,xe.BRIGHTNESS_FACTOR));return C.length===1?C[0]:C}const P=d.map(C=>to(C,xe.DESATURATE_FACTOR));return P.length===1?P[0]:P}return null},renderControls(n){const a=document.createElement("div");a.className="haftarah-controls",a.innerHTML=`
      <div style="display: flex; align-items: center; gap: 8px; margin-top: 10px;">
        <label for="custom-select" style="font-size: 12px; color: #aaa;">Custom:</label>
        <select id="custom-select" style="flex: 1;">
          <option value="ashkenazi">Ashkenazi</option>
          <option value="sephardi">Sephardi</option>
        </select>
      </div>
    `;const s=a.querySelector("select");s.value=Qe,s.addEventListener("change",()=>{Qe=s.value,vn(),Ut==null||Ut()}),n.appendChild(a)},renderLegend(n){var k;const a=Qe==="ashkenazi"?"Ashkenazi":"Sephardi",s=(Be==null?void 0:Be.parshiot.length)||54,u=((k=Be==null?void 0:Be.specialOccasions)==null?void 0:k.length)||0,d=[],p=10;for(let T=0;T<p;T++){const C=Sn(T*(zt/p),zt||81).map(F=>Math.round(F*255)).join(", "),D=T/(p-1)*100;d.push(`rgb(${C}) ${D}%`)}const v=d.join(", ");n.innerHTML=`
      <div class="legend-row">
        <div style="
          width: 20px;
          height: 12px;
          background: linear-gradient(to right, ${v});
          border-radius: 2px;
        "></div>
        <span>${s} Parshiot + ${u} Special Occasions</span>
      </div>
      <div style="color: #888; font-size: 10px; margin-top: 4px; margin-left: 28px; line-height: 1.3;">
        Torah portion & haftarah (${a}) use same color
      </div>
      <div style="color: #888; font-size: 10px; margin-top: 4px; margin-left: 28px; line-height: 1.3;">
        Includes holidays, fast days, special Shabbatot
      </div>
      <div style="color: #888; font-size: 10px; margin-top: 4px; margin-left: 28px; line-height: 1.3;">
        Multi-item verses show stippled pattern
      </div>
      <div style="color: #666; font-size: 10px; margin-top: 8px; line-height: 1.4;">
        Hover brightens the reading & its haftarah, desaturates others
      </div>
    `},getHoverInfo(n){if(!Be)return null;const a=$e(n.book,n.chapter,n.verse),s=ht.get(a);if(s){const p=s.haftarah[Qe].map(v=>v.start.chapter===v.end.chapter?`${v.book} ${v.start.chapter}:${v.start.verse}-${v.end.verse}`:`${v.book} ${v.start.chapter}:${v.start.verse}-${v.end.chapter}:${v.end.verse}`).join(", ");return`${s.name} (${s.hebrewName}) → ${p}`}const u=tt.get(a);if(u&&u.length>0){if(u.length===1){const p=u[0];return Ji(p)?`Haftarah for ${p.name} (${p.hebrewName})`:`Haftarah for ${p.name} (${p.hebrewName})`}return`Haftarah for: ${u.map(p=>`${p.name} (${p.hebrewName})`).join(", ")}`}return null},getUrlParams(){return Qe==="ashkenazi"?{}:{custom:Qe}},applyUrlParams(n){if(n.get("custom")==="sephardi"){Qe="sephardi",vn();const s=document.querySelector("#custom-select");s&&(s.value=Qe)}}},Ro=[{name:"Pre-Monarchic",dateRange:[1400,1e3],baseColor:[.6,.25,.15]},{name:"Early Monarchic",dateRange:[1e3,722],baseColor:[.75,.4,.2]},{name:"Late Monarchic",dateRange:[722,586],baseColor:[.85,.55,.25]},{name:"Exilic",dateRange:[586,538],baseColor:[.85,.7,.35]},{name:"Persian Period",dateRange:[538,331],baseColor:[.75,.75,.5]},{name:"Hellenistic",dateRange:[331,164],baseColor:[.8,.8,.7]}];let ln={notes:[],books:{}};function Nn(n){for(const a of Ro)if(n>=a.dateRange[1]&&n<=a.dateRange[0])return a;return null}function ea(n){const a=Nn(n);if(!a)return null;const[s,u]=a.dateRange,p=.7+(s-n)/(s-u)*.3;return[a.baseColor[0]*p,a.baseColor[1]*p,a.baseColor[2]*p]}function Tn(n){const a=ln.books[n.book];if(!a)return null;const s=a[n.chapter-1];return s&&s[n.verse-1]||null}const ta={id:"text-dating",name:"Text Dating",async init(){try{const n=await fetch("/torahmap/data/text-dating.json");if(!n.ok){console.error(`Failed to load text-dating.json: ${n.status}`);return}ln=await n.json()}catch(n){console.error("Failed to parse text-dating.json:",n)}},getVerseColor(n){const a=Tn(n);if(!a)return null;const[s,u]=a.d,d=Math.abs((s+u)/2);return ea(d)},renderLegend(n){const a=Ro.map(s=>{const[u,d,p]=s.baseColor;return`
        <div class="legend-row">
          <span class="swatch" style="background: ${`rgb(${u*255}, ${d*255}, ${p*255})`}"></span>
          <span class="label">${s.name} (${s.dateRange[0]}-${s.dateRange[1]} BCE)</span>
        </div>
      `}).join("");n.innerHTML=`
      <div class="text-dating-legend">
        ${a}
        <div class="legend-note">Darker shades = later within period</div>
      </div>
    `},getHoverInfo(n){const a=Tn(n);if(!a)return null;const[s,u]=a.d,d=Math.abs((s+u)/2),p=Nn(d);if(!p)return null;const v=ln.notes[a.n],k=s===u?`~${Math.abs(s)} BCE`:`${Math.abs(s)}-${Math.abs(u)} BCE`;return`${p.name} (${k})
${v}`},renderSidebarInfo(n,a){if(!a)return null;const s=na(n.book,n.chapter,n.verse);if(!s)return null;const u=s.dateRange[0]===s.dateRange[1]?`~${s.dateRange[0]} BCE`:`${s.dateRange[0]}-${s.dateRange[1]} BCE`,d=s.note.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener">$1</a>');return`
      <strong>${s.era}</strong> (${u})
      <br>${d}
    `}};function na(n,a,s){const u=Tn({book:n,chapter:a,verse:s});if(!u)return null;const[d,p]=u.d,v=Math.abs((d+p)/2),k=Nn(v);return k?{era:k.name,eraDateRange:k.dateRange,dateRange:[Math.abs(d),Math.abs(p)],note:ln.notes[u.n]}:null}async function oa(){var Dt;document.title="Tanakh Map [main]";const[n,a]=await Promise.all([fetch("/torahmap/data/tanakh-structure.json"),or(),fr()]);if(!n.ok)throw new Error(`Failed to load tanakh-structure.json: ${n.status}`);let s;try{s=await n.json()}catch(B){throw new Error(`Failed to parse tanakh-structure.json: ${B}`)}const u=Jo(s),d=Zo(u);console.log(`Loaded ${u.length} verses, bounds: ${d.width}x${d.height}`),hr(a),jt(jr),jt(Mi),jt(Xi),jt(Qi),jt(ta),Hr({verses:u}),Ni({verseTexts:a}),await Promise.all(xi().map(B=>{var c;return(c=B.init)==null?void 0:c.call(B)}));const p=document.getElementById("canvas");if(!p)throw new Error("Canvas not found");const v=window.devicePixelRatio||1;function k(){const B=window.innerWidth,c=window.innerHeight;p.width=B*v,p.height=c*v,p.style.width=B+"px",p.style.height=c+"px"}k();const T=gi(p),P=vi(T.gl,u,v);let C=null;function D(){const B=ii(u,C,Y.hoveredVerse,j),c=ai(B);yi(T.gl,P,c)}const F=kr(window.innerWidth,window.innerHeight,d);let j=null;const Y=qr();function Z(){bi(T,P,F,Y.hoveredVerse,j)}function ye(B){const c=window.innerWidth,f=window.innerHeight;F.x=c/2/F.zoom-B.x-B.size/2,F.y=f/2/F.zoom-B.y-B.size/2}function ue(B,c=!1){j=B,rt(B,!0),c&&ye(B),D(),Z(),wn(window.bookLabels,{x:F.x,y:F.y},F.zoom),ot(!0)}function oe(){j=null,rt(null),D(),Z(),ot(!0)}Z(),window.bookLabels=nr(u,document.body),wn(window.bookLabels,{x:F.x,y:F.y},F.zoom),p.addEventListener("wheel",B=>{B.preventDefault();const c=B.deltaY>0?$o:Fo,f=Cr(F.zoom*c),e=B.clientX,t=B.clientY,o=Tr({x:F.x,y:F.y},F.zoom,f,e,t);F.x=o.x,F.y=o.y,F.zoom=f,Z(),At()},{passive:!1}),p.addEventListener("mousedown",B=>{Wr(Y,B.clientX,B.clientY),p.style.cursor="grabbing"}),p.addEventListener("mousemove",B=>{if(Y.isDragging){const c=B.clientX-Y.dragStart.x,f=B.clientY-Y.dragStart.y;F.x+=c/F.zoom,F.y+=f/F.zoom,Y.dragStart={x:B.clientX,y:B.clientY},Z()}}),p.addEventListener("mouseup",B=>{if(Y.isDragging){Yr(Y),At();const c=hn(u,F,B.clientX,B.clientY);j&&c?p.style.cursor="pointer":p.style.cursor="default"}}),p.addEventListener("mouseleave",()=>{const B=Y.hoveredVerse!==null;Jr(Y),p.style.cursor="default";let c=!1;C!=null&&C.setHoveredVerse&&(c=C.setHoveredVerse(null)),(B||c)&&(D(),Z())});const le=zr(),ge=document.getElementById("controls");function Tt(){var f;if(!C)return{};const B=((f=C.getUrlParams)==null?void 0:f.call(C))??{},c={};return B.trop&&(c.trop=B.trop),B.cat&&(c.category=B.cat),B.q&&(c.q=B.q),B.ww&&(c.ww=B.ww),B.hm&&(c.hm=B.hm),c}function Fe(){const B={overlayParams:{}};return C&&(B.overlay=C.id,B.overlayParams=Tt()),j&&(B.verse=_r(j.book,j.chapter,j.verse)),F.zoom!==jo&&(B.zoom=F.zoom),j||(B.x=F.x,B.y=F.y),B}function ot(B=!1){const c=Fe();Rr(c,B)}const At=Br(()=>ot(!1),Ho);function rt(B,c=!1){Gr(le,B,a,C,rr,c)}p.addEventListener("mousemove",B=>{if(!Y.isDragging){const c=hn(u,F,B.clientX,B.clientY),f=Y.hoveredVerse;Xr(Y,c);const e=!nn(f,c);j&&c?p.style.cursor="pointer":Y.isDragging?p.style.cursor="grabbing":p.style.cursor="default";let t=!1;C!=null&&C.setHoveredVerse&&(t=C.setHoveredVerse(c)),(e||t)&&(D(),Z()),j||(c?rt(c,!1):rt(null))}}),p.addEventListener("click",B=>{const c=hn(u,F,B.clientX,B.clientY);c?j&&j.book===c.book&&j.chapter===c.chapter&&j.verse===c.verse?oe():ue(c):j&&oe()}),(Dt=le.closeBtn)==null||Dt.addEventListener("click",()=>{oe()}),window.addEventListener("keydown",B=>{if(!j)return;if(B.key==="Escape"){oe();return}let c=null;B.key==="ArrowRight"?c=ir(u,j):B.key==="ArrowLeft"&&(c=ar(u,j)),c&&ue(c,!0)});const ze=document.getElementById("overlay-select"),Ve=document.getElementById("overlay-controls"),Ge=document.getElementById("overlay-legend");function _t(B,c=!1){var f,e,t,o;(f=C==null?void 0:C.destroy)==null||f.call(C),C=wi(B)??null,(e=C==null?void 0:C.onUpdate)==null||e.call(C,()=>{var r;D(),Ge&&(Ge.innerHTML="",(r=C==null?void 0:C.renderLegend)==null||r.call(C,Ge)),Z(),ot(!1)}),Ve&&(Ve.innerHTML="",(t=C==null?void 0:C.renderControls)==null||t.call(C,Ve)),Ge&&(Ge.innerHTML="",(o=C==null?void 0:C.renderLegend)==null||o.call(C,Ge)),D(),Z(),c||ot(!0)}ze==null||ze.addEventListener("change",()=>{_t(ze.value)}),window.addEventListener("resize",()=>{k(),Z()}),window.torahMap={verses:u,pan:{x:F.x,y:F.y},zoom:F.zoom,render:Z,canvas:p,bounds:d},zi({verses:u,callbacks:{onVerseClick:B=>{ue(B)}}}),ge&&Sr(ge);function Xt(B){if(B.overlay&&(_t(B.overlay,!0),ze&&(ze.value=B.overlay),C!=null&&C.applyUrlParams)){const c=new URLSearchParams;B.overlayParams.trop&&c.set("trop",B.overlayParams.trop),B.overlayParams.category&&c.set("cat",B.overlayParams.category),B.overlayParams.q&&c.set("q",B.overlayParams.q),B.overlayParams.ww&&c.set("ww",B.overlayParams.ww),B.overlayParams.hm&&c.set("hm",B.overlayParams.hm),C.applyUrlParams(c)}}function he(B){if(!B.verse)return!1;const c=Dr(B.verse);if(!c)return!1;const f=u.find(e=>e.book===c.book&&e.chapter===c.chapter&&e.verse===c.verse);return f?(j=f,rt(f,!0),ye(f),!0):!1}function Jt(B,c){B.zoom!==void 0&&(F.zoom=B.zoom),!c&&B.x!==void 0&&B.y!==void 0&&(F.x=B.x,F.y=B.y)}function Zt(){const B=Mr();Xt(B);const c=he(B);Jt(B,c),D(),Z()}window.location.hash&&Zt(),Lr(()=>{Zt()})}oa().catch(console.error);
