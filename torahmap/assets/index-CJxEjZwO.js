(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))u(d);new MutationObserver(d=>{for(const p of d)if(p.type==="childList")for(const v of p.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&u(v)}).observe(document,{childList:!0,subtree:!0});function c(d){const p={};return d.integrity&&(p.integrity=d.integrity),d.referrerPolicy&&(p.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?p.credentials="include":d.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function u(d){if(d.ep)return;d.ep=!0;const p=c(d);fetch(d.href,p)}})();function mn(n){const s=Math.sin(n*12.9898+n*78.233)*43758.5453;return s-Math.floor(s)}const qt=[{name:"Genesis",file:"genesis",section:"torah"},{name:"Exodus",file:"exodus",section:"torah"},{name:"Leviticus",file:"leviticus",section:"torah"},{name:"Numbers",file:"numbers",section:"torah"},{name:"Deuteronomy",file:"deuteronomy",section:"torah"},{name:"Joshua",file:"joshua",section:"neviim"},{name:"Judges",file:"judges",section:"neviim"},{name:"I Samuel",file:"i-samuel",section:"neviim"},{name:"II Samuel",file:"ii-samuel",section:"neviim"},{name:"I Kings",file:"i-kings",section:"neviim"},{name:"II Kings",file:"ii-kings",section:"neviim"},{name:"Isaiah",file:"isaiah",section:"neviim"},{name:"Jeremiah",file:"jeremiah",section:"neviim"},{name:"Ezekiel",file:"ezekiel",section:"neviim"},{name:"Hosea",file:"hosea",section:"neviim"},{name:"Joel",file:"joel",section:"neviim"},{name:"Amos",file:"amos",section:"neviim"},{name:"Obadiah",file:"obadiah",section:"neviim"},{name:"Jonah",file:"jonah",section:"neviim"},{name:"Micah",file:"micah",section:"neviim"},{name:"Nahum",file:"nahum",section:"neviim"},{name:"Habakkuk",file:"habakkuk",section:"neviim"},{name:"Zephaniah",file:"zephaniah",section:"neviim"},{name:"Haggai",file:"haggai",section:"neviim"},{name:"Zechariah",file:"zechariah",section:"neviim"},{name:"Malachi",file:"malachi",section:"neviim"},{name:"Psalms",file:"psalms",section:"ketuvim"},{name:"Proverbs",file:"proverbs",section:"ketuvim"},{name:"Job",file:"job",section:"ketuvim"},{name:"Song of Songs",file:"song-of-songs",section:"ketuvim"},{name:"Ruth",file:"ruth",section:"ketuvim"},{name:"Lamentations",file:"lamentations",section:"ketuvim"},{name:"Ecclesiastes",file:"ecclesiastes",section:"ketuvim"},{name:"Esther",file:"esther",section:"ketuvim"},{name:"Daniel",file:"daniel",section:"ketuvim"},{name:"Ezra",file:"ezra",section:"ketuvim"},{name:"Nehemiah",file:"nehemiah",section:"ketuvim"},{name:"I Chronicles",file:"i-chronicles",section:"ketuvim"},{name:"II Chronicles",file:"ii-chronicles",section:"ketuvim"}],Io=qt.map(n=>n.name),Mo=new Set(qt.filter(n=>n.section==="torah").map(n=>n.name));new Set(qt.filter(n=>n.section==="neviim").map(n=>n.name));const No=new Set(qt.filter(n=>n.section==="ketuvim").map(n=>n.name));Object.fromEntries(qt.map(n=>[n.name,n.file]));function Ro(n){return Mo.has(n)?"torah":No.has(n)?"ketuvim":"neviim"}const Nn=.5,Rn=2,Lo=.9,_o=1.1,Do=1,Bo=300,$o=2,Zn=60,Qn=20,Lt=6,Ln=2,Kt=12,_n=70,eo=35,_t=50,Fo=12,Dn=3,Bn=15,ln=72,to=[["Hosea","Joel"],["Amos","Obadiah","Jonah"],["Micah","Nahum","Habakkuk","Zephaniah","Haggai"],["Zechariah","Malachi"]],$n=new Set(to.flat()),no=[{books:["Song of Songs","Ruth","Lamentations"],insertAfter:"Job"},{books:["Ecclesiastes","Esther"],insertAfter:"Job"},{books:["Ezra","Nehemiah"],insertAfter:"Daniel"}],jo=new Set(no.flatMap(n=>n.books));function Ho(n){if(!Number.isFinite(n)||n<0)return console.error(`Invalid verse count: ${n}, defaulting to 0`),[0];if(n===0)return[0];if(n<=_t)return[n];const s=[];let c=n;for(;c>0;)if(c<=_t)s.push(c),c=0;else if(c<=_t+Dn-1){const u=c-Dn;s.push(u),c-=u}else s.push(_t),c-=_t;return s}function gn(n,s,c,u,d,p,v){if(!Number.isFinite(c)||c<0)return console.error(`Invalid verse count for ${n} chapter ${s+1}: ${c}`),{width:0,height:0};if(!Number.isFinite(u)||!Number.isFinite(d))return console.error(`Invalid coordinates for ${n} chapter ${s+1}: (${u}, ${d})`),{width:0,height:0};if(!Array.isArray(v))return console.error(`Verses array is not an array for ${n} chapter ${s+1}`),{width:0,height:0};const k=Ho(c);let T=0,I=d,C=0;for(let $=0;$<k.length;$++){const F=k[$];if(!Number.isFinite(F)||F<0){console.error(`Invalid wrap point ${F} at line ${$} for ${n} chapter ${s+1}`);continue}const j=$>0?Fo:0;for(let Y=0;Y<F;Y++){const Z=(mn(p.value*2)-Nn)*Rn,ye=(mn(p.value*2+1)-Nn)*Rn,ue=u+j+Y*Lt+Z;v.push({book:n,chapter:s+1,verse:C+1,x:ue,y:I+ye,size:Lt}),T=Math.max(T,j+(Y+1)*Lt),C++,p.value++}I+=Lt+Ln}return{width:T,height:k.length*(Lt+Ln)}}function kn(n,s,c,u,d){if(!n||typeof n!="object")return console.error(`Invalid book object: ${n}`),{width:0,height:0};if(!n.name||typeof n.name!="string")return console.error(`Invalid book name: ${n.name}`),{width:0,height:0};if(!Array.isArray(n.chapters))return console.error(`Book ${n.name} has invalid chapters array`),{width:0,height:0};if(!Number.isFinite(s)||!Number.isFinite(c))return console.error(`Invalid coordinates for ${n.name}: (${s}, ${c})`),{width:0,height:0};let p=0,v=c;for(let k=0;k<n.chapters.length;k++){const T=n.chapters[k];if(!Number.isFinite(T)||T<0){console.error(`Invalid verse count for ${n.name} chapter ${k+1}: ${T}`);continue}const{width:I,height:C}=gn(n.name,k,T,s,v,u,d);p=Math.max(p,I),v+=C}return{width:p,height:v-c}}function oo(n,s,c,u,d,p,v=kn){if(!Array.isArray(n))return console.error(`Books is not an array: ${n}`),{width:0,height:0,nextX:s};if(!Number.isFinite(s)||!Number.isFinite(c)||!Number.isFinite(u))return console.error(`Invalid layout parameters: startX=${s}, y=${c}, gap=${u}`),{width:0,height:0,nextX:s};let k=s,T=0;for(const I of n){if(!I){console.error("Encountered null or undefined book in layoutBooksRow");continue}const{width:C,height:$}=v(I,k,c,d,p);T=Math.max(T,$),k+=C+u}return{width:k-s-(n.length>0?u:0),height:T,nextX:k}}function ro(n,s,c,u,d,p,v){if(!Array.isArray(n))return console.error(`Book names is not an array: ${n}`),{width:0,height:0};if(!(s instanceof Map))return console.error(`Book map is not a Map: ${s}`),{width:0,height:0};if(!Number.isFinite(c)||!Number.isFinite(u)||!Number.isFinite(d))return console.error(`Invalid layout parameters: x=${c}, startY=${u}, gap=${d}`),{width:0,height:0};let k=u,T=0;for(const C of n){if(!C||typeof C!="string"){console.error(`Invalid book name in stack: ${C}`);continue}const $=s.get(C);if(!$){console.error(`Book not found in map: ${C}`);continue}const{width:F,height:j}=kn($,c,k,p,v);T=Math.max(T,F),k+=j+d}const I=k-u-(n.length>0?d:0);return{width:T,height:I}}function Uo(n,s,c,u,d,p,v,k){if(!Array.isArray(n))return console.error(`Stacks is not an array: ${n}`),{width:0,height:0};if(!Number.isFinite(c)||!Number.isFinite(u)||!Number.isFinite(d)||!Number.isFinite(p))return console.error(`Invalid layout parameters: startX=${c}, y=${u}, stackGap=${d}, columnGap=${p}`),{width:0,height:0};let T=c,I=0;for(const C of n){if(!Array.isArray(C)){console.error(`Stack is not an array: ${C}`);continue}const{width:$,height:F}=ro(C,s,T,u,d,v,k);I=Math.max(I,F),T+=$+p}return{width:T-c-(n.length>0?p:0),height:I}}function Ko(n,s,c,u,d){if(!n||!Array.isArray(n.chapters))return console.error(`Invalid Psalms book structure: ${n==null?void 0:n.name}`),{width:0,height:0};if(!Number.isFinite(s)||!Number.isFinite(c))return console.error(`Invalid coordinates for Psalms: (${s}, ${c})`),{width:0,height:0};const p=Math.min(ln,n.chapters.length);ln>n.chapters.length&&console.warn(`Psalms split point ${ln} exceeds chapter count ${n.chapters.length}, using ${p}`);let v=c,k=0;for(let j=0;j<p;j++){const Y=n.chapters[j];if(j>=n.chapters.length){console.error(`Chapter index ${j} out of bounds for Psalms (${n.chapters.length} chapters)`);break}const{width:Z,height:ye}=gn(n.name,j,Y,s,v,u,d);k=Math.max(k,Z),v+=ye}const T=v-c,I=s+k+Bn;let C=c,$=0;for(let j=p;j<n.chapters.length;j++){const Y=n.chapters[j];if(j>=n.chapters.length){console.error(`Chapter index ${j} out of bounds for Psalms (${n.chapters.length} chapters)`);break}const{width:Z,height:ye}=gn(n.name,j,Y,I,C,u,d);$=Math.max($,Z),C+=ye}const F=C-c;return{width:k+Bn+$,height:Math.max(T,F)}}function zo(n,s,c,u){if(!Array.isArray(n))return console.error(`Nevi'im books is not an array: ${n}`),0;if(!Number.isFinite(s))return console.error(`Invalid Nevi'im section Y: ${s}`),0;const d=n.filter(C=>C&&!$n.has(C.name)),p=n.filter(C=>C&&$n.has(C.name)),v=new Map(p.map(C=>[C.name,C])),{height:k,nextX:T}=oo(d,0,s,Kt,c,u),{height:I}=Uo(to,v,T,s,eo,Kt,c,u);return Math.max(k,I)}function Vo(n,s,c,u){if(!Array.isArray(n))return console.error(`Ketuvim books is not an array: ${n}`),0;if(!Number.isFinite(s))return console.error(`Invalid Ketuvim section Y: ${s}`),0;const d=new Map(n.filter(T=>T&&T.name).map(T=>[T.name,T]));let p=0,v=0;const k=n.filter(T=>T&&!jo.has(T.name));for(const T of k){if(!T){console.error("Encountered null or undefined book in Ketuvim");continue}const{width:I,height:C}=T.name==="Psalms"?Ko(T,p,s,c,u):kn(T,p,s,c,u);v=Math.max(v,C),p+=I+Kt;for(const $ of no){if(!$||!Array.isArray($.books)){console.error(`Invalid Ketuvim stack config: ${$}`);continue}if(T.name===$.insertAfter){const{width:F,height:j}=ro($.books,d,p,s,eo,c,u);v=Math.max(v,j),p+=F+Kt}}}return v}function Go(n,s,c,u){if(!Array.isArray(n))return console.error(`Torah books is not an array: ${n}`),0;if(!Number.isFinite(s))return console.error(`Invalid Torah section Y: ${s}`),0;const{height:d}=oo(n,0,s,Kt,c,u);return d}function qo(n){if(!n||typeof n!="object")return console.error("Invalid torahData: not an object"),[];if(!Array.isArray(n.books))return console.error("Invalid torahData: books is not an array"),[];if(n.books.length===0)return console.warn("Empty books array in torahData"),[];const s=[],c={value:0},u=[],d=[],p=[];for(const I of n.books){if(!I||typeof I!="object"){console.error(`Invalid book in torahData: ${I}`);continue}if(!I.name||typeof I.name!="string"){console.error(`Book missing valid name: ${JSON.stringify(I)}`);continue}const C=Ro(I.name);C==="torah"?u.push(I):C==="neviim"?d.push(I):C==="ketuvim"?p.push(I):console.warn(`Book ${I.name} has unknown section: ${C}`)}u.length===0&&console.warn("Torah section is empty"),d.length===0&&console.warn("Neviim section is empty"),p.length===0&&console.warn("Ketuvim section is empty");let v=0;const k=Go(u,v,c,s);v+=k+_n;const T=zo(d,v,c,s);return v+=T+_n,Vo(p,v,c,s),s}function Wo(n){if(!Array.isArray(n))return console.error("getLayoutBounds: verses is not an array"),{width:0,height:0};if(n.length===0)return console.warn("getLayoutBounds: empty verses array"),{width:0,height:0};let s=0,c=0;for(const u of n){if(!u||typeof u!="object"){console.error(`Invalid verse in bounds calculation: ${u}`);continue}if(!Number.isFinite(u.x)||!Number.isFinite(u.y)||!Number.isFinite(u.size)){console.error(`Invalid verse coordinates: ${u.book} ${u.chapter}:${u.verse} at (${u.x}, ${u.y}) size=${u.size}`);continue}(u.x<-2||u.y<-2||u.size<0)&&console.warn(`Suspicious coordinates for verse ${u.book} ${u.chapter}:${u.verse}: (${u.x}, ${u.y}) size=${u.size}`),s=Math.max(s,u.x+u.size),c=Math.max(c,u.y+u.size)}return!Number.isFinite(s)||!Number.isFinite(c)?(console.error(`Invalid bounds calculated: width=${s}, height=${c}`),{width:0,height:0}):{width:s,height:c}}const Yo=10,Fn=13,Xo=5,Jo=50;function Zo(n,s){const c={};for(const d of n)c[d.book]||(c[d.book]={minX:d.x,maxX:d.x+d.size,minY:d.y}),c[d.book].maxX=Math.max(c[d.book].maxX,d.x+d.size),c[d.book].minY=Math.min(c[d.book].minY,d.y);const u=document.createElement("div");u.id="book-labels",u.style.cssText="position:fixed;top:0;left:0;pointer-events:none;";for(const[d,p]of Object.entries(c)){const v=document.createElement("div");v.textContent=d,v.style.cssText=`
      position:absolute;
      color:#eee;
      font-family:sans-serif;
      font-weight:700;
      text-shadow:0 1px 3px rgba(0,0,0,0.8);
      white-space:nowrap;
    `,v.dataset.bookName=d,v.dataset.leftX=String(p.minX),v.dataset.topY=String(p.minY),u.appendChild(v)}return s.appendChild(u),u}function vn(n,s,c){const u=Math.max(Xo,Math.min(Jo,Fn*c)),d=Yo*(u/Fn);for(const p of n.children)if(p instanceof HTMLElement){const v=parseFloat(p.dataset.leftX||"0"),k=parseFloat(p.dataset.topY||"0"),T=(v+s.x)*c,I=(k+s.y)*c-u-d;p.style.left=T+"px",p.style.top=I+"px",p.style.fontSize=u+"px"}}async function Qo(){const n=await fetch("/torahmap/data/all-texts.json");return n.ok?await n.json():(console.error(`Failed to load verse texts: ${n.status}`),{})}function er(n,s,c,u){var d,p;return((p=(d=n[s])==null?void 0:d[String(c)])==null?void 0:p[String(u)])||null}function tn(n,s){return n===null&&s===null?!0:n===null||s===null?!1:n.book===s.book&&n.chapter===s.chapter&&n.verse===s.verse}function tr(n,s){const c=n.findIndex(u=>u.book===s.book&&u.chapter===s.chapter&&u.verse===s.verse);return c===-1||c>=n.length-1?null:n[c+1]}function nr(n,s){const c=n.findIndex(u=>u.book===s.book&&u.chapter===s.chapter&&u.verse===s.verse);return c<=0?null:n[c-1]}function $e(n,s,c){return`${n}:${s}:${c}`}const or=1424,rr=1535,Cn=1425,Tn=1479,ir=["ו","ה","ב","ל","כ","מ","ש"],ar=["וב","וה","ול","וכ","ומ","וש","מה","שב","של","בה"];let zt=[],it=null,It=null,yn=null;function ct(n){let s="";for(const c of n){const u=c.charCodeAt(0);(u<Cn||u>Tn||u===1470||u===1472||u===1475||u===1478)&&(s+=c)}return s}function io(n){return n.split(/[,،‎\u05F4]/).map(s=>s.trim()).filter(s=>s.length>=$o)}async function sr(){try{const[n,s,c]=await Promise.all([fetch("/data/word-lemmas.json"),fetch("/data/verse-lemmas.json"),fetch("/data/strongs-to-root.json")]);n.ok&&s.ok&&c.ok?(it=await n.json(),It=await s.json(),yn=await c.json()):console.warn("Failed to load lemma data, falling back to substring search")}catch(n){console.warn("Error loading lemma data:",n)}}function ao(n){if(!it)return null;const s=ct(n);if(it[s])return it[s];for(const c of ar)if(s.startsWith(c)&&s.length>c.length+1){const u=s.slice(c.length);if(it[u])return it[u]}for(const c of ir)if(s.startsWith(c)&&s.length>2){const u=s.slice(c.length);if(it[u])return it[u]}return null}function cr(n){return yn&&yn[n]||null}function at(n){for(const s of n){const c=s.charCodeAt(0);if(c>=or&&c<=rr)return!0}return!1}function ur(n){zt=[];for(const s of Io){const c=n[s];if(!c)continue;const u=Object.keys(c).map(Number).sort((d,p)=>d-p);for(const d of u){const p=c[String(d)],v=Object.keys(p).map(Number).sort((k,T)=>k-T);for(const k of v){const{he:T,en:I}=p[String(k)];zt.push({book:s,chapter:d,verse:k,hebrewText:ct(T),hebrewOriginal:T,englishText:I.toLowerCase(),englishOriginal:I})}}}}function lr(n){const s=new Set;if(!It)return s;for(const[c,u]of Object.entries(It))n.some(d=>u.includes(d))&&s.add(c);return s}function fr(n,s){if(!It)return-1;const c=It[n];if(!c)return-1;for(let u=0;u<c.length;u++)if(s.includes(c[u]))return u;return-1}function so(n,s){if(s<0)return null;let c=0,u=0;for(;u<n.length&&/\s/.test(n[u]);)u++;for(;c<s&&u<n.length;){for(;u<n.length&&!/\s/.test(n[u]);)u++;for(;u<n.length&&/\s/.test(n[u]);)u++;c++}if(u>=n.length)return null;let d=u;for(;d<n.length&&!/\s/.test(n[d]);)d++;return{start:u,end:d}}function Qt(n){const s=new Map;for(let c=0;c<n.length;c++){const u=n[c],d=ct(u);for(const p of zt){const k=p.hebrewText.split(/\s+/).findIndex(T=>T===d);if(k!==-1){const T=so(p.hebrewOriginal,k);if(T){const I=`${p.book}:${p.chapter}:${p.verse}`;let C=s.get(I);if(C||(C={book:p.book,chapter:p.chapter,verse:p.verse,language:"he",matchingTerms:[]},s.set(I,C)),!C.matchingTerms.some($=>$.termIndex===c)){const $=T.end-T.start,F=co(p.hebrewOriginal,T.start,$);C.matchingTerms.push({termIndex:c,snippet:F.text,matchStart:F.matchStart,matchEnd:F.matchEnd})}}}}}return Array.from(s.values())}function dr(n){const s=new Map;if(!it||!It)return Qt(n);const c=[];for(let u=0;u<n.length;u++){const d=ao(n[u]);d&&d.length>0&&c.push({termIndex:u,lemmas:d})}if(c.length>0){for(const{termIndex:u,lemmas:d}of c){const p=lr(d);for(const v of p){const k=zt.find(T=>`${T.book}:${T.chapter}:${T.verse}`===v);if(k){let T=s.get(v);if(T||(T={book:k.book,chapter:k.chapter,verse:k.verse,language:"he",matchingTerms:[]},s.set(v,T)),!T.matchingTerms.some(I=>I.termIndex===u)){const I=fr(v,d),C=I>=0?so(k.hebrewOriginal,I):null;if(C){const $=C.end-C.start,F=co(k.hebrewOriginal,C.start,$);T.matchingTerms.push({termIndex:u,snippet:F.text,matchStart:F.matchStart,matchEnd:F.matchEnd})}else{const F=Qt([n[u]]).find(j=>j.book===k.book&&j.chapter===k.chapter&&j.verse===k.verse);if(F&&F.matchingTerms.length>0){const j=F.matchingTerms[0];T.matchingTerms.push({termIndex:u,snippet:j.snippet,matchStart:j.matchStart,matchEnd:j.matchEnd})}else T.matchingTerms.push({termIndex:u,snippet:k.hebrewOriginal.slice(0,60)+(k.hebrewOriginal.length>60?"...":""),matchStart:0,matchEnd:0})}}}}}if(s.size>0)return Array.from(s.values())}return Qt(n)}function hr(n,s=!1,c="substring"){const u=io(n);if(u.length===0)return[];const d=at(u[0]);if(d)switch(c){case"word":return Qt(u);case"root":return dr(u)}const p=new Map;for(let v=0;v<u.length;v++){const k=u[v],T=d?ct(k):k.toLowerCase();for(const I of zt){const C=d?I.hebrewText:I.englishText,$=d?I.hebrewOriginal:I.englishOriginal;let F=[];if(!d&&s){const j=T.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Y=new RegExp(`\\b${j}\\b`,"gi");let Z;for(;(Z=Y.exec(C))!==null;)F.push({idx:Z.index,len:Z[0].length})}else{const j=C.indexOf(T);j!==-1&&F.push({idx:j,len:T.length})}for(const{idx:j,len:Y}of F){const Z=`${I.book}:${I.chapter}:${I.verse}`,ye=gr($,j,Y,d);let ue=p.get(Z);ue||(ue={book:I.book,chapter:I.chapter,verse:I.verse,language:d?"he":"en",matchingTerms:[]},p.set(Z,ue)),ue.matchingTerms.some(oe=>oe.termIndex===v)||ue.matchingTerms.push({termIndex:v,snippet:ye.text,matchStart:ye.matchStart,matchEnd:ye.matchEnd})}}}return Array.from(p.values())}function co(n,s,c){const u=Zn,d=Qn,p=Math.min(s+c,n.length);let v=Math.max(0,s-d),k=Math.min(n.length,v+u);k===n.length&&k-v<u&&(v=Math.max(0,k-u));let T=n.slice(v,k);const I=s-v,C=p-v;let $=0;return v>0&&(T="..."+T,$=3),k<n.length&&(T=T+"..."),{text:T,matchStart:I+$,matchEnd:Math.min(C+$,T.length)}}function pr(n,s){if(s<0)return 0;let c=0;for(let u=0;u<n.length;u++){if(c===s)return u;const d=n.charCodeAt(u);d>=Cn&&d<=Tn&&d!==1470&&d!==1472&&d!==1475&&d!==1478||c++}return n.length}function mr(n,s,c){if(s<0||s>=n.length||c<0)return 0;let u=0,d=0;for(let p=s;p<n.length&&d<c;p++){const v=n.charCodeAt(p);v>=Cn&&v<=Tn&&v!==1470&&v!==1472&&v!==1475&&v!==1478?u++:d++}return u}function gr(n,s,c,u=!1){const d=Zn,p=Qn;let v=s,k=s+c;if(u){v=pr(n,s);const Y=mr(n,v,c);k=Math.min(v+c+Y,n.length)}let T=Math.max(0,v-p),I=Math.min(n.length,T+d);I===n.length&&I-T<d&&(T=Math.max(0,I-d));let C=n.slice(T,I);const $=v-T,F=k-T;let j=0;return T>0&&(C="..."+C,j=3),I<n.length&&(C=C+"..."),{text:C,matchStart:$+j,matchEnd:Math.min(F+j,C.length)}}function vr(n){const s=new Map;for(const c of n){const u=$e(c.book,c.chapter,c.verse);s.set(u,c.matchingTerms.map(d=>d.termIndex))}return s}const uo="torahMap.helpSeen",lo="torahMap.helpTab",fo={overview:{title:"Overview",content:`
      <h2>Torah Map</h2>
      <p>An interactive visualization of the entire Tanakh (Hebrew Bible) where every verse has a fixed position.</p>
      <p>The map is divided into three sections, stacked vertically:</p>
      <ul>
        <li><strong>Torah</strong> — The Five Books of Moses</li>
        <li><strong>Nevi'im</strong> — The Prophets</li>
        <li><strong>Ketuvim</strong> — The Writings</li>
      </ul>
      <p>Switch between different analytical overlays to reveal patterns across 23,000+ verses.</p>
      <p class="credits">
        By <a href="https://danyelfisher.info" target="_blank">Danyel Fisher</a> ·
        <a href="https://github.com/danyelf/torahmap" target="_blank">GitHub</a> ·
        Data from <a href="https://www.sefaria.org/" target="_blank">Sefaria</a>
      </p>
    `},controls:{title:"Controls",content:`
      <table class="controls-table">
        <tr><td>Mouse wheel</td><td>Zoom in/out</td></tr>
        <tr><td>Click + drag</td><td>Pan around</td></tr>
        <tr><td>Hover</td><td>Preview verse details</td></tr>
        <tr><td>Click verse</td><td>Pin verse in sidebar</td></tr>
        <tr><td>Click pinned</td><td>Unpin verse</td></tr>
      </table>
    `},overlays:{title:"Overlays",content:`
      <dl class="overlay-list">
        <dt>Text Search</dt>
        <dd>Search Hebrew or English text. Matching verses are highlighted on the map.</dd>

        <dt>Commentary</dt>
        <dd>Heatmap showing commentary density from Sefaria. Filter by source type.</dd>

        <dt>Trop</dt>
        <dd>Visualize cantillation marks (trope). Select a mark to see where it appears.</dd>
      </dl>
    `}};let wt=null;function yr(){const n=document.createElement("div");n.id="help-modal",n.className="help-modal",n.innerHTML=`
    <div class="help-backdrop"></div>
    <div class="help-content">
      <div class="help-header">
        <div class="help-tabs">
          <button class="help-tab active" data-tab="overview">Overview</button>
          <button class="help-tab" data-tab="controls">Controls</button>
          <button class="help-tab" data-tab="overlays">Overlays</button>
        </div>
        <button class="help-close">&times;</button>
      </div>
      <div class="help-body"></div>
    </div>
  `;const s=n.querySelector(".help-backdrop"),c=n.querySelector(".help-close"),u=n.querySelectorAll(".help-tab");return s.addEventListener("click",Hn),c.addEventListener("click",Hn),u.forEach(d=>{d.addEventListener("click",()=>{const p=d.dataset.tab;ho(n,p)})}),n}function ho(n,s){localStorage.setItem(lo,s),n.querySelectorAll(".help-tab").forEach(u=>{u.classList.toggle("active",u.dataset.tab===s)});const c=n.querySelector(".help-body");c.innerHTML=fo[s].content}function jn(){wt||(wt=yr(),document.body.appendChild(wt));const n=localStorage.getItem(lo),s=n&&fo[n]?n:"overview";wt.classList.add("visible"),ho(wt,s)}function Hn(){wt&&(wt.classList.remove("visible"),localStorage.setItem(uo,"true"))}function br(n){const s=document.createElement("button");s.id="help-btn",s.textContent="?",s.title="How to use",s.addEventListener("click",jn),n.appendChild(s),localStorage.getItem(uo)||jn()}const po=.1,mo=10;function wr(n,s,c){return{x:n/2-c.width/2,y:s/2-c.height/2,zoom:1}}function xr(n){return Math.max(po,Math.min(mo,n))}function Er(n,s,c,u,d){return{x:n.x+u*(1/c-1/s),y:n.y+d*(1/c-1/s)}}const Un=1e6,go=50,Sr=1e3;function vo(n,s){if(!n)return null;const c=n.trim();return!c||c.length>s||/<[^>]*>/.test(c)||/javascript:/i.test(c)||/on\w+=/i.test(c)?null:c}function Jt(n,s=go){const c=vo(n,s);return!c||/[/\\|;]/.test(c)?null:c}function kr(n){const s=vo(n,go);return!s||!/^[a-zA-Z\s/]+$/.test(s)?null:s}function Cr(n){return!n||n.trim()===""?!1:/^[a-zA-Z\u0590-\u05FF\s.]+$/.test(n)}function Tr(n){return n.replace(/<[^>]*>/g,"")}function Ar(){const n=window.location.hash.slice(1),s=new URLSearchParams(n),c={overlayParams:{}},u=s.get("overlay"),d=Jt(u);d&&(c.overlay=d);const p=s.get("verse"),v=Jt(p,100);v&&(c.verse=v);const k=s.get("zoom");if(k){const oe=parseFloat(k);!isNaN(oe)&&oe>=po&&oe<=mo&&(c.zoom=oe)}const T=s.get("x");if(T){const oe=parseFloat(T);!isNaN(oe)&&isFinite(oe)&&Math.abs(oe)<=Un&&(c.x=oe)}const I=s.get("y");if(I){const oe=parseFloat(I);!isNaN(oe)&&isFinite(oe)&&Math.abs(oe)<=Un&&(c.y=oe)}const C=s.get("trop"),$=Jt(C);$&&(c.overlayParams.trop=$);const F=s.get("category"),j=kr(F);j&&(c.overlayParams.category=j);const Y=s.get("q");if(Y){const oe=Y.trim();oe&&oe.length<=Sr&&(c.overlayParams.q=Tr(oe))}const Z=s.get("ww");Z&&(c.overlayParams.ww=Z);const ye=s.get("hm"),ue=Jt(ye);return ue&&(ue==="substring"||ue==="word"||ue==="root")&&(c.overlayParams.hm=ue),c}function Or(n){const s=new URLSearchParams;n.overlay&&s.set("overlay",n.overlay),n.verse&&s.set("verse",n.verse),n.zoom!==void 0&&n.zoom!==1&&s.set("zoom",n.zoom.toFixed(2).replace(/\.?0+$/,"")),n.verse||(n.x!==void 0&&s.set("x",n.x.toFixed(1).replace(/\.?0+$/,"")),n.y!==void 0&&s.set("y",n.y.toFixed(1).replace(/\.?0+$/,""))),n.overlayParams.trop&&s.set("trop",n.overlayParams.trop),n.overlayParams.category&&n.overlayParams.category!=="all"&&s.set("category",n.overlayParams.category),n.overlayParams.q&&s.set("q",n.overlayParams.q),n.overlayParams.ww&&s.set("ww",n.overlayParams.ww),n.overlayParams.hm&&s.set("hm",n.overlayParams.hm);const c=s.toString();return c?`#${c}`:""}function Pr(n,s=!1){const c=Or(n),u=window.location.pathname+window.location.search+c;s?history.pushState(null,"",u):history.replaceState(null,"",u)}function Ir(n){window.addEventListener("popstate",n),window.addEventListener("hashchange",n)}function Mr(n,s,c){return`${n.replace(/ /g,".")}.${s}.${c}`}function Nr(n){const s=n.split(".");if(s.length<3||s.length>5)return null;const c=s.pop(),u=s.pop(),d=s.join(" "),p=parseInt(c,10),v=parseInt(u,10);return isNaN(p)||isNaN(v)||p<0||v<0||v>200||p>200||!Cr(d)?null:{book:d,chapter:v,verse:p}}function Rr(n,s){let c=null;return(...u)=>{c&&clearTimeout(c),c=setTimeout(()=>{n(...u),c=null},s)}}const Ct=[[.1,.7,.8],[1,.5,0],[.5,1,.2],[1,.2,.8],[1,1,.2]];function Kn(n,s){const c=Math.max(0,Math.min(1,n));for(let u=0;u<s.length-1;u++){const d=s[u],p=s[u+1];if(c>=d.t&&c<=p.t){const v=p.t-d.t,k=v>0?(c-d.t)/v:0;return[d.color[0]+k*(p.color[0]-d.color[0]),d.color[1]+k*(p.color[1]-d.color[1]),d.color[2]+k*(p.color[2]-d.color[2])]}}return s[s.length-1].color}function bn(n,s,c,u){if((u==null?void 0:u.useLog)??!1){const p=Math.log(s+1),v=Math.log(n+1)/p;return Kn(v,c)}else{const p=s>0?n/s:0;return Kn(p,c)}}function Lr(n,s){return n===0?[.15,.15,.2]:bn(n,s,[{t:0,color:[.1,.13,.18]},{t:.25,color:[.1,.23,.38]},{t:.5,color:[.2,.43,.33]},{t:.75,color:[.9,.33,.13]},{t:1,color:[1,.23,.18]}],{useLog:!0})}function _r(n){const[s,c,u]=n,d=Math.max(s,c,u),p=Math.min(s,c,u),v=(d+p)/2;if(d===p)return{h:0,s:0,l:v};const k=d-p,T=v>.5?k/(2-d-p):k/(d+p);let I;return d===s?I=((c-u)/k+(c<u?6:0))/6:d===c?I=((u-s)/k+2)/6:I=((s-c)/k+4)/6,{h:I*360,s:T,l:v}}function yo(n){const{h:s,s:c,l:u}=n;if(c===0)return[u,u,u];const d=(T,I,C)=>(C<0&&(C+=1),C>1&&(C-=1),C<1/6?T+(I-T)*6*C:C<1/2?I:C<2/3?T+(I-T)*(2/3-C)*6:T),p=u<.5?u*(1+c):u+c-u*c,v=2*u-p,k=s/360;return[d(v,p,k+1/3),d(v,p,k),d(v,p,k-1/3)]}let Vt={},Ce="total",lt=null,Et={},bo=[];function wo(n,s,c){var d,p;const u=(p=(d=Vt[n])==null?void 0:d[String(s)])==null?void 0:p[String(c)];return u?Ce==="total"?u.total:u.categories[Ce]||0:0}function zn(){if(Et[Ce]!==void 0)return Et[Ce];let n=0;for(const s of bo){const c=wo(s.book,s.chapter,s.verse);c>n&&(n=c)}return Et[Ce]=n,n}const Dr={id:"commentary",name:"Commentary Density",async init(){try{const n=await fetch("/torahmap/data/commentary-counts.json");if(!n.ok){console.error(`Failed to load commentary-counts.json: ${n.status}`);return}Vt=await n.json()}catch(n){console.error("Failed to parse commentary-counts.json:",n)}},destroy(){Et={},lt=null},onUpdate(n){lt=n},getVerseColor(n){const s=wo(n.book,n.chapter,n.verse),c=zn();return Lr(s,c)},renderControls(n){const s=document.createElement("div");s.className="commentary-controls",s.innerHTML=`
      <label for="category-select">Category:</label>
      <select id="category-select">
        <option value="total">All Commentary</option>
        <option value="Talmud">Talmud</option>
        <option value="Midrash">Midrash</option>
        <option value="Halakhah">Halakhah</option>
        <option value="Jewish Thought">Jewish Thought</option>
        <option value="Chasidut">Chasidut</option>
        <option value="Kabbalah">Kabbalah</option>
        <option value="Musar">Musar</option>
      </select>
    `;const c=s.querySelector("select");c.value=Ce,c.addEventListener("change",()=>{Ce=c.value,Et={},lt==null||lt()}),n.appendChild(s)},renderLegend(n){const s=zn(),c=Math.log(s+1),u=[0];let d=1;for(;d<=s;)u.push(d),d*=10;u[u.length-1]<s&&u.push(s),n.innerHTML=`
      <div class="legend-gradient"></div>
      <div class="legend-ticks">
        ${u.map(p=>{const v=p===0?0:Math.log(p+1)/c*100,k=p>=1e3?`${p/1e3}k`:String(p);return`<span class="tick" style="left: ${v}%">${k}</span>`}).join("")}
      </div>
    `},getHoverInfo(n){var u,d;const s=(d=(u=Vt[n.book])==null?void 0:u[String(n.chapter)])==null?void 0:d[String(n.verse)];if(!s)return null;if(Ce==="total")return`${s.total} links`;const c=s.categories[Ce];return c?`${c} ${Ce}`:`no ${Ce}`},getUrlParams(){return Ce==="total"?{}:{cat:Ce}},applyUrlParams(n){const s=n.get("cat");s&&(Ce=s,Et={},lt==null||lt())},getLinkSubtitle(n){const s=Fr(n.book,n.chapter,n.verse);if(!s)return null;const c=Ce==="total"?"linked texts":`${Ce} links`;return`${s} ${c}`}};function Br(n){bo=n.verses,Et={},Ce="total"}function $r(n,s,c){var d,p;const u=(p=(d=Vt[n])==null?void 0:d[String(s)])==null?void 0:p[String(c)];return(u==null?void 0:u.total)??null}function Fr(n,s,c){var d,p;const u=(p=(d=Vt[n])==null?void 0:d[String(s)])==null?void 0:p[String(c)];return u?Ce==="total"?u.total:u.categories[Ce]??null:null}function jr(){const n=document.getElementById("verse-sidebar");return{sidebar:n,ref:(n==null?void 0:n.querySelector(".ref-text"))??null,overlayInfo:(n==null?void 0:n.querySelector(".overlay-info"))??null,hebrew:(n==null?void 0:n.querySelector(".verse-hebrew"))??null,english:(n==null?void 0:n.querySelector(".verse-english"))??null,link:(n==null?void 0:n.querySelector(".sefaria-link"))??null,linkSubtitle:(n==null?void 0:n.querySelector(".link-subtitle"))??null,closeBtn:(n==null?void 0:n.querySelector(".close-btn"))??null}}function Hr(n,s,c,u=null){var v;const p=`https://www.sefaria.org/${n.replace(/ /g,"_")}.${s}.${c}`;if((u==null?void 0:u.id)==="commentary"){const k=(v=u.getUrlParams)==null?void 0:v.call(u),T=k==null?void 0:k.cat;if(T)return`${p}?with=${encodeURIComponent(T)}`}return`${p}?with=all`}function Ur(n,s,c,u,d,p=!1){var Y,Z,ye,ue,oe;const{sidebar:v,ref:k,overlayInfo:T,hebrew:I,english:C,link:$,linkSubtitle:F}=n;if(!v)return;if(!s){v.classList.remove("visible"),v.classList.remove("pinned");return}const j=d(c,s.book,s.chapter,s.verse);if(k&&(k.textContent=`${s.book} ${s.chapter}:${s.verse}`),T){const le=(Y=u==null?void 0:u.renderSidebarInfo)==null?void 0:Y.call(u,s,p);if(le)typeof le=="string"?T.innerHTML=le:T.replaceChildren(le);else{const ge=(Z=u==null?void 0:u.getHoverInfo)==null?void 0:Z.call(u,s);T.textContent=ge||""}}if(I){const le=(j==null?void 0:j.he)||"Loading...",ge=(ye=u==null?void 0:u.highlightVerseText)==null?void 0:ye.call(u,le,"he");ge&&ge!==le?typeof ge=="string"?I.innerHTML=ge:I.replaceChildren(ge):I.textContent=le}if(C){const le=(j==null?void 0:j.en)||"Loading...",ge=(ue=u==null?void 0:u.highlightVerseText)==null?void 0:ue.call(u,le,"en");ge&&ge!==le?typeof ge=="string"?C.innerHTML=ge:C.replaceChildren(ge):C.textContent=le}if($&&($.href=Hr(s.book,s.chapter,s.verse,u)),F){const le=(oe=u==null?void 0:u.getLinkSubtitle)==null?void 0:oe.call(u,s);if(le)F.textContent=le;else{const ge=$r(s.book,s.chapter,s.verse);F.textContent=ge?`${ge} linked texts`:""}}v.classList.add("visible"),p?v.classList.add("pinned"):v.classList.remove("pinned")}function Kr(){return{isDragging:!1,hoveredVerse:null,dragStart:{x:0,y:0}}}function zr(n,s,c){n.isDragging=!0,n.dragStart={x:s,y:c}}function Vr(n){n.isDragging=!1}function Gr(n,s){n.hoveredVerse=s}function qr(n){n.isDragging=!1,n.hoveredVerse=null}const xe={FUZZY_RADIUS:10,MIN_BRIGHTNESS:.4,BRIGHTNESS_RANGE:.4,OUTLINE_COLOR:[.6,.6,.6],BLEED_PIXELS:3,HIGHLIGHT_COLOR:[.2,.9,1],PINNED_OUTLINE_COLOR:[.2,.9,1],HOVER_OUTLINE_COLOR:[1,1,1],HOVER_WHILE_PINNED_OUTLINE_COLOR:[1,.8,.2],DIM_FACTOR:.3,BRIGHTNESS_FACTOR:1.5,DESATURATE_FACTOR:.2,RARE_NO_MATCH_COLOR:[.25,.25,.25]};function Wr(n,s,c){return{x:n/c.zoom-c.x,y:s/c.zoom-c.y}}function Yr(n,s,c){return n>=c.x&&n<c.x+c.size&&s>=c.y&&s<c.y+c.size}function Xr(n,s,c){for(const u of n)if(Yr(s,c,u))return u;return null}function Jr(n,s,c){let u=null,d=xe.FUZZY_RADIUS*xe.FUZZY_RADIUS;for(const p of n){const v=p.x+p.size/2,k=p.y+p.size/2,T=s-v,I=c-k,C=T*T+I*I;C<d&&(u=p,d=C)}return u}function fn(n,s,c,u){const{x:d,y:p}=Wr(c,u,s),v=Xr(n,d,p);return v||Jr(n,d,p)}function Zr(n){const s=xe.MIN_BRIGHTNESS+mn(n*3)*xe.BRIGHTNESS_RANGE;return[s,s,s]}function Qr(n,s){return(n==null?void 0:n.getVerseColor(s))??null}function ei(n,s){if(s){if(Array.isArray(n[0]))return n.map(c=>[Math.min(1,c[0]*xe.BRIGHTNESS_FACTOR),Math.min(1,c[1]*xe.BRIGHTNESS_FACTOR),Math.min(1,c[2]*xe.BRIGHTNESS_FACTOR)]);{const c=n;return[Math.min(1,c[0]*xe.BRIGHTNESS_FACTOR),Math.min(1,c[1]*xe.BRIGHTNESS_FACTOR),Math.min(1,c[2]*xe.BRIGHTNESS_FACTOR)]}}else return xe.HIGHLIGHT_COLOR}function ti(n,s,c,u){return n.map((d,p)=>{const v=Qr(s,d),k=v!==null,T=k?v:Zr(p),I=tn(c,d),C=tn(u,d);return{hasOverlayColor:k,baseColor:T,isHovered:I,isPinned:C,isHoveredWhilePinned:I&&u!==null&&!C}})}function ni(n){return n.map(s=>{let c=s.baseColor;return s.isHovered&&(c=ei(c,s.hasOverlayColor)),c})}const oi=`#version 300 es
  uniform vec2 u_resolution;
  uniform vec2 u_pan;
  uniform float u_zoom;

  in vec2 a_position;
  in vec3 a_color;
  in vec3 a_color2;
  in vec3 a_color3;
  in vec3 a_color4;
  in float a_colorCount;
  in vec2 a_uv;
  in vec2 a_seed;

  out vec3 v_color;
  out vec3 v_color2;
  out vec3 v_color3;
  out vec3 v_color4;
  flat out int v_colorCount;
  out vec2 v_uv;
  out vec2 v_seed;

  void main() {
    vec2 pos = (a_position + u_pan) * u_zoom;
    vec2 clipSpace = (pos / u_resolution) * 2.0 - 1.0;
    gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);
    v_color = a_color;
    v_color2 = a_color2;
    v_color3 = a_color3;
    v_color4 = a_color4;
    v_colorCount = int(a_colorCount);
    v_uv = a_uv;
    v_seed = a_seed;
  }
`,ri=`#version 300 es
  precision mediump float;
  in vec3 v_color;
  in vec3 v_color2;
  in vec3 v_color3;
  in vec3 v_color4;
  flat in int v_colorCount;
  in vec2 v_uv;
  in vec2 v_seed;
  out vec4 fragColor;

  // Simple hash for dithering noise and stipple selection
  float hash(vec2 p) {
    return fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453);
  }

  // Second hash with different coefficients for variety
  float hash2(vec2 p) {
    return fract(sin(dot(p, vec2(39.346, 11.135))) * 83758.5453);
  }

  void main() {
    vec3 color;

    if (v_colorCount <= 1) {
      // Single color - use directly
      color = v_color;
    } else {
      // Multiple colors with bleed effect
      // UV < 0 or > 1 means we're in the bleed zone
      bool inBleedZone = v_uv.x < 0.0 || v_uv.x > 1.0 || v_uv.y < 0.0 || v_uv.y > 1.0;

      if (inBleedZone) {
        // In bleed zone: sparse scattered pixels
        // Use seed + UV to create unique pattern per verse
        vec2 scatterCoord = floor(v_uv * 8.0) + v_seed * 0.1;
        float scatter = hash(scatterCoord);
        float scatter2 = hash2(scatterCoord);

        // Only render ~30% of pixels in bleed zone (sparse scatter)
        if (scatter > 0.3) {
          discard;
        }

        // Pick a color from the available colors
        int idx = int(floor(scatter2 * float(v_colorCount)));
        if (idx == 0) {
          color = v_color;
        } else if (idx == 1) {
          color = v_color2;
        } else if (idx == 2) {
          color = v_color3;
        } else {
          color = v_color4;
        }
      } else {
        // Inside verse: use seed-varied stipple pattern
        // Combine UV with verse seed for unique pattern per verse
        // Use a 5x5 grid with per-verse offset for more organic feel
        vec2 blockCoord = floor(v_uv * 5.0 + fract(v_seed * 0.0731) * 5.0);
        float h = hash(blockCoord + v_seed * 0.0137);
        int idx = int(floor(h * float(v_colorCount)));

        // Select color based on hash
        if (idx == 0) {
          color = v_color;
        } else if (idx == 1) {
          color = v_color2;
        } else if (idx == 2) {
          color = v_color3;
        } else {
          color = v_color4;
        }
      }
    }

    // Add subtle dithering noise to break up moiré patterns (UV-based for zoom stability)
    vec2 noiseCoord = floor(v_uv * 12.0);
    float noise = (hash(noiseCoord + v_seed * 0.01) - 0.5) * 0.1;
    color = color + noise;

    fragColor = vec4(color, 1.0);
  }
`,ii=`#version 300 es
  uniform vec2 u_resolution;
  uniform vec2 u_pan;
  uniform float u_zoom;

  in vec2 a_position;

  void main() {
    vec2 pos = (a_position + u_pan) * u_zoom;
    vec2 clipSpace = (pos / u_resolution) * 2.0 - 1.0;
    gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);
  }
`,ai=`#version 300 es
  precision mediump float;
  uniform vec3 u_color;
  out vec4 fragColor;

  void main() {
    fragColor = vec4(u_color, 1.0);
  }
`;function si(n){const s=n.getContext("webgl2",{antialias:!0});if(!s)throw new Error("WebGL2 not supported");return s}function nn(n,s,c){const u=n.createShader(s);if(!u)throw new Error("Failed to create shader");if(n.shaderSource(u,c),n.compileShader(u),!n.getShaderParameter(u,n.COMPILE_STATUS))throw new Error(n.getShaderInfoLog(u)||"Shader compilation failed");return u}function ci(n){const s=nn(n,n.VERTEX_SHADER,oi),c=nn(n,n.FRAGMENT_SHADER,ri),u=n.createProgram();if(!u)throw new Error("Failed to create program");if(n.attachShader(u,s),n.attachShader(u,c),n.linkProgram(u),!n.getProgramParameter(u,n.LINK_STATUS))throw new Error(n.getProgramInfoLog(u)||"Program linking failed");return{program:u,attribs:{position:n.getAttribLocation(u,"a_position"),color:n.getAttribLocation(u,"a_color"),color2:n.getAttribLocation(u,"a_color2"),color3:n.getAttribLocation(u,"a_color3"),color4:n.getAttribLocation(u,"a_color4"),colorCount:n.getAttribLocation(u,"a_colorCount"),uv:n.getAttribLocation(u,"a_uv"),seed:n.getAttribLocation(u,"a_seed")},uniforms:{resolution:n.getUniformLocation(u,"u_resolution"),pan:n.getUniformLocation(u,"u_pan"),zoom:n.getUniformLocation(u,"u_zoom")}}}function ui(n){const s=nn(n,n.VERTEX_SHADER,ii),c=nn(n,n.FRAGMENT_SHADER,ai),u=n.createProgram();if(!u)throw new Error("Failed to create program");if(n.attachShader(u,s),n.attachShader(u,c),n.linkProgram(u),!n.getProgramParameter(u,n.LINK_STATUS))throw new Error(n.getProgramInfoLog(u)||"Program linking failed");return{program:u,attribs:{position:n.getAttribLocation(u,"a_position")},uniforms:{resolution:n.getUniformLocation(u,"u_resolution"),pan:n.getUniformLocation(u,"u_pan"),zoom:n.getUniformLocation(u,"u_zoom"),color:n.getUniformLocation(u,"u_color")}}}function li(n){return Array.isArray(n)&&Array.isArray(n[0])}function xo(n,s,c=xe.OUTLINE_COLOR){const p=new Float32Array(n.length*6*19);let v=0;for(let k=0;k<n.length;k++){const T=n[k],I=s==null?void 0:s[k];let C;Array.isArray(I)&&I.length===0?C=[c]:li(I)?C=I.slice(0,4):C=[I||c];const $=C.length,F=$>1,j=F?xe.BLEED_PIXELS:0,Y=T.x-j,Z=T.y-j,ye=T.x+T.size-2+j,ue=T.y+T.size-2+j,oe=F?-j/(T.size-2):0,le=F?1+j/(T.size-2):1,ge=T.x,St=T.y;for(;C.length<4;)C.push([0,0,0]);const Fe=(nt,kt,ot,Ke)=>{p[v++]=nt,p[v++]=kt;for(let ze=0;ze<4;ze++)p[v++]=C[ze][0],p[v++]=C[ze][1],p[v++]=C[ze][2];p[v++]=$,p[v++]=ot,p[v++]=Ke,p[v++]=ge,p[v++]=St};Fe(Y,Z,oe,oe),Fe(ye,Z,le,oe),Fe(Y,ue,oe,le),Fe(Y,ue,oe,le),Fe(ye,Z,le,oe),Fe(ye,ue,le,le)}return p}function Eo(n,s){const c=n.createBuffer();if(!c)throw new Error("Failed to create buffer");return n.bindBuffer(n.ARRAY_BUFFER,c),n.bufferData(n.ARRAY_BUFFER,s,n.STATIC_DRAW),c}function fi(n,s={}){const c=s.thickness??2,u=s.color??xe.OUTLINE_COLOR,d=19,p=6,v=4,k=new Float32Array(v*p*d),T=n.x-c,I=n.y-c,C=n.x+n.size-2+c,$=n.y+n.size-2+c,F=n.x,j=n.y;let Y=0;const Z=(ue,oe)=>{k[Y++]=ue,k[Y++]=oe;for(let le=0;le<4;le++)k[Y++]=u[0],k[Y++]=u[1],k[Y++]=u[2];k[Y++]=1,k[Y++]=0,k[Y++]=0,k[Y++]=F,k[Y++]=j},ye=(ue,oe,le,ge)=>{Z(ue,oe),Z(le,oe),Z(ue,ge),Z(ue,ge),Z(le,oe),Z(le,ge)};return ye(T,I,C,I+c),ye(C-c,I,C,$),ye(T,$-c,C,$),ye(T,I,T+c,$),k}function di(n){const s=si(n),c={main:ci(s),outline:ui(s)};return{gl:s,programs:c,canvas:n}}function hi(n,s,c){const u=xo(s);return{buffer:Eo(n,u),outlineBuffer:null,hoverOutlineBuffer:null,verses:s,dpr:c}}function pi(n,s,c){const u=xo(s.verses,c);n.bindBuffer(n.ARRAY_BUFFER,s.buffer),n.bufferData(n.ARRAY_BUFFER,u,n.STATIC_DRAW)}function mi(n,s,c,u,d){const{gl:p,programs:v,canvas:k}=n,{buffer:T,verses:I,dpr:C}=s;p.viewport(0,0,k.width,k.height),p.clearColor(.1,.1,.1,1),p.clear(p.COLOR_BUFFER_BIT),p.useProgram(v.main.program),p.uniform2f(v.main.uniforms.resolution,k.width,k.height),p.uniform2f(v.main.uniforms.pan,c.x,c.y),p.uniform1f(v.main.uniforms.zoom,c.zoom*C),p.bindBuffer(p.ARRAY_BUFFER,T);const $=19*4;if(p.enableVertexAttribArray(v.main.attribs.position),p.vertexAttribPointer(v.main.attribs.position,2,p.FLOAT,!1,$,0),p.enableVertexAttribArray(v.main.attribs.color),p.vertexAttribPointer(v.main.attribs.color,3,p.FLOAT,!1,$,2*4),p.enableVertexAttribArray(v.main.attribs.color2),p.vertexAttribPointer(v.main.attribs.color2,3,p.FLOAT,!1,$,5*4),p.enableVertexAttribArray(v.main.attribs.color3),p.vertexAttribPointer(v.main.attribs.color3,3,p.FLOAT,!1,$,8*4),p.enableVertexAttribArray(v.main.attribs.color4),p.vertexAttribPointer(v.main.attribs.color4,3,p.FLOAT,!1,$,11*4),p.enableVertexAttribArray(v.main.attribs.colorCount),p.vertexAttribPointer(v.main.attribs.colorCount,1,p.FLOAT,!1,$,14*4),p.enableVertexAttribArray(v.main.attribs.uv),p.vertexAttribPointer(v.main.attribs.uv,2,p.FLOAT,!1,$,15*4),p.enableVertexAttribArray(v.main.attribs.seed),p.vertexAttribPointer(v.main.attribs.seed,2,p.FLOAT,!1,$,17*4),p.drawArrays(p.TRIANGLES,0,I.length*6),u&&!tn(u,d)){const F=d?xe.HOVER_WHILE_PINNED_OUTLINE_COLOR:xe.HOVER_OUTLINE_COLOR;s.hoverOutlineBuffer=Vn(n,s,u,F,s.hoverOutlineBuffer,c)}d&&(s.outlineBuffer=Vn(n,s,d,xe.PINNED_OUTLINE_COLOR,s.outlineBuffer,c)),window.bookLabels&&vn(window.bookLabels,{x:c.x,y:c.y},c.zoom)}function Vn(n,s,c,u,d,p){const{gl:v,programs:k,canvas:T}=n,{dpr:I}=s,C=fi({x:c.x,y:c.y,size:c.size},{thickness:2,color:u});let $=d;$?(v.bindBuffer(v.ARRAY_BUFFER,$),v.bufferData(v.ARRAY_BUFFER,C,v.STATIC_DRAW)):$=Eo(v,C),v.useProgram(k.outline.program),v.uniform2f(k.outline.uniforms.resolution,T.width,T.height),v.uniform2f(k.outline.uniforms.pan,p.x,p.y),v.uniform1f(k.outline.uniforms.zoom,p.zoom*I),v.uniform3f(k.outline.uniforms.color,...u),v.bindBuffer(v.ARRAY_BUFFER,$);const F=19*4;return v.enableVertexAttribArray(k.outline.attribs.position),v.vertexAttribPointer(k.outline.attribs.position,2,v.FLOAT,!1,F,0),v.drawArrays(v.TRIANGLES,0,24),$}const An=new Map;function Dt(n){An.set(n.id,n)}function gi(n){return An.get(n)}function vi(){return Array.from(An.values())}const So=[{unicode:"֒",codePoint:1426,name:"Segol",hebrewName:"סגול"},{unicode:"֓",codePoint:1427,name:"Shalshelet",hebrewName:"שלשלת"},{unicode:"֔",codePoint:1428,name:"Zaqef Qatan",hebrewName:"זקף קטן"},{unicode:"֕",codePoint:1429,name:"Zaqef Gadol",hebrewName:"זקף גדול"},{unicode:"֖",codePoint:1430,name:"Tipcha",hebrewName:"טפחא"},{unicode:"֗",codePoint:1431,name:"Revia",hebrewName:"רביע"},{unicode:"֘",codePoint:1432,name:"Zarqa",hebrewName:"זרקא"},{unicode:"֙",codePoint:1433,name:"Pashta",hebrewName:"פשטא"},{unicode:"֚",codePoint:1434,name:"Yetiv",hebrewName:"יתיב"},{unicode:"֛",codePoint:1435,name:"Tevir",hebrewName:"תביר"},{unicode:"֜",codePoint:1436,name:"Geresh",hebrewName:"גרש"},{unicode:"֝",codePoint:1437,name:"Geresh Muqdam",hebrewName:"גרש מוקדם"},{unicode:"֞",codePoint:1438,name:"Gershayim",hebrewName:"גרשיים"},{unicode:"֟",codePoint:1439,name:"Karnei Parah",hebrewName:"קרני פרה"},{unicode:"֠",codePoint:1440,name:"Telisha Gedola",hebrewName:"תלישא גדולה"},{unicode:"֡",codePoint:1441,name:"Pazer",hebrewName:"פזר"},{unicode:"֣",codePoint:1443,name:"Munach",hebrewName:"מונח"},{unicode:"֤",codePoint:1444,name:"Mahapakh",hebrewName:"מהפך"},{unicode:"֥",codePoint:1445,name:"Merkha",hebrewName:"מרכא"},{unicode:"֦",codePoint:1446,name:"Merkha Kefula",hebrewName:"מרכא כפולה"},{unicode:"֧",codePoint:1447,name:"Darga",hebrewName:"דרגא"},{unicode:"֨",codePoint:1448,name:"Qadma",hebrewName:"קדמא"},{unicode:"֩",codePoint:1449,name:"Telisha Qetana",hebrewName:"תלישא קטנה"},{unicode:"֪",codePoint:1450,name:"Yerah Ben Yomo",hebrewName:"ירח בן יומו"},{unicode:"֫",codePoint:1451,name:"Ole",hebrewName:"עולה"},{unicode:"֬",codePoint:1452,name:"Iluy",hebrewName:"אילוי"},{unicode:"֭",codePoint:1453,name:"Dehi",hebrewName:"דחי"},{unicode:"֮",codePoint:1454,name:"Zinor",hebrewName:"זינור"},{unicode:"֑",codePoint:1425,name:"Etnachta",hebrewName:"אתנחתא"},{unicode:"֢",codePoint:1442,name:"Atnah Hafukh",hebrewName:"אתנח הפוך"},{unicode:"֯",codePoint:1455,name:"Masora Circle",hebrewName:"עיגול מסורה"}];new Map(So.map(n=>[n.unicode,n]));const Gn={RARE:50,UNCOMMON:500};function jt(n){return n<Gn.RARE?"rare":n<Gn.UNCOMMON?"uncommon":"common"}function yi(n){const s=[];for(const c of n){const u=c.codePointAt(0);u&&u>=1425&&u<=1455&&s.push(c)}return s}function bi(n){const s=new Map,c=yi(n);for(const u of c)s.set(u,(s.get(u)||0)+1);return s}function wi(n){const s=new Map;for(const c of So)s.set(c.unicode,{unicode:c.unicode,name:c.name,hebrewName:c.hebrewName,totalCount:0,verses:[]});for(const[c,u]of Object.entries(n))for(const[d,p]of Object.entries(u)){const v=parseInt(d,10);for(const[k,T]of Object.entries(p)){const I=parseInt(k,10),C=bi(T.he);for(const[$,F]of C){const j=s.get($);j&&(j.totalCount+=F,j.verses.push({book:c,chapter:v,verse:I,count:F}))}}}return s}function xi(n){return Array.from(n.values()).filter(s=>s.totalCount>0).sort((s,c)=>s.totalCount-c.totalCount)}let qn=new Map,on=[],Ee=null,ft=null,Gt=new Map,Ot=1,rn="common";const Ei=[1,.84,0];function un(){if(Gt.clear(),!!Ee){rn=jt(Ee.totalCount);for(const n of Ee.verses){const s=$e(n.book,n.chapter,n.verse);Gt.set(s,n.count)}Ot=1;for(const n of Ee.verses)n.count>Ot&&(Ot=n.count)}}const Si=[{t:0,color:[.4,.2,.6]},{t:1,color:[.9,.4,.95]}],ki=[{t:0,color:[.2,.1,.3]},{t:.33,color:[.4,.2,.5]},{t:.66,color:[.7,.3,.7]},{t:1,color:[.95,.6,.9]}];function Ci(n){if(!Ee)return null;Gt.size===0&&un();const s=$e(n.book,n.chapter,n.verse),c=Gt.get(s)||0;return rn==="rare"?c>0?Ei:xe.RARE_NO_MATCH_COLOR:rn==="uncommon"?c===0?[.25,.25,.28]:bn(c,Ot,Si):c===0?[.25,.23,.28]:bn(c,Ot,ki,{useLog:!0})}function Ti(n){n.innerHTML=`
    <div class="trop-controls">
      <label style="margin-bottom: 8px;">Select Trop Mark</label>
      <div class="trop-chart"></div>
      <div class="trop-info"></div>
    </div>
  `;const s=n.querySelector(".trop-chart"),c=n.querySelector(".trop-info");let u=null;for(const d of on){const p=document.createElement("button");p.textContent="ב"+d.unicode,p.title=`${d.name} (${d.hebrewName})`;const v=jt(d.totalCount);if(v==="rare"&&p.classList.add("rare"),p.addEventListener("mouseenter",()=>{const k=v==="rare"?"Rare":v==="uncommon"?"Uncommon":"Common";c.textContent=`${d.name} (${d.hebrewName}) · ${d.totalCount.toLocaleString()} occurrences · ${k}`}),p.addEventListener("mouseleave",()=>{if(!u)c.textContent="";else{const k=on.find(T=>T.unicode===(u==null?void 0:u.dataset.unicode));if(k){const T=jt(k.totalCount),I=T==="rare"?"Rare":T==="uncommon"?"Uncommon":"Common";c.textContent=`${k.name} (${k.hebrewName}) · ${k.totalCount.toLocaleString()} · ${I}`}}}),p.addEventListener("click",()=>{u===p?(p.classList.remove("selected"),u=null,Ee=null,c.textContent=""):(u&&u.classList.remove("selected"),p.classList.add("selected"),u=p,Ee=d),un(),ft==null||ft()}),p.dataset.unicode=d.unicode,s.appendChild(p),Ee&&d.unicode===Ee.unicode){p.classList.add("selected"),u=p;const k=jt(d.totalCount),T=k==="rare"?"Rare":k==="uncommon"?"Uncommon":"Common";c.textContent=`${d.name} (${d.hebrewName}) · ${d.totalCount.toLocaleString()} · ${T}`}}}const Ai={id:"trop",name:"Cantillation (Trop)",async init(){},destroy(){ft=null,Gt.clear(),Ot=1,rn="common"},onUpdate(n){ft=n},getVerseColor(n){return Ci(n)},renderControls(n){Ti(n)},renderLegend(n){if(!Ee){n.innerHTML='<div style="color: #666; font-size: 11px;">Select a trop mark above</div>';return}jt(Ee.totalCount)==="rare"?n.innerHTML=`
        <div class="legend-row"><span class="swatch" style="background: rgb(255, 214, 0)"></span><span>Contains ${Ee.name}</span></div>
        <div class="legend-row"><span class="swatch" style="background: rgb(64, 64, 64)"></span><span>Does not contain</span></div>
      `:n.innerHTML=`
        <div class="legend-gradient" style="background: linear-gradient(to right, #3f3b47, #5a3f7a, #a060a0, #e090c0);"></div>
        <div style="display: flex; justify-content: space-between; font-size: 10px; color: #888;">
          <span>0</span>
          <span>Count</span>
          <span>Max</span>
        </div>
      `},getHoverInfo(n){if(!Ee)return null;const s=Ee.verses.find(c=>c.book===n.book&&c.chapter===n.chapter&&c.verse===n.verse);return s?`${Ee.name} ×${s.count}`:null},getUrlParams(){return Ee?{trop:Ee.name.toLowerCase().replace(/\s+/g,"-")}:{}},applyUrlParams(n){const s=n.get("trop");if(s){const c=on.find(u=>u.name.toLowerCase().replace(/\s+/g,"-")===s);c&&(Ee=c,un(),ft==null||ft())}},highlightVerseText(n,s){return s!=="he"||!Ee?n:Pi(n,Ee.unicode)}};function Oi(n){qn=wi(n.verseTexts),on=xi(qn),Ee=null,un()}function Pi(n,s){const c=[];let u=0;for(;u<n.length;){const d=n[u];if(d===s)if(c.length>0){const p=[];for(;c.length>0;){const k=c[c.length-1].codePointAt(0)||0;if(k>=1425&&k<=1479)p.unshift(c.pop());else{p.unshift(c.pop());break}}p.push(d),c.push(`<mark class="trop-highlight">${p.join("")}</mark>`)}else c.push(`<mark class="trop-highlight">${d}</mark>`);else c.push(d);u++}return c.join("")}var Ii=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mi(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ko={exports:{}};/*!
 * 
 *   simple-keyboard v3.8.93
 *   https://github.com/hodgef/simple-keyboard
 *
 *   Copyright (c) Francisco Hodge (https://github.com/hodgef) and project contributors.
 *
 *   This source code is licensed under the MIT license found in the
 *   LICENSE file in the root directory of this source tree.
 *
 */(function(n,s){(function(c,u){n.exports=u()})(Ii,function(){return function(){var c={34:function(a,f,e){var t=e(4901);a.exports=function(o){return typeof o=="object"?o!==null:t(o)}},81:function(a,f,e){var t=e(9565),o=e(9306),r=e(8551),i=e(6823),l=e(851),h=TypeError;a.exports=function(m,g){var y=arguments.length<2?l(m):g;if(o(y))return r(t(y,m));throw new h(i(m)+" is not iterable")}},235:function(a,f,e){var t=e(9213).forEach,o=e(4598)("forEach");a.exports=o?[].forEach:function(r){return t(this,r,arguments.length>1?arguments[1]:void 0)}},283:function(a,f,e){var t=e(9504),o=e(9039),r=e(4901),i=e(9297),l=e(3724),h=e(350).CONFIGURABLE,m=e(3706),g=e(1181),y=g.enforce,E=g.get,w=String,b=Object.defineProperty,S=t("".slice),x=t("".replace),O=t([].join),A=l&&!o(function(){return b(function(){},"length",{value:8}).length!==8}),P=String(String).split("String"),N=a.exports=function(M,B,L){S(w(B),0,7)==="Symbol("&&(B="["+x(w(B),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),L&&L.getter&&(B="get "+B),L&&L.setter&&(B="set "+B),(!i(M,"name")||h&&M.name!==B)&&(l?b(M,"name",{value:B,configurable:!0}):M.name=B),A&&L&&i(L,"arity")&&M.length!==L.arity&&b(M,"length",{value:L.arity});try{L&&i(L,"constructor")&&L.constructor?l&&b(M,"prototype",{writable:!1}):M.prototype&&(M.prototype=void 0)}catch{}var R=y(M);return i(R,"source")||(R.source=O(P,typeof B=="string"?B:"")),M};Function.prototype.toString=N(function(){return r(this)&&E(this).source||m(this)},"toString")},298:function(a,f,e){var t=e(2195),o=e(5397),r=e(8480).f,i=e(7680),l=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];a.exports.f=function(h){return l&&t(h)==="Window"?function(m){try{return r(m)}catch{return i(l)}}(h):r(o(h))}},350:function(a,f,e){var t=e(3724),o=e(9297),r=Function.prototype,i=t&&Object.getOwnPropertyDescriptor,l=o(r,"name"),h=l&&(function(){}).name==="something",m=l&&(!t||t&&i(r,"name").configurable);a.exports={EXISTS:l,PROPER:h,CONFIGURABLE:m}},397:function(a,f,e){var t=e(7751);a.exports=t("document","documentElement")},421:function(a){a.exports={}},511:function(a,f,e){var t=e(9167),o=e(9297),r=e(1951),i=e(4913).f;a.exports=function(l){var h=t.Symbol||(t.Symbol={});o(h,l)||i(h,l,{value:r.f(l)})}},566:function(a,f,e){var t=e(9504),o=e(9306),r=e(34),i=e(9297),l=e(7680),h=e(616),m=Function,g=t([].concat),y=t([].join),E={};a.exports=h?m.bind:function(w){var b=o(this),S=b.prototype,x=l(arguments,1),O=function(){var A=g(x,l(arguments));return this instanceof O?function(P,N,M){if(!i(E,N)){for(var B=[],L=0;L<N;L++)B[L]="a["+L+"]";E[N]=m("C,a","return new C("+y(B,",")+")")}return E[N](P,M)}(b,A.length,A):b.apply(w,A)};return r(S)&&(O.prototype=S),O}},597:function(a,f,e){var t=e(9039),o=e(8227),r=e(9519),i=o("species");a.exports=function(l){return r>=51||!t(function(){var h=[];return(h.constructor={})[i]=function(){return{foo:1}},h[l](Boolean).foo!==1})}},616:function(a,f,e){var t=e(9039);a.exports=!t(function(){var o=(function(){}).bind();return typeof o!="function"||o.hasOwnProperty("prototype")})},655:function(a,f,e){var t=e(6955),o=String;a.exports=function(r){if(t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return o(r)}},687:function(a,f,e){var t=e(4913).f,o=e(9297),r=e(8227)("toStringTag");a.exports=function(i,l,h){i&&!h&&(i=i.prototype),i&&!o(i,r)&&t(i,r,{configurable:!0,value:l})}},706:function(a,f,e){var t=e(350).PROPER,o=e(9039),r=e(7452);a.exports=function(i){return o(function(){return!!r[i]()||"​᠎"[i]()!=="​᠎"||t&&r[i].name!==i})}},739:function(a,f,e){var t=e(6518),o=e(9039),r=e(8981),i=e(2777);t({target:"Date",proto:!0,arity:1,forced:o(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1})},{toJSON:function(l){var h=r(this),m=i(h,"number");return typeof m!="number"||isFinite(m)?h.toISOString():null}})},741:function(a){var f=Math.ceil,e=Math.floor;a.exports=Math.trunc||function(t){var o=+t;return(o>0?e:f)(o)}},744:function(a,f,e){var t=e(9565),o=e(9504),r=e(9228),i=e(8551),l=e(34),h=e(7750),m=e(2293),g=e(7829),y=e(8014),E=e(655),w=e(5966),b=e(6682),S=e(8429),x=e(9039),O=S.UNSUPPORTED_Y,A=Math.min,P=o([].push),N=o("".slice),M=!x(function(){var L=/(?:)/,R=L.exec;L.exec=function(){return R.apply(this,arguments)};var H="ab".split(L);return H.length!==2||H[0]!=="a"||H[1]!=="b"}),B="abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length;r("split",function(L,R,H){var U="0".split(void 0,0).length?function(_,ee){return _===void 0&&ee===0?[]:t(R,this,_,ee)}:R;return[function(_,ee){var V=h(this),G=l(_)?w(_,L):void 0;return G?t(G,_,V,ee):t(U,E(V),_,ee)},function(_,ee){var V=i(this),G=E(_);if(!B){var pe=H(U,V,G,ee,U!==R);if(pe.done)return pe.value}var fe=m(V,RegExp),W=V.unicode,ne=(V.ignoreCase?"i":"")+(V.multiline?"m":"")+(V.unicode?"u":"")+(O?"g":"y"),Q=new fe(O?"^(?:"+V.source+")":V,ne),X=ee===void 0?4294967295:ee>>>0;if(X===0)return[];if(G.length===0)return b(Q,G)===null?[G]:[];for(var te=0,re=0,K=[];re<G.length;){Q.lastIndex=O?0:re;var q,z=b(Q,O?N(G,re):G);if(z===null||(q=A(y(Q.lastIndex+(O?re:0)),G.length))===te)re=g(G,re,W);else{if(P(K,N(G,te,re)),K.length===X)return K;for(var J=1;J<=z.length-1;J++)if(P(K,z[J]),K.length===X)return K;re=te=q}}return P(K,N(G,te)),K}]},B||!M,O)},757:function(a,f,e){var t=e(7751),o=e(4901),r=e(1625),i=e(7040),l=Object;a.exports=i?function(h){return typeof h=="symbol"}:function(h){var m=t("Symbol");return o(m)&&r(m.prototype,l(h))}},788:function(a,f,e){var t=e(34),o=e(2195),r=e(8227)("match");a.exports=function(i){var l;return t(i)&&((l=i[r])!==void 0?!!l:o(i)==="RegExp")}},825:function(a,f,e){var t=e(6518),o=e(7751),r=e(8745),i=e(566),l=e(5548),h=e(8551),m=e(34),g=e(2360),y=e(9039),E=o("Reflect","construct"),w=Object.prototype,b=[].push,S=y(function(){function A(){}return!(E(function(){},[],A)instanceof A)}),x=!y(function(){E(function(){})}),O=S||x;t({target:"Reflect",stat:!0,forced:O,sham:O},{construct:function(A,P){l(A),h(P);var N=arguments.length<3?A:l(arguments[2]);if(x&&!S)return E(A,P,N);if(A===N){switch(P.length){case 0:return new A;case 1:return new A(P[0]);case 2:return new A(P[0],P[1]);case 3:return new A(P[0],P[1],P[2]);case 4:return new A(P[0],P[1],P[2],P[3])}var M=[null];return r(b,M,P),new(r(i,A,M))}var B=N.prototype,L=g(m(B)?B:w),R=r(A,L,P);return m(R)?R:L}})},851:function(a,f,e){var t=e(6955),o=e(5966),r=e(4117),i=e(6269),l=e(8227)("iterator");a.exports=function(h){if(!r(h))return o(h,l)||o(h,"@@iterator")||i[t(h)]}},926:function(a,f,e){var t=e(9306),o=e(8981),r=e(7055),i=e(6198),l=TypeError,h="Reduce of empty array with no initial value",m=function(g){return function(y,E,w,b){var S=o(y),x=r(S),O=i(S);if(t(E),O===0&&w<2)throw new l(h);var A=g?O-1:0,P=g?-1:1;if(w<2)for(;;){if(A in x){b=x[A],A+=P;break}if(A+=P,g?A<0:O<=A)throw new l(h)}for(;g?A>=0:O>A;A+=P)A in x&&(b=E(b,x[A],A,S));return b}};a.exports={left:m(!1),right:m(!0)}},1034:function(a,f,e){var t=e(9565),o=e(9297),r=e(1625),i=e(5213),l=e(7979),h=RegExp.prototype;a.exports=i.correct?function(m){return m.flags}:function(m){return i.correct||!r(h,m)||o(m,"flags")?m.flags:t(l,m)}},1056:function(a,f,e){var t=e(4913).f;a.exports=function(o,r,i){i in o||t(o,i,{configurable:!0,get:function(){return r[i]},set:function(l){r[i]=l}})}},1072:function(a,f,e){var t=e(1828),o=e(8727);a.exports=Object.keys||function(r){return t(r,o)}},1088:function(a,f,e){var t=e(6518),o=e(9565),r=e(6395),i=e(350),l=e(4901),h=e(3994),m=e(2787),g=e(2967),y=e(687),E=e(6699),w=e(6840),b=e(8227),S=e(6269),x=e(7657),O=i.PROPER,A=i.CONFIGURABLE,P=x.IteratorPrototype,N=x.BUGGY_SAFARI_ITERATORS,M=b("iterator"),B="keys",L="values",R="entries",H=function(){return this};a.exports=function(U,_,ee,V,G,pe,fe){h(ee,_,V);var W,ne,Q,X=function(me){if(me===G&&z)return z;if(!N&&me&&me in K)return K[me];switch(me){case B:case L:case R:return function(){return new ee(this,me)}}return function(){return new ee(this)}},te=_+" Iterator",re=!1,K=U.prototype,q=K[M]||K["@@iterator"]||G&&K[G],z=!N&&q||X(G),J=_==="Array"&&K.entries||q;if(J&&(W=m(J.call(new U)))!==Object.prototype&&W.next&&(r||m(W)===P||(g?g(W,P):l(W[M])||w(W,M,H)),y(W,te,!0,!0),r&&(S[te]=H)),O&&G===L&&q&&q.name!==L&&(!r&&A?E(K,"name",L):(re=!0,z=function(){return o(q,this)})),G)if(ne={values:X(L),keys:pe?z:X(B),entries:X(R)},fe)for(Q in ne)(N||re||!(Q in K))&&w(K,Q,ne[Q]);else t({target:_,proto:!0,forced:N||re},ne);return r&&!fe||K[M]===z||w(K,M,z,{name:G}),S[_]=z,ne}},1181:function(a,f,e){var t,o,r,i=e(8622),l=e(4576),h=e(34),m=e(6699),g=e(9297),y=e(7629),E=e(6119),w=e(421),b="Object already initialized",S=l.TypeError,x=l.WeakMap;if(i||y.state){var O=y.state||(y.state=new x);O.get=O.get,O.has=O.has,O.set=O.set,t=function(P,N){if(O.has(P))throw new S(b);return N.facade=P,O.set(P,N),N},o=function(P){return O.get(P)||{}},r=function(P){return O.has(P)}}else{var A=E("state");w[A]=!0,t=function(P,N){if(g(P,A))throw new S(b);return N.facade=P,m(P,A,N),N},o=function(P){return g(P,A)?P[A]:{}},r=function(P){return g(P,A)}}a.exports={set:t,get:o,has:r,enforce:function(P){return r(P)?o(P):t(P,{})},getterFor:function(P){return function(N){var M;if(!h(N)||(M=o(N)).type!==P)throw new S("Incompatible receiver, "+P+" required");return M}}}},1240:function(a,f,e){var t=e(9504);a.exports=t(1.1.valueOf)},1278:function(a,f,e){var t=e(6518),o=e(3724),r=e(5031),i=e(5397),l=e(7347),h=e(4659);t({target:"Object",stat:!0,sham:!o},{getOwnPropertyDescriptors:function(m){for(var g,y,E=i(m),w=l.f,b=r(E),S={},x=0;b.length>x;)(y=w(E,g=b[x++]))!==void 0&&h(S,g,y);return S}})},1291:function(a,f,e){var t=e(741);a.exports=function(o){var r=+o;return r!=r||r===0?0:t(r)}},1296:function(a,f,e){var t=e(4495);a.exports=t&&!!Symbol.for&&!!Symbol.keyFor},1436:function(a,f,e){var t=e(8227)("match");a.exports=function(o){var r=/./;try{"/./"[o](r)}catch{try{return r[t]=!1,"/./"[o](r)}catch{}}return!1}},1469:function(a,f,e){var t=e(7433);a.exports=function(o,r){return new(t(o))(r===0?0:r)}},1480:function(a,f,e){var t=e(6518),o=e(9039),r=e(298).f;t({target:"Object",stat:!0,forced:o(function(){return!Object.getOwnPropertyNames(1)})},{getOwnPropertyNames:r})},1510:function(a,f,e){var t=e(6518),o=e(7751),r=e(9297),i=e(655),l=e(5745),h=e(1296),m=l("string-to-symbol-registry"),g=l("symbol-to-string-registry");t({target:"Symbol",stat:!0,forced:!h},{for:function(y){var E=i(y);if(r(m,E))return m[E];var w=o("Symbol")(E);return m[E]=w,g[w]=E,w}})},1625:function(a,f,e){var t=e(9504);a.exports=t({}.isPrototypeOf)},1699:function(a,f,e){var t=e(6518),o=e(9504),r=e(5749),i=e(7750),l=e(655),h=e(1436),m=o("".indexOf);t({target:"String",proto:!0,forced:!h("includes")},{includes:function(g){return!!~m(l(i(this)),l(r(g)),arguments.length>1?arguments[1]:void 0)}})},1761:function(a,f,e){var t=e(9565),o=e(9504),r=e(9228),i=e(8551),l=e(34),h=e(8014),m=e(655),g=e(7750),y=e(5966),E=e(7829),w=e(1034),b=e(6682),S=o("".indexOf);r("match",function(x,O,A){return[function(P){var N=g(this),M=l(P)?y(P,x):void 0;return M?t(M,P,N):new RegExp(P)[x](m(N))},function(P){var N=i(this),M=m(P),B=A(O,N,M);if(B.done)return B.value;var L=m(w(N));if(S(L,"g")===-1)return b(N,M);var R=S(L,"u")!==-1;N.lastIndex=0;for(var H,U=[],_=0;(H=b(N,M))!==null;){var ee=m(H[0]);U[_]=ee,ee===""&&(N.lastIndex=E(M,h(N.lastIndex),R)),_++}return _===0?null:U}]})},1828:function(a,f,e){var t=e(9504),o=e(9297),r=e(5397),i=e(9617).indexOf,l=e(421),h=t([].push);a.exports=function(m,g){var y,E=r(m),w=0,b=[];for(y in E)!o(l,y)&&o(E,y)&&h(b,y);for(;g.length>w;)o(E,y=g[w++])&&(~i(b,y)||h(b,y));return b}},1951:function(a,f,e){var t=e(8227);f.f=t},2008:function(a,f,e){var t=e(6518),o=e(9213).filter;t({target:"Array",proto:!0,forced:!e(597)("filter")},{filter:function(r){return o(this,r,arguments.length>1?arguments[1]:void 0)}})},2010:function(a,f,e){var t=e(3724),o=e(350).EXISTS,r=e(9504),i=e(2106),l=Function.prototype,h=r(l.toString),m=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,g=r(m.exec);t&&!o&&i(l,"name",{configurable:!0,get:function(){try{return g(m,h(this))[1]}catch{return""}}})},2062:function(a,f,e){var t=e(6518),o=e(9213).map;t({target:"Array",proto:!0,forced:!e(597)("map")},{map:function(r){return o(this,r,arguments.length>1?arguments[1]:void 0)}})},2087:function(a,f,e){var t=e(34),o=Math.floor;a.exports=Number.isInteger||function(r){return!t(r)&&isFinite(r)&&o(r)===r}},2106:function(a,f,e){var t=e(283),o=e(4913);a.exports=function(r,i,l){return l.get&&t(l.get,i,{getter:!0}),l.set&&t(l.set,i,{setter:!0}),o.f(r,i,l)}},2140:function(a,f,e){var t={};t[e(8227)("toStringTag")]="z",a.exports=String(t)==="[object z]"},2195:function(a,f,e){var t=e(9504),o=t({}.toString),r=t("".slice);a.exports=function(i){return r(o(i),8,-1)}},2211:function(a,f,e){var t=e(9039);a.exports=!t(function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype})},2259:function(a,f,e){e(511)("iterator")},2293:function(a,f,e){var t=e(8551),o=e(5548),r=e(4117),i=e(8227)("species");a.exports=function(l,h){var m,g=t(l).constructor;return g===void 0||r(m=t(g)[i])?h:o(m)}},2360:function(a,f,e){var t,o=e(8551),r=e(6801),i=e(8727),l=e(421),h=e(397),m=e(4055),g=e(6119),y="prototype",E="script",w=g("IE_PROTO"),b=function(){},S=function(A){return"<"+E+">"+A+"</"+E+">"},x=function(A){A.write(S("")),A.close();var P=A.parentWindow.Object;return A=null,P},O=function(){try{t=new ActiveXObject("htmlfile")}catch{}var A,P,N;O=typeof document<"u"?document.domain&&t?x(t):(P=m("iframe"),N="java"+E+":",P.style.display="none",h.appendChild(P),P.src=String(N),(A=P.contentWindow.document).open(),A.write(S("document.F=Object")),A.close(),A.F):x(t);for(var M=i.length;M--;)delete O[y][i[M]];return O()};l[w]=!0,a.exports=Object.create||function(A,P){var N;return A!==null?(b[y]=o(A),N=new b,b[y]=null,N[w]=A):N=O(),P===void 0?N:r.f(N,P)}},2478:function(a,f,e){var t=e(9504),o=e(8981),r=Math.floor,i=t("".charAt),l=t("".replace),h=t("".slice),m=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,g=/\$([$&'`]|\d{1,2})/g;a.exports=function(y,E,w,b,S,x){var O=w+y.length,A=b.length,P=g;return S!==void 0&&(S=o(S),P=m),l(x,P,function(N,M){var B;switch(i(M,0)){case"$":return"$";case"&":return y;case"`":return h(E,0,w);case"'":return h(E,O);case"<":B=S[h(M,1,-1)];break;default:var L=+M;if(L===0)return N;if(L>A){var R=r(L/10);return R===0?N:R<=A?b[R-1]===void 0?i(M,1):b[R-1]+i(M,1):N}B=b[L-1]}return B===void 0?"":B})}},2529:function(a){a.exports=function(f,e){return{value:f,done:e}}},2551:function(a,f,e){var t=e(6395),o=e(4576),r=e(9039),i=e(3607);a.exports=t||!r(function(){if(!(i&&i<535)){var l=Math.random();__defineSetter__.call(null,l,function(){}),delete o[l]}})},2637:function(a,f,e){e(6518)({target:"Number",stat:!0},{isInteger:e(2087)})},2675:function(a,f,e){e(6761),e(1510),e(7812),e(3110),e(9773)},2712:function(a,f,e){var t=e(6518),o=e(926).left,r=e(4598),i=e(9519);t({target:"Array",proto:!0,forced:!e(6193)&&i>79&&i<83||!r("reduce")},{reduce:function(l){var h=arguments.length;return o(this,l,h,h>1?arguments[1]:void 0)}})},2762:function(a,f,e){var t=e(6518),o=e(3802).trim;t({target:"String",proto:!0,forced:e(706)("trim")},{trim:function(){return o(this)}})},2777:function(a,f,e){var t=e(9565),o=e(34),r=e(757),i=e(5966),l=e(4270),h=e(8227),m=TypeError,g=h("toPrimitive");a.exports=function(y,E){if(!o(y)||r(y))return y;var w,b=i(y,g);if(b){if(E===void 0&&(E="default"),w=t(b,y,E),!o(w)||r(w))return w;throw new m("Can't convert object to primitive value")}return E===void 0&&(E="number"),l(y,E)}},2787:function(a,f,e){var t=e(9297),o=e(4901),r=e(8981),i=e(6119),l=e(2211),h=i("IE_PROTO"),m=Object,g=m.prototype;a.exports=l?m.getPrototypeOf:function(y){var E=r(y);if(t(E,h))return E[h];var w=E.constructor;return o(w)&&E instanceof w?w.prototype:E instanceof m?g:null}},2796:function(a,f,e){var t=e(9039),o=e(4901),r=/#|\.prototype\./,i=function(y,E){var w=h[l(y)];return w===g||w!==m&&(o(E)?t(E):!!E)},l=i.normalize=function(y){return String(y).replace(r,".").toLowerCase()},h=i.data={},m=i.NATIVE="N",g=i.POLYFILL="P";a.exports=i},2839:function(a,f,e){var t=e(4576).navigator,o=t&&t.userAgent;a.exports=o?String(o):""},2892:function(a,f,e){var t=e(6518),o=e(6395),r=e(3724),i=e(4576),l=e(9167),h=e(9504),m=e(2796),g=e(9297),y=e(3167),E=e(1625),w=e(757),b=e(2777),S=e(9039),x=e(8480).f,O=e(7347).f,A=e(4913).f,P=e(1240),N=e(3802).trim,M="Number",B=i[M],L=l[M],R=B.prototype,H=i.TypeError,U=h("".slice),_=h("".charCodeAt),ee=function(fe){var W,ne,Q,X,te,re,K,q,z=b(fe,"number");if(w(z))throw new H("Cannot convert a Symbol value to a number");if(typeof z=="string"&&z.length>2){if(z=N(z),(W=_(z,0))===43||W===45){if((ne=_(z,2))===88||ne===120)return NaN}else if(W===48){switch(_(z,1)){case 66:case 98:Q=2,X=49;break;case 79:case 111:Q=8,X=55;break;default:return+z}for(re=(te=U(z,2)).length,K=0;K<re;K++)if((q=_(te,K))<48||q>X)return NaN;return parseInt(te,Q)}}return+z},V=m(M,!B(" 0o1")||!B("0b1")||B("+0x1")),G=function(fe){var W,ne=arguments.length<1?0:B(function(Q){var X=b(Q,"number");return typeof X=="bigint"?X:ee(X)}(fe));return E(R,W=this)&&S(function(){P(W)})?y(Object(ne),this,G):ne};G.prototype=R,V&&!o&&(R.constructor=G),t({global:!0,constructor:!0,wrap:!0,forced:V},{Number:G});var pe=function(fe,W){for(var ne,Q=r?x(W):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),X=0;Q.length>X;X++)g(W,ne=Q[X])&&!g(fe,ne)&&A(fe,ne,O(W,ne))};o&&L&&pe(l[M],L),(V||o)&&pe(l[M],B)},2953:function(a,f,e){var t=e(4576),o=e(7400),r=e(9296),i=e(3792),l=e(6699),h=e(687),m=e(8227)("iterator"),g=i.values,y=function(w,b){if(w){if(w[m]!==g)try{l(w,m,g)}catch{w[m]=g}if(h(w,b,!0),o[b]){for(var S in i)if(w[S]!==i[S])try{l(w,S,i[S])}catch{w[S]=i[S]}}}};for(var E in o)y(t[E]&&t[E].prototype,E);y(r,"DOMTokenList")},2967:function(a,f,e){var t=e(6706),o=e(34),r=e(7750),i=e(3506);a.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var l,h=!1,m={};try{(l=t(Object.prototype,"__proto__","set"))(m,[]),h=m instanceof Array}catch{}return function(g,y){return r(g),i(y),o(g)&&(h?l(g,y):g.__proto__=y),g}}():void 0)},3110:function(a,f,e){var t=e(6518),o=e(7751),r=e(8745),i=e(9565),l=e(9504),h=e(9039),m=e(4376),g=e(4901),y=e(5810),E=e(757),w=e(2195),b=e(655),S=e(7680),x=e(8235),O=e(3392),A=e(4495),P=e(7819),N=String,M=o("JSON","stringify"),B=l(/./.exec),L=l("".charAt),R=l("".charCodeAt),H=l("".replace),U=l("".slice),_=l([].push),ee=l(1.1.toString),V=/[\uD800-\uDFFF]/g,G=/^[\uD800-\uDBFF]$/,pe=/^[\uDC00-\uDFFF]$/,fe=O(),W=fe.length,ne=!A||h(function(){var K=o("Symbol")("stringify detection");return M([K])!=="[null]"||M({a:K})!=="{}"||M(Object(K))!=="{}"}),Q=h(function(){return M("\uDF06\uD834")!=='"\\udf06\\ud834"'||M("\uDEAD")!=='"\\udead"'}),X=ne?function(K,q){var z=S(arguments),J=re(q);if(g(J)||K!==void 0&&!E(K))return z[1]=function(me,ie){if(g(J)&&(ie=i(J,this,N(me),ie)),!E(ie))return ie},r(M,null,z)}:M,te=function(K,q,z){var J=L(z,q-1),me=L(z,q+1);return B(G,K)&&!B(pe,me)||B(pe,K)&&!B(G,J)?"\\u"+ee(R(K,0),16):K},re=function(K){if(g(K))return K;if(m(K)){for(var q=K.length,z=[],J=0;J<q;J++){var me=K[J];typeof me=="string"?_(z,me):typeof me!="number"&&w(me)!=="Number"&&w(me)!=="String"||_(z,b(me))}var ie=z.length,se=!0;return function(ke,we){if(se)return se=!1,we;if(m(this))return we;for(var Ne=0;Ne<ie;Ne++)if(z[Ne]===ke)return we}}};M&&t({target:"JSON",stat:!0,arity:3,forced:ne||Q||!P},{stringify:function(K,q,z){var J=re(q),me=[],ie=X(K,function(je,Ie){var Ge=g(J)?i(J,this,N(je),Ie):Ie;return!P&&y(Ge)?fe+(_(me,Ge.rawJSON)-1):Ge},z);if(typeof ie!="string"||(Q&&(ie=H(ie,V,te)),P))return ie;for(var se="",ke=ie.length,we=0;we<ke;we++){var Ne=L(ie,we);if(Ne==='"'){var We=x(ie,++we).end-1,Te=U(ie,we,We);se+=U(Te,0,W)===fe?me[U(Te,W)]:'"'+Te+'"',we=We}else se+=Ne}return se}})},3167:function(a,f,e){var t=e(4901),o=e(34),r=e(2967);a.exports=function(i,l,h){var m,g;return r&&t(m=l.constructor)&&m!==h&&o(g=m.prototype)&&g!==h.prototype&&r(i,g),i}},3179:function(a,f,e){var t=e(2140),o=e(6955);a.exports=t?{}.toString:function(){return"[object "+o(this)+"]"}},3392:function(a,f,e){var t=e(9504),o=0,r=Math.random(),i=t(1.1.toString);a.exports=function(l){return"Symbol("+(l===void 0?"":l)+")_"+i(++o+r,36)}},3418:function(a,f,e){var t=e(6518),o=e(7916);t({target:"Array",stat:!0,forced:!e(4428)(function(r){Array.from(r)})},{from:o})},3500:function(a,f,e){var t=e(4576),o=e(7400),r=e(9296),i=e(235),l=e(6699),h=function(g){if(g&&g.forEach!==i)try{l(g,"forEach",i)}catch{g.forEach=i}};for(var m in o)o[m]&&h(t[m]&&t[m].prototype);h(r)},3506:function(a,f,e){var t=e(3925),o=String,r=TypeError;a.exports=function(i){if(t(i))return i;throw new r("Can't set "+o(i)+" as a prototype")}},3517:function(a,f,e){var t=e(9504),o=e(9039),r=e(4901),i=e(6955),l=e(7751),h=e(3706),m=function(){},g=l("Reflect","construct"),y=/^\s*(?:class|function)\b/,E=t(y.exec),w=!y.test(m),b=function(x){if(!r(x))return!1;try{return g(m,[],x),!0}catch{return!1}},S=function(x){if(!r(x))return!1;switch(i(x)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return w||!!E(y,h(x))}catch{return!0}};S.sham=!0,a.exports=!g||o(function(){var x;return b(b.call)||!b(Object)||!b(function(){x=!0})||x})?S:b},3607:function(a,f,e){var t=e(2839).match(/AppleWebKit\/(\d+)\./);a.exports=!!t&&+t[1]},3635:function(a,f,e){var t=e(9039),o=e(4576).RegExp;a.exports=t(function(){var r=o(".","s");return!(r.dotAll&&r.test(`
`)&&r.flags==="s")})},3640:function(a,f,e){var t=e(8551),o=e(4270),r=TypeError;a.exports=function(i){if(t(this),i==="string"||i==="default")i="string";else if(i!=="number")throw new r("Incorrect hint");return o(this,i)}},3706:function(a,f,e){var t=e(9504),o=e(4901),r=e(7629),i=t(Function.toString);o(r.inspectSource)||(r.inspectSource=function(l){return i(l)}),a.exports=r.inspectSource},3709:function(a,f,e){var t=e(2839).match(/firefox\/(\d+)/i);a.exports=!!t&&+t[1]},3717:function(a,f){f.f=Object.getOwnPropertySymbols},3724:function(a,f,e){var t=e(9039);a.exports=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},3763:function(a,f,e){var t=e(2839);a.exports=/MSIE|Trident/.test(t)},3792:function(a,f,e){var t=e(5397),o=e(6469),r=e(6269),i=e(1181),l=e(4913).f,h=e(1088),m=e(2529),g=e(6395),y=e(3724),E="Array Iterator",w=i.set,b=i.getterFor(E);a.exports=h(Array,"Array",function(x,O){w(this,{type:E,target:t(x),index:0,kind:O})},function(){var x=b(this),O=x.target,A=x.index++;if(!O||A>=O.length)return x.target=null,m(void 0,!0);switch(x.kind){case"keys":return m(A,!1);case"values":return m(O[A],!1)}return m([A,O[A]],!1)},"values");var S=r.Arguments=r.Array;if(o("keys"),o("values"),o("entries"),!g&&y&&S.name!=="values")try{l(S,"name",{value:"values"})}catch{}},3802:function(a,f,e){var t=e(9504),o=e(7750),r=e(655),i=e(7452),l=t("".replace),h=RegExp("^["+i+"]+"),m=RegExp("(^|[^"+i+"])["+i+"]+$"),g=function(y){return function(E){var w=r(o(E));return 1&y&&(w=l(w,h,"")),2&y&&(w=l(w,m,"$1")),w}};a.exports={start:g(1),end:g(2),trim:g(3)}},3851:function(a,f,e){var t=e(6518),o=e(9039),r=e(5397),i=e(7347).f,l=e(3724);t({target:"Object",stat:!0,forced:!l||o(function(){i(1)}),sham:!l},{getOwnPropertyDescriptor:function(h,m){return i(r(h),m)}})},3925:function(a,f,e){var t=e(34);a.exports=function(o){return t(o)||o===null}},3994:function(a,f,e){var t=e(7657).IteratorPrototype,o=e(2360),r=e(6980),i=e(687),l=e(6269),h=function(){return this};a.exports=function(m,g,y,E){var w=g+" Iterator";return m.prototype=o(t,{next:r(+!E,y)}),i(m,w,!1,!0),l[w]=h,m}},4055:function(a,f,e){var t=e(4576),o=e(34),r=t.document,i=o(r)&&o(r.createElement);a.exports=function(l){return i?r.createElement(l):{}}},4117:function(a){a.exports=function(f){return f==null}},4209:function(a,f,e){var t=e(8227),o=e(6269),r=t("iterator"),i=Array.prototype;a.exports=function(l){return l!==void 0&&(o.Array===l||i[r]===l)}},4213:function(a,f,e){var t=e(3724),o=e(9504),r=e(9565),i=e(9039),l=e(1072),h=e(3717),m=e(8773),g=e(8981),y=e(7055),E=Object.assign,w=Object.defineProperty,b=o([].concat);a.exports=!E||i(function(){if(t&&E({b:1},E(w({},"a",{enumerable:!0,get:function(){w(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var S={},x={},O=Symbol("assign detection"),A="abcdefghijklmnopqrst";return S[O]=7,A.split("").forEach(function(P){x[P]=P}),E({},S)[O]!==7||l(E({},x)).join("")!==A})?function(S,x){for(var O=g(S),A=arguments.length,P=1,N=h.f,M=m.f;A>P;)for(var B,L=y(arguments[P++]),R=N?b(l(L),N(L)):l(L),H=R.length,U=0;H>U;)B=R[U++],t&&!r(M,L,B)||(O[B]=L[B]);return O}:E},4215:function(a,f,e){var t=e(4576),o=e(2839),r=e(2195),i=function(l){return o.slice(0,l.length)===l};a.exports=i("Bun/")?"BUN":i("Cloudflare-Workers")?"CLOUDFLARE":i("Deno/")?"DENO":i("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":r(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"},4270:function(a,f,e){var t=e(9565),o=e(4901),r=e(34),i=TypeError;a.exports=function(l,h){var m,g;if(h==="string"&&o(m=l.toString)&&!r(g=t(m,l))||o(m=l.valueOf)&&!r(g=t(m,l))||h!=="string"&&o(m=l.toString)&&!r(g=t(m,l)))return g;throw new i("Can't convert object to primitive value")}},4376:function(a,f,e){var t=e(2195);a.exports=Array.isArray||function(o){return t(o)==="Array"}},4423:function(a,f,e){var t=e(6518),o=e(9617).includes,r=e(9039),i=e(6469);t({target:"Array",proto:!0,forced:r(function(){return!Array(1).includes()})},{includes:function(l){return o(this,l,arguments.length>1?arguments[1]:void 0)}}),i("includes")},4428:function(a,f,e){var t=e(8227)("iterator"),o=!1;try{var r=0,i={next:function(){return{done:!!r++}},return:function(){o=!0}};i[t]=function(){return this},Array.from(i,function(){throw 2})}catch{}a.exports=function(l,h){try{if(!h&&!o)return!1}catch{return!1}var m=!1;try{var g={};g[t]=function(){return{next:function(){return{done:m=!0}}}},l(g)}catch{}return m}},4488:function(a,f,e){var t=e(7680),o=Math.floor,r=function(i,l){var h=i.length;if(h<8)for(var m,g,y=1;y<h;){for(g=y,m=i[y];g&&l(i[g-1],m)>0;)i[g]=i[--g];g!==y++&&(i[g]=m)}else for(var E=o(h/2),w=r(t(i,0,E),l),b=r(t(i,E),l),S=w.length,x=b.length,O=0,A=0;O<S||A<x;)i[O+A]=O<S&&A<x?l(w[O],b[A])<=0?w[O++]:b[A++]:O<S?w[O++]:b[A++];return i};a.exports=r},4495:function(a,f,e){var t=e(9519),o=e(9039),r=e(4576).String;a.exports=!!Object.getOwnPropertySymbols&&!o(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41})},4527:function(a,f,e){var t=e(3724),o=e(4376),r=TypeError,i=Object.getOwnPropertyDescriptor,l=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(h){return h instanceof TypeError}}();a.exports=l?function(h,m){if(o(h)&&!i(h,"length").writable)throw new r("Cannot set read only .length");return h.length=m}:function(h,m){return h.length=m}},4554:function(a,f,e){var t=e(6518),o=e(8981),r=e(5610),i=e(1291),l=e(6198),h=e(4527),m=e(6837),g=e(1469),y=e(4659),E=e(4606),w=e(597)("splice"),b=Math.max,S=Math.min;t({target:"Array",proto:!0,forced:!w},{splice:function(x,O){var A,P,N,M,B,L,R=o(this),H=l(R),U=r(x,H),_=arguments.length;for(_===0?A=P=0:_===1?(A=0,P=H-U):(A=_-2,P=S(b(i(O),0),H-U)),m(H+A-P),N=g(R,P),M=0;M<P;M++)(B=U+M)in R&&y(N,M,R[B]);if(N.length=P,A<P){for(M=U;M<H-P;M++)L=M+A,(B=M+P)in R?R[L]=R[B]:E(R,L);for(M=H;M>H-P+A;M--)E(R,M-1)}else if(A>P)for(M=H-P;M>U;M--)L=M+A-1,(B=M+P-1)in R?R[L]=R[B]:E(R,L);for(M=0;M<A;M++)R[M+U]=arguments[M+2];return h(R,H-P+A),N}})},4576:function(a,f,e){var t=function(o){return o&&o.Math===Math&&o};a.exports=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof e.g=="object"&&e.g)||t(typeof this=="object"&&this)||function(){return this}()||Function("return this")()},4598:function(a,f,e){var t=e(9039);a.exports=function(o,r){var i=[][o];return!!i&&t(function(){i.call(null,r||function(){return 1},1)})}},4606:function(a,f,e){var t=e(6823),o=TypeError;a.exports=function(r,i){if(!delete r[i])throw new o("Cannot delete property "+t(i)+" of "+t(r))}},4659:function(a,f,e){var t=e(3724),o=e(4913),r=e(6980);a.exports=function(i,l,h){t?o.f(i,l,r(0,h)):i[l]=h}},4782:function(a,f,e){var t=e(6518),o=e(4376),r=e(3517),i=e(34),l=e(5610),h=e(6198),m=e(5397),g=e(4659),y=e(8227),E=e(597),w=e(7680),b=E("slice"),S=y("species"),x=Array,O=Math.max;t({target:"Array",proto:!0,forced:!b},{slice:function(A,P){var N,M,B,L=m(this),R=h(L),H=l(A,R),U=l(P===void 0?R:P,R);if(o(L)&&(N=L.constructor,(r(N)&&(N===x||o(N.prototype))||i(N)&&(N=N[S])===null)&&(N=void 0),N===x||N===void 0))return w(L,H,U);for(M=new(N===void 0?x:N)(O(U-H,0)),B=0;H<U;H++,B++)H in L&&g(M,B,L[H]);return M.length=B,M}})},4864:function(a,f,e){var t=e(3724),o=e(4576),r=e(9504),i=e(2796),l=e(3167),h=e(6699),m=e(2360),g=e(8480).f,y=e(1625),E=e(788),w=e(655),b=e(1034),S=e(8429),x=e(1056),O=e(6840),A=e(9039),P=e(9297),N=e(1181).enforce,M=e(7633),B=e(8227),L=e(3635),R=e(8814),H=B("match"),U=o.RegExp,_=U.prototype,ee=o.SyntaxError,V=r(_.exec),G=r("".charAt),pe=r("".replace),fe=r("".indexOf),W=r("".slice),ne=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Q=/a/g,X=/a/g,te=new U(Q)!==Q,re=S.MISSED_STICKY,K=S.UNSUPPORTED_Y,q=t&&(!te||re||L||R||A(function(){return X[H]=!1,U(Q)!==Q||U(X)===X||String(U(Q,"i"))!=="/a/i"}));if(i("RegExp",q)){for(var z=function(ie,se){var ke,we,Ne,We,Te,je,Ie=y(_,this),Ge=E(ie),ht=se===void 0,pt=[],De=ie;if(!Ie&&Ge&&ht&&ie.constructor===z)return ie;if((Ge||y(_,ie))&&(ie=ie.source,ht&&(se=b(De))),ie=ie===void 0?"":w(ie),se=se===void 0?"":w(se),De=ie,L&&"dotAll"in Q&&(we=!!se&&fe(se,"s")>-1)&&(se=pe(se,/s/g,"")),ke=se,re&&"sticky"in Q&&(Ne=!!se&&fe(se,"y")>-1)&&K&&(se=pe(se,/y/g,"")),R&&(We=function(Re){for(var Ae,mt=Re.length,Le=0,Ye="",Je=[],gt=m(null),vt=!1,ut=!1,Rt=0,rt="";Le<=mt;Le++){if((Ae=G(Re,Le))==="\\")Ae+=G(Re,++Le);else if(Ae==="]")vt=!1;else if(!vt)switch(!0){case Ae==="[":vt=!0;break;case Ae==="(":if(Ye+=Ae,W(Re,Le+1,Le+3)==="?:")continue;V(ne,W(Re,Le+1))&&(Le+=2,ut=!0),Rt++;continue;case(Ae===">"&&ut):if(rt===""||P(gt,rt))throw new ee("Invalid capture group name");gt[rt]=!0,Je[Je.length]=[rt,Rt],ut=!1,rt="";continue}ut?rt+=Ae:Ye+=Ae}return[Ye,Je]}(ie),ie=We[0],pt=We[1]),Te=l(U(ie,se),Ie?this:_,z),(we||Ne||pt.length)&&(je=N(Te),we&&(je.dotAll=!0,je.raw=z(function(Re){for(var Ae,mt=Re.length,Le=0,Ye="",Je=!1;Le<=mt;Le++)(Ae=G(Re,Le))!=="\\"?Je||Ae!=="."?(Ae==="["?Je=!0:Ae==="]"&&(Je=!1),Ye+=Ae):Ye+="[\\s\\S]":Ye+=Ae+G(Re,++Le);return Ye}(ie),ke)),Ne&&(je.sticky=!0),pt.length&&(je.groups=pt)),ie!==De)try{h(Te,"source",De===""?"(?:)":De)}catch{}return Te},J=g(U),me=0;J.length>me;)x(z,U,J[me++]);_.constructor=z,z.prototype=_,O(o,"RegExp",z,{constructor:!0})}M("RegExp")},4901:function(a){var f=typeof document=="object"&&document.all;a.exports=f===void 0&&f!==void 0?function(e){return typeof e=="function"||e===f}:function(e){return typeof e=="function"}},4913:function(a,f,e){var t=e(3724),o=e(5917),r=e(8686),i=e(8551),l=e(6969),h=TypeError,m=Object.defineProperty,g=Object.getOwnPropertyDescriptor,y="enumerable",E="configurable",w="writable";f.f=t?r?function(b,S,x){if(i(b),S=l(S),i(x),typeof b=="function"&&S==="prototype"&&"value"in x&&w in x&&!x[w]){var O=g(b,S);O&&O[w]&&(b[S]=x.value,x={configurable:E in x?x[E]:O[E],enumerable:y in x?x[y]:O[y],writable:!1})}return m(b,S,x)}:m:function(b,S,x){if(i(b),S=l(S),i(x),o)try{return m(b,S,x)}catch{}if("get"in x||"set"in x)throw new h("Accessors not supported");return"value"in x&&(b[S]=x.value),b}},5031:function(a,f,e){var t=e(7751),o=e(9504),r=e(8480),i=e(3717),l=e(8551),h=o([].concat);a.exports=t("Reflect","ownKeys")||function(m){var g=r.f(l(m)),y=i.f;return y?h(g,y(m)):g}},5213:function(a,f,e){var t=e(4576),o=e(9039),r=t.RegExp,i=!o(function(){var l=!0;try{r(".","d")}catch{l=!1}var h={},m="",g=l?"dgimsy":"gimsy",y=function(b,S){Object.defineProperty(h,b,{get:function(){return m+=S,!0}})},E={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var w in l&&(E.hasIndices="d"),E)y(w,E[w]);return Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(h)!==g||m!==g});a.exports={correct:i}},5276:function(a,f,e){var t=e(6518),o=e(7476),r=e(9617).indexOf,i=e(4598),l=o([].indexOf),h=!!l&&1/l([1],1,-0)<0;t({target:"Array",proto:!0,forced:h||!i("indexOf")},{indexOf:function(m){var g=arguments.length>1?arguments[1]:void 0;return h?l(this,m,g)||0:r(this,m,g)}})},5397:function(a,f,e){var t=e(7055),o=e(7750);a.exports=function(r){return t(o(r))}},5440:function(a,f,e){var t=e(8745),o=e(9565),r=e(9504),i=e(9228),l=e(9039),h=e(8551),m=e(4901),g=e(34),y=e(1291),E=e(8014),w=e(655),b=e(7750),S=e(7829),x=e(5966),O=e(2478),A=e(1034),P=e(6682),N=e(8227)("replace"),M=Math.max,B=Math.min,L=r([].concat),R=r([].push),H=r("".indexOf),U=r("".slice),_="a".replace(/./,"$0")==="$0",ee=!!/./[N]&&/./[N]("a","$0")==="";i("replace",function(V,G,pe){var fe=ee?"$":"$0";return[function(W,ne){var Q=b(this),X=g(W)?x(W,N):void 0;return X?o(X,W,Q,ne):o(G,w(Q),W,ne)},function(W,ne){var Q=h(this),X=w(W);if(typeof ne=="string"&&H(ne,fe)===-1&&H(ne,"$<")===-1){var te=pe(G,Q,X,ne);if(te.done)return te.value}var re=m(ne);re||(ne=w(ne));var K,q=w(A(Q)),z=H(q,"g")!==-1;z&&(K=H(q,"u")!==-1,Q.lastIndex=0);for(var J,me=[];(J=P(Q,X))!==null&&(R(me,J),z);)w(J[0])===""&&(Q.lastIndex=S(X,E(Q.lastIndex),K));for(var ie,se="",ke=0,we=0;we<me.length;we++){for(var Ne,We=w((J=me[we])[0]),Te=M(B(y(J.index),X.length),0),je=[],Ie=1;Ie<J.length;Ie++)R(je,(ie=J[Ie])===void 0?ie:String(ie));var Ge=J.groups;if(re){var ht=L([We],je,Te,X);Ge!==void 0&&R(ht,Ge),Ne=w(t(ne,void 0,ht))}else Ne=O(We,X,Te,je,Ge,ne);Te>=ke&&(se+=U(X,ke,Te)+Ne,ke=Te+We.length)}return se+U(X,ke)}]},!!l(function(){var V=/./;return V.exec=function(){var G=[];return G.groups={a:"7"},G},"".replace(V,"$<a>")!=="7"})||!_||ee)},5548:function(a,f,e){var t=e(3517),o=e(6823),r=TypeError;a.exports=function(i){if(t(i))return i;throw new r(o(i)+" is not a constructor")}},5610:function(a,f,e){var t=e(1291),o=Math.max,r=Math.min;a.exports=function(i,l){var h=t(i);return h<0?o(h+l,0):r(h,l)}},5700:function(a,f,e){var t=e(511),o=e(8242);t("toPrimitive"),o()},5745:function(a,f,e){var t=e(7629);a.exports=function(o,r){return t[o]||(t[o]=r||{})}},5749:function(a,f,e){var t=e(788),o=TypeError;a.exports=function(r){if(t(r))throw new o("The method doesn't accept regular expressions");return r}},5810:function(a,f,e){var t=e(34),o=e(1181).get;a.exports=function(r){if(!t(r))return!1;var i=o(r);return!!i&&i.type==="RawJSON"}},5917:function(a,f,e){var t=e(3724),o=e(9039),r=e(4055);a.exports=!t&&!o(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7})},5966:function(a,f,e){var t=e(9306),o=e(4117);a.exports=function(r,i){var l=r[i];return o(l)?void 0:t(l)}},6080:function(a,f,e){var t=e(7476),o=e(9306),r=e(616),i=t(t.bind);a.exports=function(l,h){return o(l),h===void 0?l:r?i(l,h):function(){return l.apply(h,arguments)}}},6099:function(a,f,e){var t=e(2140),o=e(6840),r=e(3179);t||o(Object.prototype,"toString",r,{unsafe:!0})},6119:function(a,f,e){var t=e(5745),o=e(3392),r=t("keys");a.exports=function(i){return r[i]||(r[i]=o(i))}},6193:function(a,f,e){var t=e(4215);a.exports=t==="NODE"},6198:function(a,f,e){var t=e(8014);a.exports=function(o){return t(o.length)}},6269:function(a){a.exports={}},6319:function(a,f,e){var t=e(8551),o=e(9539);a.exports=function(r,i,l,h){try{return h?i(t(l)[0],l[1]):i(l)}catch(m){o(r,"throw",m)}}},6395:function(a){a.exports=!1},6469:function(a,f,e){var t=e(8227),o=e(2360),r=e(4913).f,i=t("unscopables"),l=Array.prototype;l[i]===void 0&&r(l,i,{configurable:!0,value:o(null)}),a.exports=function(h){l[i][h]=!0}},6518:function(a,f,e){var t=e(4576),o=e(7347).f,r=e(6699),i=e(6840),l=e(9433),h=e(7740),m=e(2796);a.exports=function(g,y){var E,w,b,S,x,O=g.target,A=g.global,P=g.stat;if(E=A?t:P?t[O]||l(O,{}):t[O]&&t[O].prototype)for(w in y){if(S=y[w],b=g.dontCallGetSet?(x=o(E,w))&&x.value:E[w],!m(A?w:O+(P?".":"#")+w,g.forced)&&b!==void 0){if(typeof S==typeof b)continue;h(S,b)}(g.sham||b&&b.sham)&&r(S,"sham",!0),i(E,w,S,g)}}},6682:function(a,f,e){var t=e(9565),o=e(8551),r=e(4901),i=e(2195),l=e(7323),h=TypeError;a.exports=function(m,g){var y=m.exec;if(r(y)){var E=t(y,m,g);return E!==null&&o(E),E}if(i(m)==="RegExp")return t(l,m,g);throw new h("RegExp#exec called on incompatible receiver")}},6699:function(a,f,e){var t=e(3724),o=e(4913),r=e(6980);a.exports=t?function(i,l,h){return o.f(i,l,r(1,h))}:function(i,l,h){return i[l]=h,i}},6706:function(a,f,e){var t=e(9504),o=e(9306);a.exports=function(r,i,l){try{return t(o(Object.getOwnPropertyDescriptor(r,i)[l]))}catch{}}},6761:function(a,f,e){var t=e(6518),o=e(4576),r=e(9565),i=e(9504),l=e(6395),h=e(3724),m=e(4495),g=e(9039),y=e(9297),E=e(1625),w=e(8551),b=e(5397),S=e(6969),x=e(655),O=e(6980),A=e(2360),P=e(1072),N=e(8480),M=e(298),B=e(3717),L=e(7347),R=e(4913),H=e(6801),U=e(8773),_=e(6840),ee=e(2106),V=e(5745),G=e(6119),pe=e(421),fe=e(3392),W=e(8227),ne=e(1951),Q=e(511),X=e(8242),te=e(687),re=e(1181),K=e(9213).forEach,q=G("hidden"),z="Symbol",J="prototype",me=re.set,ie=re.getterFor(z),se=Object[J],ke=o.Symbol,we=ke&&ke[J],Ne=o.RangeError,We=o.TypeError,Te=o.QObject,je=L.f,Ie=R.f,Ge=M.f,ht=U.f,pt=i([].push),De=V("symbols"),Re=V("op-symbols"),Ae=V("wks"),mt=!Te||!Te[J]||!Te[J].findChild,Le=function(ae,ce,de){var be=je(se,ce);be&&delete se[ce],Ie(ae,ce,de),be&&ae!==se&&Ie(se,ce,be)},Ye=h&&g(function(){return A(Ie({},"a",{get:function(){return Ie(this,"a",{value:7}).a}})).a!==7})?Le:Ie,Je=function(ae,ce){var de=De[ae]=A(we);return me(de,{type:z,tag:ae,description:ce}),h||(de.description=ce),de},gt=function(ae,ce,de){ae===se&&gt(Re,ce,de),w(ae);var be=S(ce);return w(de),y(De,be)?(de.enumerable?(y(ae,q)&&ae[q][be]&&(ae[q][be]=!1),de=A(de,{enumerable:O(0,!1)})):(y(ae,q)||Ie(ae,q,O(1,A(null))),ae[q][be]=!0),Ye(ae,be,de)):Ie(ae,be,de)},vt=function(ae,ce){w(ae);var de=b(ce),be=P(de).concat(Pn(de));return K(be,function(Oe){h&&!r(ut,de,Oe)||gt(ae,Oe,de[Oe])}),ae},ut=function(ae){var ce=S(ae),de=r(ht,this,ce);return!(this===se&&y(De,ce)&&!y(Re,ce))&&(!(de||!y(this,ce)||!y(De,ce)||y(this,q)&&this[q][ce])||de)},Rt=function(ae,ce){var de=b(ae),be=S(ce);if(de!==se||!y(De,be)||y(Re,be)){var Oe=je(de,be);return!Oe||!y(De,be)||y(de,q)&&de[q][be]||(Oe.enumerable=!0),Oe}},rt=function(ae){var ce=Ge(b(ae)),de=[];return K(ce,function(be){y(De,be)||y(pe,be)||pt(de,be)}),de},Pn=function(ae){var ce=ae===se,de=Ge(ce?Re:b(ae)),be=[];return K(de,function(Oe){!y(De,Oe)||ce&&!y(se,Oe)||pt(be,De[Oe])}),be};m||(ke=function(){if(E(we,this))throw new We("Symbol is not a constructor");var ae=arguments.length&&arguments[0]!==void 0?x(arguments[0]):void 0,ce=fe(ae),de=function(be){var Oe=this===void 0?o:this;Oe===se&&r(de,Re,be),y(Oe,q)&&y(Oe[q],ce)&&(Oe[q][ce]=!1);var In=O(1,be);try{Ye(Oe,ce,In)}catch(Mn){if(!(Mn instanceof Ne))throw Mn;Le(Oe,ce,In)}};return h&&mt&&Ye(se,ce,{configurable:!0,set:de}),Je(ce,ae)},_(we=ke[J],"toString",function(){return ie(this).tag}),_(ke,"withoutSetter",function(ae){return Je(fe(ae),ae)}),U.f=ut,R.f=gt,H.f=vt,L.f=Rt,N.f=M.f=rt,B.f=Pn,ne.f=function(ae){return Je(W(ae),ae)},h&&(ee(we,"description",{configurable:!0,get:function(){return ie(this).description}}),l||_(se,"propertyIsEnumerable",ut,{unsafe:!0}))),t({global:!0,constructor:!0,wrap:!0,forced:!m,sham:!m},{Symbol:ke}),K(P(Ae),function(ae){Q(ae)}),t({target:z,stat:!0,forced:!m},{useSetter:function(){mt=!0},useSimple:function(){mt=!1}}),t({target:"Object",stat:!0,forced:!m,sham:!h},{create:function(ae,ce){return ce===void 0?A(ae):vt(A(ae),ce)},defineProperty:gt,defineProperties:vt,getOwnPropertyDescriptor:Rt}),t({target:"Object",stat:!0,forced:!m},{getOwnPropertyNames:rt}),X(),te(ke,z),pe[q]=!0},6801:function(a,f,e){var t=e(3724),o=e(8686),r=e(4913),i=e(8551),l=e(5397),h=e(1072);f.f=t&&!o?Object.defineProperties:function(m,g){i(m);for(var y,E=l(g),w=h(g),b=w.length,S=0;b>S;)r.f(m,y=w[S++],E[y]);return m}},6823:function(a){var f=String;a.exports=function(e){try{return f(e)}catch{return"Object"}}},6837:function(a){var f=TypeError;a.exports=function(e){if(e>9007199254740991)throw f("Maximum allowed index exceeded");return e}},6840:function(a,f,e){var t=e(4901),o=e(4913),r=e(283),i=e(9433);a.exports=function(l,h,m,g){g||(g={});var y=g.enumerable,E=g.name!==void 0?g.name:h;if(t(m)&&r(m,E,g),g.global)y?l[h]=m:i(h,m);else{try{g.unsafe?l[h]&&(y=!0):delete l[h]}catch{}y?l[h]=m:o.f(l,h,{value:m,enumerable:!1,configurable:!g.nonConfigurable,writable:!g.nonWritable})}return l}},6910:function(a,f,e){var t=e(6518),o=e(9504),r=e(9306),i=e(8981),l=e(6198),h=e(4606),m=e(655),g=e(9039),y=e(4488),E=e(4598),w=e(3709),b=e(3763),S=e(9519),x=e(3607),O=[],A=o(O.sort),P=o(O.push),N=g(function(){O.sort(void 0)}),M=g(function(){O.sort(null)}),B=E("sort"),L=!g(function(){if(S)return S<70;if(!(w&&w>3)){if(b)return!0;if(x)return x<603;var R,H,U,_,ee="";for(R=65;R<76;R++){switch(H=String.fromCharCode(R),R){case 66:case 69:case 70:case 72:U=3;break;case 68:case 71:U=4;break;default:U=2}for(_=0;_<47;_++)O.push({k:H+_,v:U})}for(O.sort(function(V,G){return G.v-V.v}),_=0;_<O.length;_++)H=O[_].k.charAt(0),ee.charAt(ee.length-1)!==H&&(ee+=H);return ee!=="DGBEFHACIJK"}});t({target:"Array",proto:!0,forced:N||!M||!B||!L},{sort:function(R){R!==void 0&&r(R);var H=i(this);if(L)return R===void 0?A(H):A(H,R);var U,_,ee=[],V=l(H);for(_=0;_<V;_++)_ in H&&P(ee,H[_]);for(y(ee,function(G){return function(pe,fe){return fe===void 0?-1:pe===void 0?1:G!==void 0?+G(pe,fe)||0:m(pe)>m(fe)?1:-1}}(R)),U=l(ee),_=0;_<U;)H[_]=ee[_++];for(;_<V;)h(H,_++);return H}})},6955:function(a,f,e){var t=e(2140),o=e(4901),r=e(2195),i=e(8227)("toStringTag"),l=Object,h=r(function(){return arguments}())==="Arguments";a.exports=t?r:function(m){var g,y,E;return m===void 0?"Undefined":m===null?"Null":typeof(y=function(w,b){try{return w[b]}catch{}}(g=l(m),i))=="string"?y:h?r(g):(E=r(g))==="Object"&&o(g.callee)?"Arguments":E}},6969:function(a,f,e){var t=e(2777),o=e(757);a.exports=function(r){var i=t(r,"string");return o(i)?i:i+""}},6980:function(a){a.exports=function(f,e){return{enumerable:!(1&f),configurable:!(2&f),writable:!(4&f),value:e}}},7040:function(a,f,e){var t=e(4495);a.exports=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},7055:function(a,f,e){var t=e(9504),o=e(9039),r=e(2195),i=Object,l=t("".split);a.exports=o(function(){return!i("z").propertyIsEnumerable(0)})?function(h){return r(h)==="String"?l(h,""):i(h)}:i},7323:function(a,f,e){var t,o,r=e(9565),i=e(9504),l=e(655),h=e(7979),m=e(8429),g=e(5745),y=e(2360),E=e(1181).get,w=e(3635),b=e(8814),S=g("native-string-replace",String.prototype.replace),x=RegExp.prototype.exec,O=x,A=i("".charAt),P=i("".indexOf),N=i("".replace),M=i("".slice),B=(o=/b*/g,r(x,t=/a/,"a"),r(x,o,"a"),t.lastIndex!==0||o.lastIndex!==0),L=m.BROKEN_CARET,R=/()??/.exec("")[1]!==void 0;(B||R||L||w||b)&&(O=function(H){var U,_,ee,V,G,pe,fe,W=this,ne=E(W),Q=l(H),X=ne.raw;if(X)return X.lastIndex=W.lastIndex,U=r(O,X,Q),W.lastIndex=X.lastIndex,U;var te=ne.groups,re=L&&W.sticky,K=r(h,W),q=W.source,z=0,J=Q;if(re&&(K=N(K,"y",""),P(K,"g")===-1&&(K+="g"),J=M(Q,W.lastIndex),W.lastIndex>0&&(!W.multiline||W.multiline&&A(Q,W.lastIndex-1)!==`
`)&&(q="(?: "+q+")",J=" "+J,z++),_=new RegExp("^(?:"+q+")",K)),R&&(_=new RegExp("^"+q+"$(?!\\s)",K)),B&&(ee=W.lastIndex),V=r(x,re?_:W,J),re?V?(V.input=M(V.input,z),V[0]=M(V[0],z),V.index=W.lastIndex,W.lastIndex+=V[0].length):W.lastIndex=0:B&&V&&(W.lastIndex=W.global?V.index+V[0].length:ee),R&&V&&V.length>1&&r(S,V[0],_,function(){for(G=1;G<arguments.length-2;G++)arguments[G]===void 0&&(V[G]=void 0)}),V&&te)for(V.groups=pe=y(null),G=0;G<te.length;G++)pe[(fe=te[G])[0]]=V[fe[1]];return V}),a.exports=O},7347:function(a,f,e){var t=e(3724),o=e(9565),r=e(8773),i=e(6980),l=e(5397),h=e(6969),m=e(9297),g=e(5917),y=Object.getOwnPropertyDescriptor;f.f=t?y:function(E,w){if(E=l(E),w=h(w),g)try{return y(E,w)}catch{}if(m(E,w))return i(!o(r.f,E,w),E[w])}},7400:function(a){a.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},7427:function(a,f,e){var t=e(6518),o=e(3724),r=e(2551),i=e(9306),l=e(8981),h=e(4913);o&&t({target:"Object",proto:!0,forced:r},{__defineGetter__:function(m,g){h.f(l(this),m,{get:i(g),enumerable:!0,configurable:!0})}})},7433:function(a,f,e){var t=e(4376),o=e(3517),r=e(34),i=e(8227)("species"),l=Array;a.exports=function(h){var m;return t(h)&&(m=h.constructor,(o(m)&&(m===l||t(m.prototype))||r(m)&&(m=m[i])===null)&&(m=void 0)),m===void 0?l:m}},7452:function(a){a.exports=`	
\v\f\r                　\u2028\u2029\uFEFF`},7476:function(a,f,e){var t=e(2195),o=e(9504);a.exports=function(r){if(t(r)==="Function")return o(r)}},7495:function(a,f,e){var t=e(6518),o=e(7323);t({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},7629:function(a,f,e){var t=e(6395),o=e(4576),r=e(9433),i="__core-js_shared__",l=a.exports=o[i]||r(i,{});(l.versions||(l.versions=[])).push({version:"3.47.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"})},7633:function(a,f,e){var t=e(7751),o=e(2106),r=e(8227),i=e(3724),l=r("species");a.exports=function(h){var m=t(h);i&&m&&!m[l]&&o(m,l,{configurable:!0,get:function(){return this}})}},7657:function(a,f,e){var t,o,r,i=e(9039),l=e(4901),h=e(34),m=e(2360),g=e(2787),y=e(6840),E=e(8227),w=e(6395),b=E("iterator"),S=!1;[].keys&&("next"in(r=[].keys())?(o=g(g(r)))!==Object.prototype&&(t=o):S=!0),!h(t)||i(function(){var x={};return t[b].call(x)!==x})?t={}:w&&(t=m(t)),l(t[b])||y(t,b,function(){return this}),a.exports={IteratorPrototype:t,BUGGY_SAFARI_ITERATORS:S}},7680:function(a,f,e){var t=e(9504);a.exports=t([].slice)},7740:function(a,f,e){var t=e(9297),o=e(5031),r=e(7347),i=e(4913);a.exports=function(l,h,m){for(var g=o(h),y=i.f,E=r.f,w=0;w<g.length;w++){var b=g[w];t(l,b)||m&&t(m,b)||y(l,b,E(h,b))}}},7750:function(a,f,e){var t=e(4117),o=TypeError;a.exports=function(r){if(t(r))throw new o("Can't call method on "+r);return r}},7751:function(a,f,e){var t=e(4576),o=e(4901);a.exports=function(r,i){return arguments.length<2?(l=t[r],o(l)?l:void 0):t[r]&&t[r][i];var l}},7764:function(a,f,e){var t=e(8183).charAt,o=e(655),r=e(1181),i=e(1088),l=e(2529),h="String Iterator",m=r.set,g=r.getterFor(h);i(String,"String",function(y){m(this,{type:h,string:o(y),index:0})},function(){var y,E=g(this),w=E.string,b=E.index;return b>=w.length?l(void 0,!0):(y=t(w,b),E.index+=y.length,l(y,!1))})},7812:function(a,f,e){var t=e(6518),o=e(9297),r=e(757),i=e(6823),l=e(5745),h=e(1296),m=l("symbol-to-string-registry");t({target:"Symbol",stat:!0,forced:!h},{keyFor:function(g){if(!r(g))throw new TypeError(i(g)+" is not a symbol");if(o(m,g))return m[g]}})},7819:function(a,f,e){var t=e(9039);a.exports=!t(function(){var o="9007199254740993",r=JSON.rawJSON(o);return!JSON.isRawJSON(r)||JSON.stringify(r)!==o})},7829:function(a,f,e){var t=e(8183).charAt;a.exports=function(o,r,i){return r+(i?t(o,r).length:1)}},7916:function(a,f,e){var t=e(6080),o=e(9565),r=e(8981),i=e(6319),l=e(4209),h=e(3517),m=e(6198),g=e(4659),y=e(81),E=e(851),w=Array;a.exports=function(b){var S=r(b),x=h(this),O=arguments.length,A=O>1?arguments[1]:void 0,P=A!==void 0;P&&(A=t(A,O>2?arguments[2]:void 0));var N,M,B,L,R,H,U=E(S),_=0;if(!U||this===w&&l(U))for(N=m(S),M=x?new this(N):w(N);N>_;_++)H=P?A(S[_],_):S[_],g(M,_,H);else for(M=x?new this:[],R=(L=y(S,U)).next;!(B=o(R,L)).done;_++)H=P?i(L,A,[B.value,_],!0):B.value,g(M,_,H);return M.length=_,M}},7979:function(a,f,e){var t=e(8551);a.exports=function(){var o=t(this),r="";return o.hasIndices&&(r+="d"),o.global&&(r+="g"),o.ignoreCase&&(r+="i"),o.multiline&&(r+="m"),o.dotAll&&(r+="s"),o.unicode&&(r+="u"),o.unicodeSets&&(r+="v"),o.sticky&&(r+="y"),r}},8014:function(a,f,e){var t=e(1291),o=Math.min;a.exports=function(r){var i=t(r);return i>0?o(i,9007199254740991):0}},8183:function(a,f,e){var t=e(9504),o=e(1291),r=e(655),i=e(7750),l=t("".charAt),h=t("".charCodeAt),m=t("".slice),g=function(y){return function(E,w){var b,S,x=r(i(E)),O=o(w),A=x.length;return O<0||O>=A?y?"":void 0:(b=h(x,O))<55296||b>56319||O+1===A||(S=h(x,O+1))<56320||S>57343?y?l(x,O):b:y?m(x,O,O+2):S-56320+(b-55296<<10)+65536}};a.exports={codeAt:g(!1),charAt:g(!0)}},8227:function(a,f,e){var t=e(4576),o=e(5745),r=e(9297),i=e(3392),l=e(4495),h=e(7040),m=t.Symbol,g=o("wks"),y=h?m.for||m:m&&m.withoutSetter||i;a.exports=function(E){return r(g,E)||(g[E]=l&&r(m,E)?m[E]:y("Symbol."+E)),g[E]}},8235:function(a,f,e){var t=e(9504),o=e(9297),r=SyntaxError,i=parseInt,l=String.fromCharCode,h=t("".charAt),m=t("".slice),g=t(/./.exec),y={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},E=/^[\da-f]{4}$/i,w=/^[\u0000-\u001F]$/;a.exports=function(b,S){for(var x=!0,O="";S<b.length;){var A=h(b,S);if(A==="\\"){var P=m(b,S,S+2);if(o(y,P))O+=y[P],S+=2;else{if(P!=="\\u")throw new r('Unknown escape sequence: "'+P+'"');var N=m(b,S+=2,S+4);if(!g(E,N))throw new r("Bad Unicode escape at: "+S);O+=l(i(N,16)),S+=4}}else{if(A==='"'){x=!1,S++;break}if(g(w,A))throw new r("Bad control character in string literal at: "+S);O+=A,S++}}if(x)throw new r("Unterminated string at: "+S);return{value:O,end:S}}},8242:function(a,f,e){var t=e(9565),o=e(7751),r=e(8227),i=e(6840);a.exports=function(){var l=o("Symbol"),h=l&&l.prototype,m=h&&h.valueOf,g=r("toPrimitive");h&&!h[g]&&i(h,g,function(y){return t(m,this)},{arity:1})}},8344:function(a,f,e){e(8543)},8429:function(a,f,e){var t=e(9039),o=e(4576).RegExp,r=t(function(){var h=o("a","y");return h.lastIndex=2,h.exec("abcd")!==null}),i=r||t(function(){return!o("a","y").sticky}),l=r||t(function(){var h=o("^r","gy");return h.lastIndex=2,h.exec("str")!==null});a.exports={BROKEN_CARET:l,MISSED_STICKY:i,UNSUPPORTED_Y:r}},8480:function(a,f,e){var t=e(1828),o=e(8727).concat("length","prototype");f.f=Object.getOwnPropertyNames||function(r){return t(r,o)}},8543:function(a,f,e){var t=e(6518),o=e(9565),r=e(7476),i=e(3994),l=e(2529),h=e(7750),m=e(8014),g=e(655),y=e(8551),E=e(34),w=e(2195),b=e(788),S=e(1034),x=e(5966),O=e(6840),A=e(9039),P=e(8227),N=e(2293),M=e(7829),B=e(6682),L=e(1181),R=e(6395),H=P("matchAll"),U="RegExp String",_=U+" Iterator",ee=L.set,V=L.getterFor(_),G=RegExp.prototype,pe=TypeError,fe=r("".indexOf),W=r("".matchAll),ne=!!W&&!A(function(){W("a",/./)}),Q=i(function(te,re,K,q){ee(this,{type:_,regexp:te,string:re,global:K,unicode:q,done:!1})},U,function(){var te=V(this);if(te.done)return l(void 0,!0);var re=te.regexp,K=te.string,q=B(re,K);return q===null?(te.done=!0,l(void 0,!0)):te.global?(g(q[0])===""&&(re.lastIndex=M(K,m(re.lastIndex),te.unicode)),l(q,!1)):(te.done=!0,l(q,!1))}),X=function(te){var re,K,q,z=y(this),J=g(te),me=N(z,RegExp),ie=g(S(z));return re=new me(me===RegExp?z.source:z,ie),K=!!~fe(ie,"g"),q=!!~fe(ie,"u"),re.lastIndex=m(z.lastIndex),new Q(re,J,K,q)};t({target:"String",proto:!0,forced:ne},{matchAll:function(te){var re,K,q,z,J=h(this);if(E(te)){if(b(te)&&(re=g(h(S(te))),!~fe(re,"g")))throw new pe("`.matchAll` does not allow non-global regexes");if(ne)return W(J,te);if((q=x(te,H))===void 0&&R&&w(te)==="RegExp"&&(q=X),q)return o(q,te,J)}else if(ne)return W(J,te);return K=g(J),z=new RegExp(te,"g"),R?o(X,z,K):z[H](K)}}),R||H in G||O(G,H,X)},8551:function(a,f,e){var t=e(34),o=String,r=TypeError;a.exports=function(i){if(t(i))return i;throw new r(o(i)+" is not an object")}},8598:function(a,f,e){var t=e(6518),o=e(9504),r=e(7055),i=e(5397),l=e(4598),h=o([].join);t({target:"Array",proto:!0,forced:r!==Object||!l("join",",")},{join:function(m){return h(i(this),m===void 0?",":m)}})},8622:function(a,f,e){var t=e(4576),o=e(4901),r=t.WeakMap;a.exports=o(r)&&/native code/.test(String(r))},8686:function(a,f,e){var t=e(3724),o=e(9039);a.exports=t&&o(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},8706:function(a,f,e){var t=e(6518),o=e(9039),r=e(4376),i=e(34),l=e(8981),h=e(6198),m=e(6837),g=e(4659),y=e(1469),E=e(597),w=e(8227),b=e(9519),S=w("isConcatSpreadable"),x=b>=51||!o(function(){var A=[];return A[S]=!1,A.concat()[0]!==A}),O=function(A){if(!i(A))return!1;var P=A[S];return P!==void 0?!!P:r(A)};t({target:"Array",proto:!0,arity:1,forced:!x||!E("concat")},{concat:function(A){var P,N,M,B,L,R=l(this),H=y(R,0),U=0;for(P=-1,M=arguments.length;P<M;P++)if(O(L=P===-1?R:arguments[P]))for(B=h(L),m(U+B),N=0;N<B;N++,U++)N in L&&g(H,U,L[N]);else m(U+1),g(H,U++,L);return H.length=U,H}})},8727:function(a){a.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8745:function(a,f,e){var t=e(616),o=Function.prototype,r=o.apply,i=o.call;a.exports=typeof Reflect=="object"&&Reflect.apply||(t?i.bind(r):function(){return i.apply(r,arguments)})},8773:function(a,f){var e={}.propertyIsEnumerable,t=Object.getOwnPropertyDescriptor,o=t&&!e.call({1:2},1);f.f=o?function(r){var i=t(this,r);return!!i&&i.enumerable}:e},8781:function(a,f,e){var t=e(350).PROPER,o=e(6840),r=e(8551),i=e(655),l=e(9039),h=e(1034),m="toString",g=RegExp.prototype,y=g[m],E=l(function(){return y.call({source:"a",flags:"b"})!=="/a/b"}),w=t&&y.name!==m;(E||w)&&o(g,m,function(){var b=r(this);return"/"+i(b.source)+"/"+i(h(b))},{unsafe:!0})},8814:function(a,f,e){var t=e(9039),o=e(4576).RegExp;a.exports=t(function(){var r=o("(?<a>b)","g");return r.exec("b").groups.a!=="b"||"b".replace(r,"$<a>c")!=="bc"})},8981:function(a,f,e){var t=e(7750),o=Object;a.exports=function(r){return o(t(r))}},9039:function(a){a.exports=function(f){try{return!!f()}catch{return!0}}},9085:function(a,f,e){var t=e(6518),o=e(4213);t({target:"Object",stat:!0,arity:2,forced:Object.assign!==o},{assign:o})},9167:function(a,f,e){var t=e(4576);a.exports=t},9213:function(a,f,e){var t=e(6080),o=e(9504),r=e(7055),i=e(8981),l=e(6198),h=e(1469),m=o([].push),g=function(y){var E=y===1,w=y===2,b=y===3,S=y===4,x=y===6,O=y===7,A=y===5||x;return function(P,N,M,B){for(var L,R,H=i(P),U=r(H),_=l(U),ee=t(N,M),V=0,G=B||h,pe=E?G(P,_):w||O?G(P,0):void 0;_>V;V++)if((A||V in U)&&(R=ee(L=U[V],V,H),y))if(E)pe[V]=R;else if(R)switch(y){case 3:return!0;case 5:return L;case 6:return V;case 2:m(pe,L)}else switch(y){case 4:return!1;case 7:m(pe,L)}return x?-1:b||S?S:pe}};a.exports={forEach:g(0),map:g(1),filter:g(2),some:g(3),every:g(4),find:g(5),findIndex:g(6),filterReject:g(7)}},9228:function(a,f,e){e(7495);var t=e(9565),o=e(6840),r=e(7323),i=e(9039),l=e(8227),h=e(6699),m=l("species"),g=RegExp.prototype;a.exports=function(y,E,w,b){var S=l(y),x=!i(function(){var N={};return N[S]=function(){return 7},""[y](N)!==7}),O=x&&!i(function(){var N=!1,M=/a/;if(y==="split"){var B={};B[m]=function(){return M},(M={constructor:B,flags:""})[S]=/./[S]}return M.exec=function(){return N=!0,null},M[S](""),!N});if(!x||!O||w){var A=/./[S],P=E(S,""[y],function(N,M,B,L,R){var H=M.exec;return H===r||H===g.exec?x&&!R?{done:!0,value:t(A,M,B,L)}:{done:!0,value:t(N,B,M,L)}:{done:!1}});o(String.prototype,y,P[0]),o(g,S,P[1])}b&&h(g[S],"sham",!0)}},9296:function(a,f,e){var t=e(4055)("span").classList,o=t&&t.constructor&&t.constructor.prototype;a.exports=o===Object.prototype?void 0:o},9297:function(a,f,e){var t=e(9504),o=e(8981),r=t({}.hasOwnProperty);a.exports=Object.hasOwn||function(i,l){return r(o(i),l)}},9306:function(a,f,e){var t=e(4901),o=e(6823),r=TypeError;a.exports=function(i){if(t(i))return i;throw new r(o(i)+" is not a function")}},9432:function(a,f,e){var t=e(6518),o=e(8981),r=e(1072);t({target:"Object",stat:!0,forced:e(9039)(function(){r(1)})},{keys:function(i){return r(o(i))}})},9433:function(a,f,e){var t=e(4576),o=Object.defineProperty;a.exports=function(r,i){try{o(t,r,{value:i,configurable:!0,writable:!0})}catch{t[r]=i}return i}},9463:function(a,f,e){var t=e(6518),o=e(3724),r=e(4576),i=e(9504),l=e(9297),h=e(4901),m=e(1625),g=e(655),y=e(2106),E=e(7740),w=r.Symbol,b=w&&w.prototype;if(o&&h(w)&&(!("description"in b)||w().description!==void 0)){var S={},x=function(){var L=arguments.length<1||arguments[0]===void 0?void 0:g(arguments[0]),R=m(b,this)?new w(L):L===void 0?w():w(L);return L===""&&(S[R]=!0),R};E(x,w),x.prototype=b,b.constructor=x;var O=String(w("description detection"))==="Symbol(description detection)",A=i(b.valueOf),P=i(b.toString),N=/^Symbol\((.*)\)[^)]+$/,M=i("".replace),B=i("".slice);y(b,"description",{configurable:!0,get:function(){var L=A(this);if(l(S,L))return"";var R=P(L),H=O?B(R,7,-1):M(R,N,"$1");return H===""?void 0:H}}),t({global:!0,constructor:!0,forced:!0},{Symbol:x})}},9504:function(a,f,e){var t=e(616),o=Function.prototype,r=o.call,i=t&&o.bind.bind(r,r);a.exports=t?i:function(l){return function(){return r.apply(l,arguments)}}},9519:function(a,f,e){var t,o,r=e(4576),i=e(2839),l=r.process,h=r.Deno,m=l&&l.versions||h&&h.version,g=m&&m.v8;g&&(o=(t=g.split("."))[0]>0&&t[0]<4?1:+(t[0]+t[1])),!o&&i&&(!(t=i.match(/Edge\/(\d+)/))||t[1]>=74)&&(t=i.match(/Chrome\/(\d+)/))&&(o=+t[1]),a.exports=o},9539:function(a,f,e){var t=e(9565),o=e(8551),r=e(5966);a.exports=function(i,l,h){var m,g;o(i);try{if(!(m=r(i,"return"))){if(l==="throw")throw h;return h}m=t(m,i)}catch(y){g=!0,m=y}if(l==="throw")throw h;if(g)throw m;return o(m),h}},9565:function(a,f,e){var t=e(616),o=Function.prototype.call;a.exports=t?o.bind(o):function(){return o.apply(o,arguments)}},9572:function(a,f,e){var t=e(9297),o=e(6840),r=e(3640),i=e(8227)("toPrimitive"),l=Date.prototype;t(l,i)||o(l,i,r)},9617:function(a,f,e){var t=e(5397),o=e(5610),r=e(6198),i=function(l){return function(h,m,g){var y=t(h),E=r(y);if(E===0)return!l&&-1;var w,b=o(g,E);if(l&&m!=m){for(;E>b;)if((w=y[b++])!=w)return!0}else for(;E>b;b++)if((l||b in y)&&y[b]===m)return l||b||0;return!l&&-1}};a.exports={includes:i(!0),indexOf:i(!1)}},9773:function(a,f,e){var t=e(6518),o=e(4495),r=e(9039),i=e(3717),l=e(8981);t({target:"Object",stat:!0,forced:!o||r(function(){i.f(1)})},{getOwnPropertySymbols:function(h){var m=i.f;return m?m(l(h)):[]}})}},u={};function d(a){var f=u[a];if(f!==void 0)return f.exports;var e=u[a]={exports:{}};return c[a].call(e.exports,e,e.exports,d),e.exports}d.d=function(a,f){for(var e in f)d.o(f,e)&&!d.o(a,e)&&Object.defineProperty(a,e,{enumerable:!0,get:f[e]})},d.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),d.o=function(a,f){return Object.prototype.hasOwnProperty.call(a,f)},d.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var p={};d.r(p),d.d(p,{SimpleKeyboard:function(){return Nt},default:function(){return D}}),d(5276),d(8598),d(4782),d(4554),d(2010),d(7427),d(6099),d(7495),d(8781),d(5440),d(744),d(2762),typeof Element>"u"||"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),typeof self<"u"&&"document"in self&&((!("classList"in document.createElement("_"))||document.createElementNS&&!("classList"in document.createElementNS("http://www.w3.org/2000/svg","g")))&&function(a){if("Element"in a){var f="classList",e="prototype",t=a.Element[e],o=Object,r=String[e].trim||function(){return this.replace(/^\s+|\s+$/g,"")},i=Array[e].indexOf||function(w){for(var b=0,S=this.length;b<S;b++)if(b in this&&this[b]===w)return b;return-1},l=function(w,b){this.name=w,this.code=DOMException[w],this.message=b},h=function(w,b){if(b==="")throw new l("SYNTAX_ERR","The token must not be empty.");if(/\s/.test(b))throw new l("INVALID_CHARACTER_ERR","The token must not contain space characters.");return i.call(w,b)},m=function(w){for(var b=r.call(w.getAttribute("class")||""),S=b?b.split(/\s+/):[],x=0,O=S.length;x<O;x++)this.push(S[x]);this._updateClassName=function(){w.setAttribute("class",this.toString())}},g=m[e]=[],y=function(){return new m(this)};if(l[e]=Error[e],g.item=function(w){return this[w]||null},g.contains=function(w){return~h(this,w+"")},g.add=function(){var w,b=arguments,S=0,x=b.length,O=!1;do~h(this,w=b[S]+"")||(this.push(w),O=!0);while(++S<x);O&&this._updateClassName()},g.remove=function(){var w,b,S=arguments,x=0,O=S.length,A=!1;do for(b=h(this,w=S[x]+"");~b;)this.splice(b,1),A=!0,b=h(this,w);while(++x<O);A&&this._updateClassName()},g.toggle=function(w,b){var S=this.contains(w),x=S?b!==!0&&"remove":b!==!1&&"add";return x&&this[x](w),b===!0||b===!1?b:!S},g.replace=function(w,b){var S=h(w+"");~S&&(this.splice(S,1,b),this._updateClassName())},g.toString=function(){return this.join(" ")},o.defineProperty){var E={get:y,enumerable:!0,configurable:!0};try{o.defineProperty(t,f,E)}catch(w){w.number!==void 0&&w.number!==-2146823252||(E.enumerable=!1,o.defineProperty(t,f,E))}}else o[e].__defineGetter__&&t.__defineGetter__(f,y)}}(self),function(){var a=document.createElement("_");if(a.classList.add("c1","c2"),!a.classList.contains("c2")){var f=function(t){var o=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(r){var i,l=arguments.length;for(i=0;i<l;i++)r=arguments[i],o.call(this,r)}};f("add"),f("remove")}if(a.classList.toggle("c3",!1),a.classList.contains("c3")){var e=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,o){return 1 in arguments&&!this.contains(t)==!o?o:e.call(this,t)}}"replace"in document.createElement("_").classList||(DOMTokenList.prototype.replace=function(t,o){var r=this.toString().split(" "),i=r.indexOf(t+"");~i&&(r=r.slice(i),this.remove.apply(this,r),this.add(o),this.add.apply(this,r.slice(1)))}),a=null}()),d(2675),d(9463),d(2259),d(5700),d(8706),d(2008),d(3418),d(4423),d(3792),d(2062),d(6910),d(739),d(9572),d(2892),d(9085),d(3851),d(1278),d(9432),d(4864),d(1699),d(7764),d(8344),d(3500),d(2953),d(2712),d(2637),d(1480),d(825),d(1761);function v(a){return function(f){if(Array.isArray(f))return T(f)}(a)||function(f){if(typeof Symbol<"u"&&f[Symbol.iterator]!=null||f["@@iterator"]!=null)return Array.from(f)}(a)||k(a)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function k(a,f){if(a){if(typeof a=="string")return T(a,f);var e={}.toString.call(a).slice(8,-1);return e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set"?Array.from(a):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?T(a,f):void 0}}function T(a,f){(f==null||f>a.length)&&(f=a.length);for(var e=0,t=Array(f);e<f;e++)t[e]=a[e];return t}function I(a){return I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},I(a)}function C(a,f){for(var e=0;e<f.length;e++){var t=f[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(a,F(t.key),t)}}function $(a,f,e){return(f=F(f))in a?Object.defineProperty(a,f,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[f]=e,a}function F(a){var f=function(e,t){if(I(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var r=o.call(e,t);if(I(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}(a,"string");return I(f)=="symbol"?f:f+""}var j=function(){return a=function t(o){var r=o.getOptions,i=o.getCaretPosition,l=o.getCaretPositionEnd,h=o.dispatch;(function(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")})(this,t),$(this,"getOptions",void 0),$(this,"getCaretPosition",void 0),$(this,"getCaretPositionEnd",void 0),$(this,"dispatch",void 0),$(this,"maxLengthReached",void 0),$(this,"isStandardButton",function(m){return m&&!(m[0]==="{"&&m[m.length-1]==="}")}),this.getOptions=r,this.getCaretPosition=i,this.getCaretPositionEnd=l,this.dispatch=h,t.bindMethods(t,this)},f=[{key:"getButtonType",value:function(t){return t.includes("{")&&t.includes("}")&&t!=="{//}"?"functionBtn":"standardBtn"}},{key:"getButtonClass",value:function(t){var o=this.getButtonType(t),r=t.replace("{","").replace("}",""),i="";return o!=="standardBtn"&&(i=" hg-button-".concat(r)),"hg-".concat(o).concat(i)}},{key:"getDefaultDiplay",value:function(){return{"{bksp}":"backspace","{backspace}":"backspace","{enter}":"< enter","{shift}":"shift","{shiftleft}":"shift","{shiftright}":"shift","{alt}":"alt","{s}":"shift","{tab}":"tab","{lock}":"caps","{capslock}":"caps","{accept}":"Submit","{space}":" ","{//}":" ","{esc}":"esc","{escape}":"esc","{f1}":"f1","{f2}":"f2","{f3}":"f3","{f4}":"f4","{f5}":"f5","{f6}":"f6","{f7}":"f7","{f8}":"f8","{f9}":"f9","{f10}":"f10","{f11}":"f11","{f12}":"f12","{numpaddivide}":"/","{numlock}":"lock","{arrowup}":"↑","{arrowleft}":"←","{arrowdown}":"↓","{arrowright}":"→","{prtscr}":"print","{scrolllock}":"scroll","{pause}":"pause","{insert}":"ins","{home}":"home","{pageup}":"up","{delete}":"del","{forwarddelete}":"del","{end}":"end","{pagedown}":"down","{numpadmultiply}":"*","{numpadsubtract}":"-","{numpadadd}":"+","{numpadenter}":"enter","{period}":".","{numpaddecimal}":".","{numpad0}":"0","{numpad1}":"1","{numpad2}":"2","{numpad3}":"3","{numpad4}":"4","{numpad5}":"5","{numpad6}":"6","{numpad7}":"7","{numpad8}":"8","{numpad9}":"9"}}},{key:"getButtonDisplayName",value:function(t,o){return(o=arguments.length>2&&arguments[2]!==void 0&&arguments[2]?Object.assign({},this.getDefaultDiplay(),o):o||this.getDefaultDiplay())[t]||t}},{key:"getUpdatedInput",value:function(t,o,r){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r,l=arguments.length>4&&arguments[4]!==void 0&&arguments[4],h=this.getOptions(),m=[r,i,l],g=o;return(t==="{bksp}"||t==="{backspace}")&&g.length>0?g=this.removeAt.apply(this,[g].concat(m)):(t==="{delete}"||t==="{forwarddelete}")&&g.length>0?g=this.removeForwardsAt.apply(this,[g].concat(m)):t==="{space}"?g=this.addStringAt.apply(this,[g," "].concat(m)):t!=="{tab}"||typeof h.tabCharOnTab=="boolean"&&h.tabCharOnTab===!1?t!=="{enter}"&&t!=="{numpadenter}"||!h.newLineOnEnter?t.includes("numpad")&&Number.isInteger(Number(t[t.length-2]))?g=this.addStringAt.apply(this,[g,t[t.length-2]].concat(m)):t==="{numpaddivide}"?g=this.addStringAt.apply(this,[g,"/"].concat(m)):t==="{numpadmultiply}"?g=this.addStringAt.apply(this,[g,"*"].concat(m)):t==="{numpadsubtract}"?g=this.addStringAt.apply(this,[g,"-"].concat(m)):t==="{numpadadd}"?g=this.addStringAt.apply(this,[g,"+"].concat(m)):t==="{numpaddecimal}"?g=this.addStringAt.apply(this,[g,"."].concat(m)):t==="{"||t==="}"?g=this.addStringAt.apply(this,[g,t].concat(m)):t.includes("{")||t.includes("}")||(g=this.addStringAt.apply(this,[g,t].concat(m))):g=this.addStringAt.apply(this,[g,`
`].concat(m)):g=this.addStringAt.apply(this,[g,"	"].concat(m)),h.debug&&console.log("Input will be: "+g),g}},{key:"updateCaretPos",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0&&arguments[1],r=this.updateCaretPosAction(t,o);this.dispatch(function(i){i.setCaretPosition(r)})}},{key:"updateCaretPosAction",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0&&arguments[1],r=this.getOptions(),i=this.getCaretPosition();return i!=null&&(o?i>0&&(i-=t):i+=t),r.debug&&console.log("Caret at:",i),i}},{key:"addStringAt",value:function(t,o){var r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:t.length,h=arguments.length>4&&arguments[4]!==void 0&&arguments[4];return i||i===0?(r=[t.slice(0,i),o,t.slice(l)].join(""),this.isMaxLengthReached()||h&&this.updateCaretPos(o.length)):r=t+o,r}},{key:"removeAt",value:function(t){var o,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.length,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,l=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(r===0&&i===0)return t;if(r===i){var h=/([\uD800-\uDBFF][\uDC00-\uDFFF])/g;r&&r>=0?t.substring(r-2,r).match(h)?(o=t.substr(0,r-2)+t.substr(r),l&&this.updateCaretPos(2,!0)):(o=t.substr(0,r-1)+t.substr(r),l&&this.updateCaretPos(1,!0)):t.slice(-2).match(h)?(o=t.slice(0,-2),l&&this.updateCaretPos(2,!0)):(o=t.slice(0,-1),l&&this.updateCaretPos(1,!0))}else o=t.slice(0,r)+t.slice(i),l&&this.dispatch(function(m){m.setCaretPosition(r)});return o}},{key:"removeForwardsAt",value:function(t){var o,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.length,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,l=arguments.length>3&&arguments[3]!==void 0&&arguments[3];return t!=null&&t.length&&r!==null?(r===i?o=t.substring(r,r+2).match(/([\uD800-\uDBFF][\uDC00-\uDFFF])/g)?t.substr(0,r)+t.substr(r+2):t.substr(0,r)+t.substr(r+1):(o=t.slice(0,r)+t.slice(i),l&&this.dispatch(function(h){h.setCaretPosition(r)})),o):t}},{key:"handleMaxLength",value:function(t,o){var r=this.getOptions(),i=r.maxLength,l=t[r.inputName||"default"],h=o.length-1>=i;if(o.length<=l.length)return!1;if(Number.isInteger(i))return r.debug&&console.log("maxLength (num) reached:",h),h?(this.maxLengthReached=!0,!0):(this.maxLengthReached=!1,!1);if(I(i)==="object"){var m=o.length-1>=i[r.inputName||"default"];return r.debug&&console.log("maxLength (obj) reached:",m),m?(this.maxLengthReached=!0,!0):(this.maxLengthReached=!1,!1)}}},{key:"isMaxLengthReached",value:function(){return!!this.maxLengthReached}},{key:"isTouchDevice",value:function(){return"ontouchstart"in window||navigator.maxTouchPoints}},{key:"pointerEventsSupported",value:function(){return!!window.PointerEvent}},{key:"camelCase",value:function(t){return t?t.toLowerCase().trim().split(/[.\-_\s]/g).reduce(function(o,r){return r.length?o+r[0].toUpperCase()+r.slice(1):o}):""}},{key:"chunkArray",value:function(t,o){return v(Array(Math.ceil(t.length/o))).map(function(r,i){return t.slice(o*i,o+o*i)})}},{key:"escapeRegex",value:function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}},{key:"getRtlOffset",value:function(t,o){var r=t,i=o.indexOf("‫");return i<t&&i!=-1&&r--,o.indexOf("‬")<t&&i!=-1&&r--,r<0?0:r}},{key:"isConstructor",value:function(t){try{Reflect.construct(String,[],t)}catch{return!1}return!0}}],e=[{key:"bindMethods",value:function(t,o){var r,i=function(h,m){var g=typeof Symbol<"u"&&h[Symbol.iterator]||h["@@iterator"];if(!g){if(Array.isArray(h)||(g=k(h))||m){g&&(h=g);var y=0,E=function(){};return{s:E,n:function(){return y>=h.length?{done:!0}:{done:!1,value:h[y++]}},e:function(x){throw x},f:E}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var w,b=!0,S=!1;return{s:function(){g=g.call(h)},n:function(){var x=g.next();return b=x.done,x},e:function(x){S=!0,w=x},f:function(){try{b||g.return==null||g.return()}finally{if(S)throw w}}}}(Object.getOwnPropertyNames(t.prototype));try{for(i.s();!(r=i.n()).done;){var l=r.value;l==="constructor"||l==="bindMethods"||(o[l]=o[l].bind(o))}}catch(h){i.e(h)}finally{i.f()}}}],f&&C(a.prototype,f),e&&C(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a;var a,f,e}();$(j,"noop",function(){});var Y=j;function Z(a){return Z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},Z(a)}function ye(a,f){for(var e=0;e<f.length;e++){var t=f[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(a,oe(t.key),t)}}function ue(a,f,e){return(f=oe(f))in a?Object.defineProperty(a,f,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[f]=e,a}function oe(a){var f=function(e,t){if(Z(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var r=o.call(e,t);if(Z(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}(a,"string");return Z(f)=="symbol"?f:f+""}var le=function(){return a=function t(o){var r=this,i=o.dispatch,l=o.getOptions;(function(h,m){if(!(h instanceof m))throw new TypeError("Cannot call a class as a function")})(this,t),ue(this,"getOptions",void 0),ue(this,"dispatch",void 0),ue(this,"isModifierKey",function(h){return h.altKey||h.ctrlKey||h.shiftKey||["Tab","CapsLock","Esc","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(h.code||h.key||r.keyCodeToKey(h==null?void 0:h.keyCode))}),this.dispatch=i,this.getOptions=l,Y.bindMethods(t,this)},f=[{key:"handleHighlightKeyDown",value:function(t){var o=this.getOptions();o.physicalKeyboardHighlightPreventDefault&&this.isModifierKey(t)&&(t.preventDefault(),t.stopImmediatePropagation());var r=this.getSimpleKeyboardLayoutKey(t);this.dispatch(function(i){var l,h,m=i.getButtonElement(r),g=i.getButtonElement("{".concat(r,"}"));if(m)l=m,h=r;else{if(!g)return;l=g,h="{".concat(r,"}")}var y,E,w,b,S=function(O){O.style.background=o.physicalKeyboardHighlightBgColor||"#dadce4",O.style.color=o.physicalKeyboardHighlightTextColor||"black"};if(l)if(Array.isArray(l)){if(l.forEach(function(O){return S(O)}),o.physicalKeyboardHighlightPress)if(o.physicalKeyboardHighlightPressUsePointerEvents)(y=l[0])===null||y===void 0||(E=y.onpointerdown)===null||E===void 0||E.call(y,t);else if(o.physicalKeyboardHighlightPressUseClick){var x;(x=l[0])===null||x===void 0||x.click()}else i.handleButtonClicked(h,t)}else S(l),o.physicalKeyboardHighlightPress&&(o.physicalKeyboardHighlightPressUsePointerEvents?(w=l)===null||w===void 0||(b=w.onpointerdown)===null||b===void 0||b.call(w,t):o.physicalKeyboardHighlightPressUseClick?l.click():i.handleButtonClicked(h,t))})}},{key:"handleHighlightKeyUp",value:function(t){var o=this.getOptions();o.physicalKeyboardHighlightPreventDefault&&this.isModifierKey(t)&&(t.preventDefault(),t.stopImmediatePropagation());var r=this.getSimpleKeyboardLayoutKey(t);this.dispatch(function(i){var l,h,m,g=i.getButtonElement(r)||i.getButtonElement("{".concat(r,"}")),y=function(E){E.removeAttribute&&E.removeAttribute("style")};g&&(Array.isArray(g)?(g.forEach(function(E){return y(E)}),o.physicalKeyboardHighlightPressUsePointerEvents&&((l=g[0])===null||l===void 0||(h=l.onpointerup)===null||h===void 0||h.call(l,t))):(y(g),o.physicalKeyboardHighlightPressUsePointerEvents&&(g==null||(m=g.onpointerup)===null||m===void 0||m.call(g,t))))})}},{key:"getSimpleKeyboardLayoutKey",value:function(t){var o,r="",i=t.code||t.key||this.keyCodeToKey(t==null?void 0:t.keyCode);return(r=i!=null&&i.includes("Numpad")||i!=null&&i.includes("Shift")||i!=null&&i.includes("Space")||i!=null&&i.includes("Backspace")||i!=null&&i.includes("Control")||i!=null&&i.includes("Alt")||i!=null&&i.includes("Meta")?t.code||"":t.key||this.keyCodeToKey(t==null?void 0:t.keyCode)||"").length>1?(o=r)===null||o===void 0?void 0:o.toLowerCase():r}},{key:"keyCodeToKey",value:function(t){return{8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"Meta",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9",106:"NumpadMultiply",107:"NumpadAdd",109:"NumpadSubtract",110:"NumpadDecimal",111:"NumpadDivide",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}[t]||""}}],f&&ye(a.prototype,f),e&&ye(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a;var a,f,e}();function ge(a){return ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},ge(a)}function St(a,f){for(var e=0;e<f.length;e++){var t=f[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(a,nt(t.key),t)}}function Fe(a,f,e){return(f=nt(f))in a?Object.defineProperty(a,f,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[f]=e,a}function nt(a){var f=function(e,t){if(ge(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var r=o.call(e,t);if(ge(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}(a,"string");return ge(f)=="symbol"?f:f+""}var kt=function(){return a=function t(o){var r=o.utilities,i=o.options;(function(l,h){if(!(l instanceof h))throw new TypeError("Cannot call a class as a function")})(this,t),Fe(this,"utilities",void 0),Fe(this,"options",void 0),Fe(this,"candidateBoxElement",void 0),Fe(this,"pageIndex",0),Fe(this,"pageSize",void 0),this.utilities=r,this.options=i,Y.bindMethods(t,this),this.pageSize=this.utilities.getOptions().layoutCandidatesPageSize||5},f=[{key:"destroy",value:function(){this.candidateBoxElement&&(this.candidateBoxElement.remove(),this.pageIndex=0)}},{key:"show",value:function(t){var o=this,r=t.candidateValue,i=t.targetElement,l=t.onSelect;if(r&&r.length){var h=this.utilities.chunkArray(r.split(" "),this.pageSize);this.renderPage({candidateListPages:h,targetElement:i,pageIndex:this.pageIndex,nbPages:h.length,onItemSelected:function(m,g){l(m,g),o.destroy()}})}}},{key:"renderPage",value:function(t){var o,r=this,i=t.candidateListPages,l=t.targetElement,h=t.pageIndex,m=t.nbPages,g=t.onItemSelected;(o=this.candidateBoxElement)===null||o===void 0||o.remove(),this.candidateBoxElement=document.createElement("div"),this.candidateBoxElement.className="hg-candidate-box";var y=document.createElement("ul");y.className="hg-candidate-box-list",i[h].forEach(function(A){var P,N=document.createElement("li"),M=function(){var B=new(r.options.useTouchEvents?TouchEvent:MouseEvent)("click");return Object.defineProperty(B,"target",{value:N}),B};N.className="hg-candidate-box-list-item",N.innerHTML=((P=r.options.display)===null||P===void 0?void 0:P[A])||A,r.options.useTouchEvents?N.ontouchstart=function(B){return g(A,B||M())}:N.onclick=function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:M();return g(A,B)},y.appendChild(N)});var E=h>0,w=document.createElement("div");w.classList.add("hg-candidate-box-prev"),E&&w.classList.add("hg-candidate-box-btn-active");var b=function(){E&&r.renderPage({candidateListPages:i,targetElement:l,pageIndex:h-1,nbPages:m,onItemSelected:g})};this.options.useTouchEvents?w.ontouchstart=b:w.onclick=b,this.candidateBoxElement.appendChild(w),this.candidateBoxElement.appendChild(y);var S=h<m-1,x=document.createElement("div");x.classList.add("hg-candidate-box-next"),S&&x.classList.add("hg-candidate-box-btn-active");var O=function(){S&&r.renderPage({candidateListPages:i,targetElement:l,pageIndex:h+1,nbPages:m,onItemSelected:g})};this.options.useTouchEvents?x.ontouchstart=O:x.onclick=O,this.candidateBoxElement.appendChild(x),l.prepend(this.candidateBoxElement)}}],f&&St(a.prototype,f),e&&St(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a;var a,f,e}(),ot=kt;function Ke(a){return function(f){if(Array.isArray(f))return ze(f)}(a)||function(f){if(typeof Symbol<"u"&&f[Symbol.iterator]!=null||f["@@iterator"]!=null)return Array.from(f)}(a)||function(f,e){if(f){if(typeof f=="string")return ze(f,e);var t={}.toString.call(f).slice(8,-1);return t==="Object"&&f.constructor&&(t=f.constructor.name),t==="Map"||t==="Set"?Array.from(f):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?ze(f,e):void 0}}(a)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ze(a,f){(f==null||f>a.length)&&(f=a.length);for(var e=0,t=Array(f);e<f;e++)t[e]=a[e];return t}function Ve(a){return Ve=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},Ve(a)}function Mt(a,f){var e=Object.keys(a);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(a);f&&(t=t.filter(function(o){return Object.getOwnPropertyDescriptor(a,o).enumerable})),e.push.apply(e,t)}return e}function Wt(a,f){for(var e=0;e<f.length;e++){var t=f[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(a,Yt(t.key),t)}}function he(a,f,e){return(f=Yt(f))in a?Object.defineProperty(a,f,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[f]=e,a}function Yt(a){var f=function(e,t){if(Ve(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var r=o.call(e,t);if(Ve(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}(a,"string");return Ve(f)=="symbol"?f:f+""}var Xt=function(){return a=function t(o,r){var i=this;if(function(b,S){if(!(b instanceof S))throw new TypeError("Cannot call a class as a function")}(this,t),he(this,"input",void 0),he(this,"options",void 0),he(this,"utilities",void 0),he(this,"caretPosition",void 0),he(this,"caretPositionEnd",void 0),he(this,"keyboardDOM",void 0),he(this,"keyboardPluginClasses",void 0),he(this,"keyboardDOMClass",void 0),he(this,"buttonElements",void 0),he(this,"currentInstanceName",void 0),he(this,"allKeyboardInstances",void 0),he(this,"keyboardInstanceNames",void 0),he(this,"isFirstKeyboardInstance",void 0),he(this,"physicalKeyboard",void 0),he(this,"modules",void 0),he(this,"activeButtonClass",void 0),he(this,"holdInteractionTimeout",void 0),he(this,"holdTimeout",void 0),he(this,"isMouseHold",void 0),he(this,"initialized",void 0),he(this,"candidateBox",void 0),he(this,"keyboardRowsDOM",void 0),he(this,"defaultName","default"),he(this,"activeInputElement",null),he(this,"handleParams",function(b,S){var x,O,A;if(typeof b=="string")x=b.split(".").join(""),O=document.querySelector(".".concat(x)),A=S;else if(b instanceof HTMLDivElement){if(!b.className)throw console.warn("Any DOM element passed as parameter must have a class."),new Error("KEYBOARD_DOM_CLASS_ERROR");x=b.className.split(" ")[0],O=b,A=S}else x="simple-keyboard",O=document.querySelector(".".concat(x)),A=b;return{keyboardDOMClass:x,keyboardDOM:O,options:A}}),he(this,"getOptions",function(){return i.options}),he(this,"getCaretPosition",function(){return i.caretPosition}),he(this,"getCaretPositionEnd",function(){return i.caretPositionEnd}),he(this,"registerModule",function(b,S){i.modules[b]||(i.modules[b]={}),S(i.modules[b])}),he(this,"getKeyboardClassString",function(){for(var b=arguments.length,S=new Array(b),x=0;x<b;x++)S[x]=arguments[x];return[i.keyboardDOMClass].concat(S).filter(function(O){return!!O}).join(" ")}),typeof window<"u"){var l=this.handleParams(o,r),h=l.keyboardDOMClass,m=l.keyboardDOM,g=l.options,y=g===void 0?{}:g;this.utilities=new Y({getOptions:this.getOptions,getCaretPosition:this.getCaretPosition,getCaretPositionEnd:this.getCaretPositionEnd,dispatch:this.dispatch}),this.caretPosition=null,this.caretPositionEnd=null,this.keyboardDOM=m,this.options=function(b){for(var S=1;S<arguments.length;S++){var x=arguments[S]!=null?arguments[S]:{};S%2?Mt(Object(x),!0).forEach(function(O){he(b,O,x[O])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(x)):Mt(Object(x)).forEach(function(O){Object.defineProperty(b,O,Object.getOwnPropertyDescriptor(x,O))})}return b}({layoutName:"default",theme:"hg-theme-default",inputName:"default",preventMouseDownDefault:!1,enableLayoutCandidates:!0,excludeFromLayout:{}},y),this.keyboardPluginClasses="",Y.bindMethods(t,this);var E=this.options.inputName,w=E===void 0?this.defaultName:E;if(this.input={},this.input[w]="",this.keyboardDOMClass=h,this.buttonElements={},window.SimpleKeyboardInstances||(window.SimpleKeyboardInstances={}),this.currentInstanceName=this.utilities.camelCase(this.keyboardDOMClass),window.SimpleKeyboardInstances[this.currentInstanceName]=this,this.allKeyboardInstances=window.SimpleKeyboardInstances,this.keyboardInstanceNames=Object.keys(window.SimpleKeyboardInstances),this.isFirstKeyboardInstance=this.keyboardInstanceNames[0]===this.currentInstanceName,this.physicalKeyboard=new le({dispatch:this.dispatch,getOptions:this.getOptions}),this.candidateBox=this.options.enableLayoutCandidates?new ot({utilities:this.utilities,options:this.options}):null,!this.keyboardDOM)throw console.warn('".'.concat(h,'" was not found in the DOM.')),new Error("KEYBOARD_DOM_ERROR");this.render(),this.modules={},this.loadModules()}},f=[{key:"setCaretPosition",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t;this.caretPosition=t,this.caretPositionEnd=o}},{key:"getInputCandidates",value:function(t){var o=this,r=this.options,i=r.layoutCandidates,l=r.layoutCandidatesCaseSensitiveMatch;if(!i||Ve(i)!=="object")return{};var h=Object.keys(i).filter(function(y){var E=t.substring(0,o.getCaretPositionEnd()||0)||t,w=new RegExp("".concat(o.utilities.escapeRegex(y),"$"),l?"g":"gi");return!!Ke(E.matchAll(w)).length});if(h.length>1){var m=h.sort(function(y,E){return E.length-y.length})[0];return{candidateKey:m,candidateValue:i[m]}}if(h.length){var g=h[0];return{candidateKey:g,candidateValue:i[g]}}return{}}},{key:"showCandidatesBox",value:function(t,o,r){var i=this;this.candidateBox&&this.candidateBox.show({candidateValue:o,targetElement:r,onSelect:function(l,h){var m=i.options,g=m.layoutCandidatesCaseSensitiveMatch,y=m.disableCandidateNormalization,E=m.enableLayoutCandidatesKeyPress,w=l;y||(w=l.normalize("NFD")),typeof i.options.beforeInputUpdate=="function"&&i.options.beforeInputUpdate(i);var b=i.getInput(i.options.inputName,!0),S=i.getCaretPositionEnd()||0,x=b.substring(0,S||0)||b,O=new RegExp("".concat(i.utilities.escapeRegex(t),"$"),g?"g":"gi"),A=x.replace(O,w),P=b.replace(x,A),N=A.length-x.length,M=(S||b.length)+N;M<0&&(M=0),i.setInput(P,i.options.inputName,!0),i.setCaretPosition(M),E&&typeof i.options.onKeyPress=="function"&&i.options.onKeyPress(l,h),typeof i.options.onChange=="function"&&i.options.onChange(i.getInput(i.options.inputName,!0),h),typeof i.options.onChangeAll=="function"&&i.options.onChangeAll(i.getAllInputs(),h)}})}},{key:"handleButtonClicked",value:function(t,o){var r=this.options,i=r.inputName,l=i===void 0?this.defaultName:i,h=r.debug;if(t!=="{//}"){this.input[l]||(this.input[l]=""),typeof this.options.beforeInputUpdate=="function"&&this.options.beforeInputUpdate(this);var m=this.utilities.getUpdatedInput(t,this.input[l],this.caretPosition,this.caretPositionEnd);if(this.utilities.isStandardButton(t)&&this.activeInputElement&&this.input[l]&&this.input[l]===m&&this.caretPosition===0&&this.caretPositionEnd===m.length)return this.setInput("",this.options.inputName,!0),this.setCaretPosition(0),this.activeInputElement.value="",this.activeInputElement.setSelectionRange(0,0),void this.handleButtonClicked(t,o);if(typeof this.options.onKeyPress=="function"&&this.options.onKeyPress(t,o),this.input[l]!==m&&(!this.options.inputPattern||this.options.inputPattern&&this.inputPatternIsValid(m))){if(this.options.maxLength&&this.utilities.handleMaxLength(this.input,m))return;var g=this.utilities.getUpdatedInput(t,this.input[l],this.caretPosition,this.caretPositionEnd,!0);if(this.setInput(g,this.options.inputName,!0),h&&console.log("Input changed:",this.getAllInputs()),this.options.debug&&console.log("Caret at: ",this.getCaretPosition(),this.getCaretPositionEnd(),"(".concat(this.keyboardDOMClass,")"),o==null?void 0:o.type),this.options.syncInstanceInputs&&this.syncInstanceInputs(),typeof this.options.onChange=="function"&&this.options.onChange(this.getInput(this.options.inputName,!0),o),typeof this.options.onChangeAll=="function"&&this.options.onChangeAll(this.getAllInputs(),o),o!=null&&o.target&&this.options.enableLayoutCandidates){var y,E=this.getInputCandidates(m),w=E.candidateKey,b=E.candidateValue;w&&b?this.showCandidatesBox(w,b,this.keyboardDOM):(y=this.candidateBox)===null||y===void 0||y.destroy()}}this.caretPositionEnd&&this.caretPosition!==this.caretPositionEnd&&(this.setCaretPosition(this.caretPositionEnd,this.caretPositionEnd),this.activeInputElement&&this.activeInputElement.setSelectionRange(this.caretPositionEnd,this.caretPositionEnd),this.options.debug&&console.log("Caret position aligned",this.caretPosition)),h&&console.log("Key pressed:",t)}}},{key:"getMouseHold",value:function(){return this.isMouseHold}},{key:"setMouseHold",value:function(t){this.options.syncInstanceInputs?this.dispatch(function(o){o.isMouseHold=t}):this.isMouseHold=t}},{key:"handleButtonMouseDown",value:function(t,o){var r=this;o&&(this.options.preventMouseDownDefault&&o.preventDefault(),this.options.stopMouseDownPropagation&&o.stopPropagation(),o.target.classList.add(this.activeButtonClass)),this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),this.holdTimeout&&clearTimeout(this.holdTimeout),this.setMouseHold(!0),this.options.disableButtonHold||(this.holdTimeout=window.setTimeout(function(){(r.getMouseHold()&&(!t.includes("{")&&!t.includes("}")||t==="{delete}"||t==="{backspace}"||t==="{bksp}"||t==="{space}"||t==="{tab}")||t==="{arrowright}"||t==="{arrowleft}"||t==="{arrowup}"||t==="{arrowdown}")&&(r.options.debug&&console.log("Button held:",t),r.handleButtonHold(t)),clearTimeout(r.holdTimeout)},500))}},{key:"handleButtonMouseUp",value:function(t,o){var r=this;o&&(this.options.preventMouseUpDefault&&o.preventDefault&&o.preventDefault(),this.options.stopMouseUpPropagation&&o.stopPropagation&&o.stopPropagation(),!(o.target===this.keyboardDOM||o.target&&this.keyboardDOM.contains(o.target)||this.candidateBox&&this.candidateBox.candidateBoxElement&&(o.target===this.candidateBox.candidateBoxElement||o.target&&this.candidateBox.candidateBoxElement.contains(o.target)))&&this.candidateBox&&this.candidateBox.destroy()),this.recurseButtons(function(i){i.classList.remove(r.activeButtonClass)}),this.setMouseHold(!1),this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),t&&typeof this.options.onKeyReleased=="function"&&this.options.onKeyReleased(t,o)}},{key:"handleKeyboardContainerMouseDown",value:function(t){this.options.preventMouseDownDefault&&t.preventDefault()}},{key:"handleButtonHold",value:function(t){var o=this;this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),this.holdInteractionTimeout=window.setTimeout(function(){o.getMouseHold()?(o.handleButtonClicked(t),o.handleButtonHold(t)):clearTimeout(o.holdInteractionTimeout)},100)}},{key:"syncInstanceInputs",value:function(){var t=this;this.dispatch(function(o){o.replaceInput(t.input),o.setCaretPosition(t.caretPosition,t.caretPositionEnd)})}},{key:"clearInput",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.inputName||this.defaultName;this.input[t]="",this.setCaretPosition(0),this.options.syncInstanceInputs&&this.syncInstanceInputs()}},{key:"getInput",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.inputName||this.defaultName,o=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return this.options.syncInstanceInputs&&!o&&this.syncInstanceInputs(),this.options.rtl?"‫"+this.input[t].replace("‫","").replace("‬","")+"‬":this.input[t]}},{key:"getAllInputs",value:function(){var t=this,o={};return Object.keys(this.input).forEach(function(r){o[r]=t.getInput(r,!0)}),o}},{key:"setInput",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.inputName||this.defaultName,r=arguments.length>2?arguments[2]:void 0;this.input[o]=t,!r&&this.options.syncInstanceInputs&&this.syncInstanceInputs()}},{key:"replaceInput",value:function(t){this.input=t}},{key:"setOptions",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=this.changedOptions(t);this.options=Object.assign(this.options,t),o.length&&(this.options.debug&&console.log("changedOptions",o),this.onSetOptions(o),this.render())}},{key:"changedOptions",value:function(t){var o=this;return Object.keys(t).filter(function(r){return JSON.stringify(t[r])!==JSON.stringify(o.options[r])})}},{key:"onSetOptions",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];t.includes("layoutName")&&this.candidateBox&&this.candidateBox.destroy(),(t.includes("layoutCandidatesPageSize")||t.includes("layoutCandidates"))&&this.candidateBox&&(this.candidateBox.destroy(),this.candidateBox=new ot({utilities:this.utilities,options:this.options}))}},{key:"resetRows",value:function(){this.keyboardRowsDOM&&this.keyboardRowsDOM.remove(),this.keyboardDOM.className=this.keyboardDOMClass,this.keyboardDOM.setAttribute("data-skInstance",this.currentInstanceName),this.buttonElements={}}},{key:"dispatch",value:function(t){if(!window.SimpleKeyboardInstances)throw console.warn("SimpleKeyboardInstances is not defined. Dispatch cannot be called."),new Error("INSTANCES_VAR_ERROR");return Object.keys(window.SimpleKeyboardInstances).forEach(function(o){t(window.SimpleKeyboardInstances[o],o)})}},{key:"addButtonTheme",value:function(t,o){var r=this;o&&t&&(t.split(" ").forEach(function(i){o.split(" ").forEach(function(l){r.options.buttonTheme||(r.options.buttonTheme=[]);var h=!1;r.options.buttonTheme.map(function(m){if(m!=null&&m.class.split(" ").includes(l)){h=!0;var g=m.buttons.split(" ");g.includes(i)||(h=!0,g.push(i),m.buttons=g.join(" "))}return m}),h||r.options.buttonTheme.push({class:l,buttons:t})})}),this.render())}},{key:"removeButtonTheme",value:function(t,o){var r=this;if(!t&&!o)return this.options.buttonTheme=[],void this.render();t&&Array.isArray(this.options.buttonTheme)&&this.options.buttonTheme.length&&(t.split(" ").forEach(function(i){var l;(l=r.options)===null||l===void 0||(l=l.buttonTheme)===null||l===void 0||l.map(function(h,m){if(h&&o&&o.includes(h.class)||!o){var g,y,E=(g=h)===null||g===void 0?void 0:g.buttons.split(" ").filter(function(w){return w!==i});h&&E!=null&&E.length?h.buttons=E.join(" "):((y=r.options.buttonTheme)===null||y===void 0||y.splice(m,1),h=null)}return h})}),this.render())}},{key:"getButtonElement",value:function(t){var o,r=this.buttonElements[t];return r&&(o=r.length>1?r:r[0]),o}},{key:"inputPatternIsValid",value:function(t){var o,r=this.options.inputPattern;if((o=r instanceof RegExp?r:r[this.options.inputName||this.defaultName])&&t){var i=o.test(t);return this.options.debug&&console.log('inputPattern ("'.concat(o,'"): ').concat(i?"passed":"did not pass!")),i}return!0}},{key:"setEventListeners",value:function(){if(this.isFirstKeyboardInstance||!this.allKeyboardInstances){this.options.debug&&console.log("Caret handling started (".concat(this.keyboardDOMClass,")"));var t=this.options.physicalKeyboardHighlightPreventDefault,o=t!==void 0&&t;document.addEventListener("keyup",this.handleKeyUp,o),document.addEventListener("keydown",this.handleKeyDown,o),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchend",this.handleTouchEnd),this.options.updateCaretOnSelectionChange&&document.addEventListener("selectionchange",this.handleSelectionChange),document.addEventListener("select",this.handleSelect)}}},{key:"handleKeyUp",value:function(t){this.caretEventHandler(t),this.options.physicalKeyboardHighlight&&this.physicalKeyboard.handleHighlightKeyUp(t)}},{key:"handleKeyDown",value:function(t){this.options.physicalKeyboardHighlight&&this.physicalKeyboard.handleHighlightKeyDown(t)}},{key:"handleMouseUp",value:function(t){this.caretEventHandler(t)}},{key:"handleTouchEnd",value:function(t){this.caretEventHandler(t)}},{key:"handleSelect",value:function(t){this.caretEventHandler(t)}},{key:"handleSelectionChange",value:function(t){navigator.userAgent.includes("Firefox")||this.caretEventHandler(t)}},{key:"caretEventHandler",value:function(t){var o,r=this;t.target.tagName&&(o=t.target.tagName.toLowerCase()),this.dispatch(function(i){var l=t.target===i.keyboardDOM||t.target&&i.keyboardDOM.contains(t.target);if(r.options.syncInstanceInputs&&Array.isArray(t.path)&&(l=t.path.some(function(g){var y;return g==null||(y=g.hasAttribute)===null||y===void 0?void 0:y.call(g,"data-skInstance")})),(o==="textarea"||o==="input"&&["text","search","url","tel","password"].includes(t.target.type))&&!i.options.disableCaretPositioning){var h=t.target.selectionStart,m=t.target.selectionEnd;i.options.rtl&&(h=i.utilities.getRtlOffset(h,i.getInput()),m=i.utilities.getRtlOffset(m,i.getInput())),i.setCaretPosition(h,m),i.activeInputElement=t.target,i.options.debug&&console.log("Caret at: ",i.getCaretPosition(),i.getCaretPositionEnd(),t&&t.target.tagName.toLowerCase(),"(".concat(i.keyboardDOMClass,")"),t==null?void 0:t.type)}else!i.options.disableCaretPositioning&&l||(t==null?void 0:t.type)==="selectionchange"||(i.setCaretPosition(null),i.activeInputElement=null,i.options.debug&&console.log('Caret position reset due to "'.concat(t==null?void 0:t.type,'" event'),t))})}},{key:"recurseButtons",value:function(t){var o=this;t&&Object.keys(this.buttonElements).forEach(function(r){return o.buttonElements[r].forEach(t)})}},{key:"destroy",value:function(){this.options.debug&&console.log("Destroying simple-keyboard instance: ".concat(this.currentInstanceName));var t=this.options.physicalKeyboardHighlightPreventDefault,o=t!==void 0&&t;document.removeEventListener("keyup",this.handleKeyUp,o),document.removeEventListener("keydown",this.handleKeyDown,o),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchend",this.handleTouchEnd),document.removeEventListener("select",this.handleSelect),this.options.updateCaretOnSelectionChange&&document.removeEventListener("selectionchange",this.handleSelectionChange),document.onpointerup=null,document.ontouchend=null,document.ontouchcancel=null,document.onmouseup=null,this.recurseButtons(function(r){r&&(r.onpointerdown=null,r.onpointerup=null,r.onpointercancel=null,r.ontouchstart=null,r.ontouchend=null,r.ontouchcancel=null,r.onclick=null,r.onmousedown=null,r.onmouseup=null,r.remove(),r=null)}),this.keyboardDOM.onpointerdown=null,this.keyboardDOM.ontouchstart=null,this.keyboardDOM.onmousedown=null,this.resetRows(),this.candidateBox&&(this.candidateBox.destroy(),this.candidateBox=null),this.activeInputElement=null,this.keyboardDOM.removeAttribute("data-skInstance"),this.keyboardDOM.innerHTML="",window.SimpleKeyboardInstances[this.currentInstanceName]=null,delete window.SimpleKeyboardInstances[this.currentInstanceName],this.initialized=!1}},{key:"getButtonThemeClasses",value:function(t){var o=this.options.buttonTheme,r=[];return Array.isArray(o)&&o.forEach(function(i){if(i&&i.class&&typeof i.class=="string"&&i.buttons&&typeof i.buttons=="string"){var l=i.class.split(" ");i.buttons.split(" ").includes(t)&&(r=[].concat(Ke(r),Ke(l)))}else console.warn('Incorrect "buttonTheme". Please check the documentation.',i)}),r}},{key:"setDOMButtonAttributes",value:function(t,o){var r=this.options.buttonAttributes;Array.isArray(r)&&r.forEach(function(i){i.attribute&&typeof i.attribute=="string"&&i.value&&typeof i.value=="string"?i.buttons&&typeof i.buttons=="string"?i.buttons.split(" ").includes(t)&&o(i.attribute,i.value):o(i.attribute,i.value):console.warn('Incorrect "buttonAttributes". Please check the documentation.',i)})}},{key:"onTouchDeviceDetected",value:function(){this.processAutoTouchEvents(),this.disableContextualWindow()}},{key:"disableContextualWindow",value:function(){window.oncontextmenu=function(t){var o;if((o=t.target.classList)!==null&&o!==void 0&&o.contains("hg-button"))return t.preventDefault(),t.stopPropagation(),!1}}},{key:"processAutoTouchEvents",value:function(){this.options.autoUseTouchEvents&&(this.options.useTouchEvents=!0,this.options.debug&&console.log("autoUseTouchEvents: Touch device detected, useTouchEvents enabled."))}},{key:"onInit",value:function(){this.options.debug&&console.log("".concat(this.keyboardDOMClass," Initialized")),this.setEventListeners(),typeof this.options.onInit=="function"&&this.options.onInit(this)}},{key:"beforeFirstRender",value:function(){this.utilities.isTouchDevice()&&this.onTouchDeviceDetected(),typeof this.options.beforeFirstRender=="function"&&this.options.beforeFirstRender(this),this.isFirstKeyboardInstance&&this.utilities.pointerEventsSupported()&&!this.options.useTouchEvents&&!this.options.useMouseEvents&&this.options.debug&&console.log("Using PointerEvents as it is supported by this browser"),this.options.useTouchEvents&&this.options.debug&&console.log("useTouchEvents has been enabled. Only touch events will be used.")}},{key:"beforeRender",value:function(){typeof this.options.beforeRender=="function"&&this.options.beforeRender(this)}},{key:"onRender",value:function(){typeof this.options.onRender=="function"&&this.options.onRender(this)}},{key:"onModulesLoaded",value:function(){typeof this.options.onModulesLoaded=="function"&&this.options.onModulesLoaded(this)}},{key:"loadModules",value:function(){var t=this;Array.isArray(this.options.modules)&&(this.options.modules.forEach(function(o){var r=t.utilities.isConstructor(o)?new o(t):o(t);r.init&&r.init(t)}),this.keyboardPluginClasses="modules-loaded",this.render(),this.onModulesLoaded())}},{key:"getModuleProp",value:function(t,o){return!!this.modules[t]&&this.modules[t][o]}},{key:"getModulesList",value:function(){return Object.keys(this.modules)}},{key:"parseRowDOMContainers",value:function(t,o,r,i){var l=this,h=Array.from(t.children),m=0;return h.length&&r.forEach(function(g,y){var E=i[y];if(!(E&&E>g))return!1;var w=g-m,b=E-m,S=document.createElement("div");S.className+="hg-button-container";var x="".concat(l.options.layoutName,"-r").concat(o,"c").concat(y);S.setAttribute("data-skUID",x);var O=h.splice(w,b-w+1);m+=b-w,O.forEach(function(A){return S.appendChild(A)}),h.splice(w,0,S),t.innerHTML="",h.forEach(function(A){return t.appendChild(A)}),l.options.debug&&console.log("rowDOMContainer",O,w,b,m+1)}),t}},{key:"render",value:function(){var t=this;this.resetRows(),this.initialized||this.beforeFirstRender(),this.beforeRender();var o="hg-layout-".concat(this.options.layoutName),r=this.options.layout||{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]},i=this.options.useTouchEvents||!1,l=i?"hg-touch-events":"",h=this.options.useMouseEvents||!1,m=this.options.disableRowButtonContainers;this.keyboardDOM.className=this.getKeyboardClassString(this.options.theme,o,this.keyboardPluginClasses,l),this.keyboardDOM.setAttribute("data-skInstance",this.currentInstanceName),this.keyboardRowsDOM=document.createElement("div"),this.keyboardRowsDOM.className="hg-rows",r[this.options.layoutName||this.defaultName].forEach(function(g,y){var E=g.split(" ");t.options.excludeFromLayout&&t.options.excludeFromLayout[t.options.layoutName||t.defaultName]&&(E=E.filter(function(x){return t.options.excludeFromLayout&&!t.options.excludeFromLayout[t.options.layoutName||t.defaultName].includes(x)}));var w=document.createElement("div");w.className+="hg-row";var b=[],S=[];E.forEach(function(x,O){var A,P=!m&&typeof x=="string"&&x.length>1&&x.indexOf("[")===0,N=!m&&typeof x=="string"&&x.length>1&&x.indexOf("]")===x.length-1;P&&(b.push(O),x=x.replace(/\[/g,"")),N&&(S.push(O),x=x.replace(/\]/g,""));var M=t.utilities.getButtonClass(x),B=t.utilities.getButtonDisplayName(x,t.options.display,t.options.mergeDisplay),L=t.options.useButtonTag?"button":"div",R=document.createElement(L);R.className+="hg-button ".concat(M),(A=R.classList).add.apply(A,Ke(t.getButtonThemeClasses(x))),t.setDOMButtonAttributes(x,function(_,ee){R.setAttribute(_,ee)}),t.activeButtonClass="hg-activeButton",!t.utilities.pointerEventsSupported()||i||h?i?(R.ontouchstart=function(_){t.handleButtonClicked(x,_),t.handleButtonMouseDown(x,_)},R.ontouchend=function(_){t.handleButtonMouseUp(x,_)},R.ontouchcancel=function(_){t.handleButtonMouseUp(x,_)}):(R.onclick=function(_){t.setMouseHold(!1),typeof t.options.onKeyReleased=="function"||t.options.useMouseEvents&&t.options.clickOnMouseDown||t.handleButtonClicked(x,_)},R.onmousedown=function(_){(typeof t.options.onKeyReleased=="function"||t.options.useMouseEvents&&t.options.clickOnMouseDown)&&!t.isMouseHold&&t.handleButtonClicked(x,_),t.handleButtonMouseDown(x,_)},R.onmouseup=function(_){t.handleButtonMouseUp(x,_)}):(R.onpointerdown=function(_){t.handleButtonClicked(x,_),t.handleButtonMouseDown(x,_)},R.onpointerup=function(_){t.handleButtonMouseUp(x,_)},R.onpointercancel=function(_){t.handleButtonMouseUp(x,_)}),R.setAttribute("data-skBtn",x);var H="".concat(t.options.layoutName,"-r").concat(y,"b").concat(O);R.setAttribute("data-skBtnUID",H);var U=document.createElement("span");U.innerHTML=B,R.appendChild(U),t.buttonElements[x]||(t.buttonElements[x]=[]),t.buttonElements[x].push(R),w.appendChild(R)}),w=t.parseRowDOMContainers(w,y,b,S),t.keyboardRowsDOM.appendChild(w)}),this.keyboardDOM.appendChild(this.keyboardRowsDOM),this.onRender(),this.initialized||(this.initialized=!0,!this.utilities.pointerEventsSupported()||i||h?i?(document.ontouchend=function(g){return t.handleButtonMouseUp(void 0,g)},document.ontouchcancel=function(g){return t.handleButtonMouseUp(void 0,g)},this.keyboardDOM.ontouchstart=function(g){return t.handleKeyboardContainerMouseDown(g)}):i||(document.onmouseup=function(g){return t.handleButtonMouseUp(void 0,g)},this.keyboardDOM.onmousedown=function(g){return t.handleKeyboardContainerMouseDown(g)}):(document.onpointerup=function(g){return t.handleButtonMouseUp(void 0,g)},this.keyboardDOM.onpointerdown=function(g){return t.handleKeyboardContainerMouseDown(g)}),this.onInit())}}],f&&Wt(a.prototype,f),e&&Wt(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a;var a,f,e}(),Nt=Xt,D=Nt;return p}()})})(ko);var Ni=ko.exports;const Ri=Mi(Ni);let Ht=null,st=null;const Li={default:["/ ' ק ר א ט ו ן ם פ {bksp}","ש ד ג כ ע י ח ל ך ף ,","ז ס ב ה נ מ צ ת ץ .","{space}"]};function _i(n){st=n;let s=document.getElementById("hebrew-keyboard-container");s||(s=document.createElement("div"),s.id="hebrew-keyboard-container",s.className="hebrew-keyboard-container",document.body.appendChild(s)),Ht?st=n:Ht=new Ri(s,{layout:Li,theme:"hg-theme-default hebrew-keyboard-theme",display:{"{bksp}":"⌫","{space}":" "},onChange:c=>{st&&(st.value=c,st.dispatchEvent(new Event("input",{bubbles:!0})))},onKeyPress:c=>{c==="{bksp}"&&Bi()}}),Ht.setInput(n.value),Di(n,s),s.style.display="block"}function Di(n,s){const c=document.getElementById("controls");if(!c)return;const u=c.getBoundingClientRect();s.style.left=`${u.right+16}px`,s.style.top=`${u.top}px`}function Bi(){if(st&&Ht){const s=st.value.slice(0,-1);st.value=s,Ht.setInput(s),st.dispatchEvent(new Event("input",{bubbles:!0}))}}function Wn(){const n=document.getElementById("hebrew-keyboard-container");n&&(n.style.display="none")}function dn(){const n=document.getElementById("hebrew-keyboard-container");return n?n.style.display==="block":!1}function Co(n){return`rgb(${Math.round(n[0]*255)}, ${Math.round(n[1]*255)}, ${Math.round(n[2]*255)})`}let To=[],He="",Se=[],tt=[],an=new Map,Tt=!1,Xe="substring",Qe=null,sn=null,At=[],Ft=[],xt=[],ve=null,qe=null,yt=null,Ue=null,Pe=null,_e=null,bt=null;function $i(n){var s;To=n.verses,(s=n.callbacks)!=null&&s.onVerseClick&&(sn=n.callbacks.onVerseClick)}function Bt(n){if(He=n,Se=io(n),Se.length===0)tt=[],an=new Map,At=[],Ft=[],xt=[];else{const s=at(Se[0]);if(s&&Xe==="root"){At=[],Ft=[],xt=[];for(const u of Se){const d=ao(u);if(At.push(d!==null&&d.length>0),Ft.push(d),d&&d.length>0){const p=cr(d[0]);xt.push(p)}else xt.push(null)}}else At=[],Ft=[],xt=[];const c=Tt&&Se.length>0&&!s;tt=hr(n,c,s?Xe:"substring"),an=vr(tt)}Ao(),Qe==null||Qe()}function Ao(){if(!Ue)return;Ue.querySelectorAll(".search-result").forEach(u=>u.remove());const s=Ue.querySelector("#search-count");if(tt.length===0){Ue.classList.remove("visible"),s&&(s.textContent="");return}if(s){const u=Se.length>1?` (${Se.length} terms)`:"";s.textContent=`${tt.length}${tt.length>=100?"+":""} results${u}`}const c=tt.slice(0,10);for(const u of c){const d=document.createElement("div");d.className="search-result";const p=document.createElement("div");p.className="ref";const v=document.createElement("span");v.className="term-indicators";for(const C of u.matchingTerms){const $=document.createElement("span");$.className="term-dot";const F=Ct[C.termIndex%Ct.length];$.style.background=Co(F),v.appendChild($)}p.appendChild(v),p.appendChild(document.createTextNode(`${u.book} ${u.chapter}:${u.verse}`));const k=document.createElement("div");k.className=`snippet ${u.language==="he"?"rtl":""}`;const T=u.matchingTerms[0],I=Fi(T.snippet,T.matchStart,T.matchEnd,T.termIndex);k.appendChild(I),d.appendChild(p),d.appendChild(k),d.addEventListener("click",()=>{const C=To.find($=>$.book===u.book&&$.chapter===u.chapter&&$.verse===u.verse);C&&sn&&sn(C)}),Ue.appendChild(d)}Ue.classList.add("visible")}function Fi(n,s,c,u){const d=document.createDocumentFragment();s>0&&d.appendChild(document.createTextNode(n.slice(0,s)));const p=document.createElement("mark");return p.className=`term-${u%5}`,p.textContent=n.slice(s,c),d.appendChild(p),c<n.length&&d.appendChild(document.createTextNode(n.slice(c))),d}function Oo(n){return n>=1425&&n<=1479&&n!==1470&&n!==1472&&n!==1475&&n!==1478}function Zt(n,s,c=0){let u=0,d=0;for(let p=c;p<n.length&&d<s;p++){const v=n.charCodeAt(p);Oo(v)?u++:d++}return s+u}function ji(n,s,c){const u=[],d=c?ct(n):n.toLowerCase();for(let p=0;p<s.length;p++){const v=s[p],k=c?ct(v):v.toLowerCase();if(!c&&Tt){const T=k.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),I=new RegExp(`\\b${T}\\b`,"gi");let C;for(;(C=I.exec(n.toLowerCase()))!==null;)u.push({start:C.index,end:C.index+C[0].length,termIndex:p})}else if(c&&(Xe==="word"||Xe==="root")){const T=d.split(/\s+/);let I=0;for(const C of T){for(;I<d.length&&/\s/.test(d[I]);)I++;if(C===k){const $=Zt(n,I),F=Zt(n,I+C.length);u.push({start:$,end:F,termIndex:p})}I+=C.length}}else{let T=0;for(;;){const I=d.indexOf(k,T);if(I===-1)break;let C=I,$=I+k.length;c&&(C=Zt(n,I),$=Zt(n,I+k.length)),u.push({start:C,end:$,termIndex:p}),T=I+1}}}return u}function Hi(n){const s=[];for(const c of n)(s.length===0||c.start>=s[s.length-1].end)&&s.push(c);return s}function Ui(n,s){const c=document.createDocumentFragment();let u=0;for(const d of s){d.start>u&&c.appendChild(document.createTextNode(n.slice(u,d.start)));const p=document.createElement("mark");p.className=`term-${d.termIndex%5}`,p.textContent=n.slice(d.start,d.end),c.appendChild(p),u=d.end}return u<n.length&&c.appendChild(document.createTextNode(n.slice(u))),c}function Ki(n,s){const c=document.createDocumentFragment();if(Se.length===0)return c.appendChild(document.createTextNode(n)),c;const d=ji(n,Se,s==="he");if(d.length===0)return c.appendChild(document.createTextNode(n)),c;d.sort((v,k)=>v.start-k.start||k.end-v.end);const p=Hi(d);return Ui(n,p)}const zi={id:"search",name:"Text Search",getVerseColor(n){if(Se.length===0)return null;const s=$e(n.book,n.chapter,n.verse),c=an.get(s);if(c&&c.length>0){const d=c.map(p=>Ct[p%Ct.length]);return d.length===1?d[0]:d.slice(0,4)}const u=(.4+.2)*xe.DIM_FACTOR;return[u,u,u]},renderControls(n){if(n.innerHTML=`
      <div id="search-container">
        <input type="text" id="search-input" class="keyboardInput" placeholder="Search Hebrew or English...">
        <button id="keyboard-toggle" title="Toggle Hebrew keyboard">א</button>
        <button id="search-clear">&times;</button>
      </div>
      <div id="search-options">
        <label>
          <input type="checkbox" id="whole-word-checkbox">
          Match whole words only
        </label>
      </div>
      <div id="hebrew-mode-container" style="display: none;">
        <div class="hebrew-mode-label">Hebrew search mode:</div>
        <label class="hebrew-mode-option">
          <input type="radio" name="hebrew-mode" value="substring" checked>
          Substring
        </label>
        <label class="hebrew-mode-option">
          <input type="radio" name="hebrew-mode" value="word">
          Whole word
        </label>
        <label class="hebrew-mode-option">
          <input type="radio" name="hebrew-mode" value="root">
          Root (שרש)
        </label>
      </div>
      <div id="search-results">
        <div id="search-count"></div>
      </div>
    `,ve=n.querySelector("#search-input"),qe=n.querySelector("#search-clear"),yt=n.querySelector("#keyboard-toggle"),Ue=n.querySelector("#search-results"),Pe=n.querySelector("#whole-word-checkbox"),_e=n.querySelector("#hebrew-mode-container"),ve&&He){ve.value=He;const c=at(He);if(c&&(ve.dir="rtl"),Pe){const u=Pe.closest("#search-options");u&&(u.style.display=c?"none":"block")}_e&&(_e.style.display=c?"block":"none"),qe&&(qe.style.display=He?"block":"none"),tt.length>0&&Ao()}Pe&&(Pe.checked=Tt),_e&&_e.querySelectorAll('input[name="hebrew-mode"]').forEach(u=>{u.value===Xe&&(u.checked=!0)});const s=()=>{if(!ve)return;const c=ve.value,u=c.length>0&&at(c),d=u||dn();if(c.length===0?ve.dir=dn()?"rtl":"ltr":u?ve.dir="rtl":ve.dir="ltr",Pe){const p=Pe.closest("#search-options");p&&(p.style.display=d?"none":"block")}_e&&(_e.style.display=d?"block":"none")};ve==null||ve.addEventListener("paste",c=>{var d;const u=(d=c.clipboardData)==null?void 0:d.getData("text/plain");if(u&&at(u)){c.preventDefault();const p=ct(u),v=ve,k=v.selectionStart??0,T=v.selectionEnd??0,I=v.value;v.value=I.slice(0,k)+p+I.slice(T);const C=k+p.length;v.setSelectionRange(C,C),v.dispatchEvent(new Event("input",{bubbles:!0}))}}),ve==null||ve.addEventListener("input",()=>{const c=ve,u=c.value;if(u&&at(u)){const p=ct(u);if(p!==u){const v=c.selectionStart??u.length;let k=0;for(let I=0;I<Math.min(v,u.length);I++){const C=u.charCodeAt(I);Oo(C)&&k++}c.value=p;const T=v-k;c.setSelectionRange(T,T)}}const d=c.value.trim();s(),qe&&(qe.style.display=d?"block":"none"),Bt(d)}),qe==null||qe.addEventListener("click",()=>{if(ve&&(ve.value="",ve.dir="ltr",qe.style.display="none"),Pe){const c=Pe.closest("#search-options");c&&(c.style.display="block")}_e&&(_e.style.display="none"),Bt("")}),Pe==null||Pe.addEventListener("change",()=>{Tt=Pe.checked,He&&Bt(He),Qe==null||Qe()}),_e&&_e.querySelectorAll('input[name="hebrew-mode"]').forEach(u=>{u.addEventListener("change",()=>{u.checked&&(Xe=u.value,He&&Bt(He),Qe==null||Qe())})}),bt&&document.removeEventListener("click",bt),bt=c=>{Ue&&!Ue.contains(c.target)&&c.target!==ve&&c.target!==qe&&Ue.classList.remove("visible")},document.addEventListener("click",bt),ve==null||ve.addEventListener("focus",()=>{tt.length>0&&(Ue==null||Ue.classList.add("visible"))}),yt==null||yt.addEventListener("click",()=>{ve&&(dn()?(Wn(),yt.classList.remove("active")):(_i(ve),yt.classList.add("active")),s())})},renderLegend(n){if(n.textContent="",Se.length>0&&tt.length>0){const s=document.createElement("div");s.className="search-legend";for(let u=0;u<Se.length;u++){const d=Se[u],p=Ct[u%Ct.length],v=document.createElement("span");v.className="legend-term";const k=document.createElement("span");if(k.className="color-swatch",k.style.background=Co(p),v.appendChild(k),Xe==="root"&&At.length>0)if(At[u]&&xt[u])v.appendChild(document.createTextNode(`"${xt[u]}" (from "${d}")`));else{v.appendChild(document.createTextNode(`"${d}"`));const T=document.createElement("span");T.className="lemma-indicator",T.textContent=" ↪",T.title="No root data, using whole-word search",T.style.color="#FF9800",v.appendChild(T)}else v.appendChild(document.createTextNode(`"${d}"`));s.appendChild(v),u<Se.length-1&&s.appendChild(document.createTextNode(" "))}const c=document.createElement("div");c.style.color="#888",c.style.fontSize="11px",c.style.marginTop="4px",c.textContent=`${tt.length} matching verses`,n.appendChild(s),n.appendChild(c)}else if(He.length>0&&Se.length===0){const s=document.createElement("div");s.style.color="#888",s.style.fontSize="11px",s.textContent="Type at least 2 characters per term",n.appendChild(s)}else{const s=document.createElement("div");s.style.color="#888",s.style.fontSize="11px",s.textContent="Type to search (comma-separate multiple terms)",n.appendChild(s)}},getHoverInfo(n){if(Se.length===0)return null;const s=$e(n.book,n.chapter,n.verse),c=an.get(s);if(!c)return null;const u=at(Se[0]);return u&&Xe==="root"?`Matches root: ${c.map(p=>{const v=Se[p],k=Ft[p];return k&&k.length>0?`"${ct(v)}"`:`"${v}"`}).join(", ")}`:u&&Xe==="word"?`Matches word: ${c.map(p=>`"${Se[p]}"`).join(", ")}`:`Matches: ${c.map(p=>`"${Se[p]}"`).join(", ")}`},onUpdate(n){Qe=n},destroy(){Wn(),bt&&(document.removeEventListener("click",bt),bt=null),ve=null,qe=null,yt=null,Ue=null,Pe=null,_e=null,Qe=null,sn=null},getUrlParams(){const n={};return He&&(n.q=He),Tt&&(n.ww="1"),He&&at(He)&&Xe!=="substring"&&(n.hm=Xe),n},applyUrlParams(n){const s=n.get("q"),c=n.get("ww"),u=n.get("hm");if(c==="1"&&(Tt=!0,Pe&&(Pe.checked=!0)),(u==="word"||u==="root")&&(Xe=u,_e&&_e.querySelectorAll('input[name="hebrew-mode"]').forEach(p=>{p.value===u&&(p.checked=!0)})),s&&(Bt(s),ve)){ve.value=s;const d=at(s);if(d&&(ve.dir="rtl"),Pe){const p=Pe.closest("#search-options");p&&(p.style.display=d?"none":"block")}_e&&(_e.style.display=d?"block":"none"),qe&&(qe.style.display="block")}},highlightVerseText(n,s){return Ki(n,s)}};function Vi(n){return"torah"in n}function wn(n,s){const c=n/s*360;return yo({h:c,s:.8,l:.55})}function Yn(n,s){return[Math.min(1,n[0]*s),Math.min(1,n[1]*s),Math.min(1,n[2]*s)]}function Xn(n,s){const{h:c,s:u,l:d}=_r(n);return yo({h:c,s:u*s,l:d})}let Be=null,xn=null,Ze="ashkenazi",Me=null,$t=null,dt=new Map,et=new Map,En=new Set,en=new Set,Pt=new Map,Ut=0;function Gi(n,s){if(!xn)return 200;const c=xn.books.find(u=>u.name===n);return!c||s<1||s>c.chapters.length?200:c.chapters[s-1]}function hn(n,s){for(let c=n.start.chapter;c<=n.end.chapter;c++){const u=c===n.start.chapter?n.start.verse:1,d=Gi(n.book,c),p=c===n.end.chapter?Math.min(n.end.verse,d):d;for(let v=u;v<=p;v++)s(n.book,c,v)}}function pn(){if(dt.clear(),et.clear(),En.clear(),en.clear(),Pt.clear(),!Be)return;const n=Be.specialOccasions||[];Ut=Be.parshiot.length+n.length;for(let s=0;s<Be.parshiot.length;s++){const c=Be.parshiot[s];Pt.set(c,wn(s,Ut)),hn(c.torah,(d,p,v)=>{const k=$e(d,p,v);dt.set(k,c),En.add(k)});const u=c.haftarah[Ze];for(const d of u)hn(d,(p,v,k)=>{const T=$e(p,v,k),I=et.get(T);I?I.push(c):et.set(T,[c]),en.add(T)})}for(let s=0;s<n.length;s++){const c=n[s];Pt.set(c,wn(Be.parshiot.length+s,Ut));const u=c.haftarah[Ze];for(const d of u)hn(d,(p,v,k)=>{const T=$e(p,v,k),I=et.get(T);I?I.push(c):et.set(T,[c]),en.add(T)})}}function Jn(n){const s=$e(n.book,n.chapter,n.verse);return dt.has(s)||et.has(s)}const qi={id:"haftarah",name:"Haftarah",async init(){try{const[n,s]=await Promise.all([fetch("/torahmap/data/haftarah-mappings.json"),fetch("/torahmap/data/tanakh-structure.json")]);if(!n.ok){console.error(`Failed to load haftarah-mappings.json: ${n.status}`);return}if(!s.ok){console.error(`Failed to load tanakh-structure.json: ${s.status}`);return}Be=await n.json(),xn=await s.json(),pn()}catch(n){console.error("Failed to initialize haftarah overlay:",n)}},destroy(){Me=null,Ze="ashkenazi",$t=null,dt.clear(),et.clear(),En.clear(),en.clear(),Pt.clear()},onUpdate(n){$t=n},setHoveredVerse(n){const s=Me?Jn(Me):!1,c=n?Jn(n):!1,u=c?n:null;if(!s&&!c)return Me=null,!1;const d=Me?$e(Me.book,Me.chapter,Me.verse):null,p=u?$e(u.book,u.chapter,u.verse):null;return d===p?!1:(Me=u,s||c)},getVerseColor(n){if(!Be)return null;const s=$e(n.book,n.chapter,n.verse),c=dt.get(s),u=et.get(s);if(c){const d=Pt.get(c);if(!d)return null;if(!Me)return d;const p=$e(Me.book,Me.chapter,Me.verse),v=dt.get(p),k=et.get(p);return v===c||k&&k.includes(c)?Yn(d,xe.BRIGHTNESS_FACTOR):Xn(d,xe.DESATURATE_FACTOR)}if(u&&u.length>0){const d=u.map(C=>Pt.get(C)).filter(C=>C!==void 0);if(d.length===0)return null;if(!Me)return d.length===1?d[0]:d;const p=$e(Me.book,Me.chapter,Me.verse),v=dt.get(p),k=et.get(p);if(v&&u.includes(v)||k&&k.some(C=>u.includes(C))){const C=d.map($=>Yn($,xe.BRIGHTNESS_FACTOR));return C.length===1?C[0]:C}const I=d.map(C=>Xn(C,xe.DESATURATE_FACTOR));return I.length===1?I[0]:I}return null},renderControls(n){const s=document.createElement("div");s.className="haftarah-controls",s.innerHTML=`
      <div style="display: flex; align-items: center; gap: 8px; margin-top: 10px;">
        <label for="custom-select" style="font-size: 12px; color: #aaa;">Custom:</label>
        <select id="custom-select" style="flex: 1;">
          <option value="ashkenazi">Ashkenazi</option>
          <option value="sephardi">Sephardi</option>
        </select>
      </div>
    `;const c=s.querySelector("select");c.value=Ze,c.addEventListener("change",()=>{Ze=c.value,pn(),$t==null||$t()}),n.appendChild(s)},renderLegend(n){var k;const s=Ze==="ashkenazi"?"Ashkenazi":"Sephardi",c=(Be==null?void 0:Be.parshiot.length)||54,u=((k=Be==null?void 0:Be.specialOccasions)==null?void 0:k.length)||0,d=[],p=10;for(let T=0;T<p;T++){const C=wn(T*(Ut/p),Ut||81).map(F=>Math.round(F*255)).join(", "),$=T/(p-1)*100;d.push(`rgb(${C}) ${$}%`)}const v=d.join(", ");n.innerHTML=`
      <div class="legend-row">
        <div style="
          width: 20px;
          height: 12px;
          background: linear-gradient(to right, ${v});
          border-radius: 2px;
        "></div>
        <span>${c} Parshiot + ${u} Special Occasions</span>
      </div>
      <div style="color: #888; font-size: 10px; margin-top: 4px; margin-left: 28px; line-height: 1.3;">
        Torah portion & haftarah (${s}) use same color
      </div>
      <div style="color: #888; font-size: 10px; margin-top: 4px; margin-left: 28px; line-height: 1.3;">
        Includes holidays, fast days, special Shabbatot
      </div>
      <div style="color: #888; font-size: 10px; margin-top: 4px; margin-left: 28px; line-height: 1.3;">
        Multi-item verses show stippled pattern
      </div>
      <div style="color: #666; font-size: 10px; margin-top: 8px; line-height: 1.4;">
        Hover brightens the reading & its haftarah, desaturates others
      </div>
    `},getHoverInfo(n){if(!Be)return null;const s=$e(n.book,n.chapter,n.verse),c=dt.get(s);if(c){const p=c.haftarah[Ze].map(v=>v.start.chapter===v.end.chapter?`${v.book} ${v.start.chapter}:${v.start.verse}-${v.end.verse}`:`${v.book} ${v.start.chapter}:${v.start.verse}-${v.end.chapter}:${v.end.verse}`).join(", ");return`${c.name} (${c.hebrewName}) → ${p}`}const u=et.get(s);if(u&&u.length>0){if(u.length===1){const p=u[0];return Vi(p)?`Haftarah for ${p.name} (${p.hebrewName})`:`Haftarah for ${p.name} (${p.hebrewName})`}return`Haftarah for: ${u.map(p=>`${p.name} (${p.hebrewName})`).join(", ")}`}return null},getUrlParams(){return Ze==="ashkenazi"?{}:{custom:Ze}},applyUrlParams(n){if(n.get("custom")==="sephardi"){Ze="sephardi",pn();const c=document.querySelector("#custom-select");c&&(c.value=Ze)}}},Po=[{name:"Pre-Monarchic",dateRange:[1400,1e3],baseColor:[.6,.25,.15]},{name:"Early Monarchic",dateRange:[1e3,722],baseColor:[.75,.4,.2]},{name:"Late Monarchic",dateRange:[722,586],baseColor:[.85,.55,.25]},{name:"Exilic",dateRange:[586,538],baseColor:[.85,.7,.35]},{name:"Persian Period",dateRange:[538,331],baseColor:[.75,.75,.5]},{name:"Hellenistic",dateRange:[331,164],baseColor:[.8,.8,.7]}];let cn={notes:[],books:{}};function On(n){for(const s of Po)if(n>=s.dateRange[1]&&n<=s.dateRange[0])return s;return null}function Wi(n){const s=On(n);if(!s)return null;const[c,u]=s.dateRange,p=.7+(c-n)/(c-u)*.3;return[s.baseColor[0]*p,s.baseColor[1]*p,s.baseColor[2]*p]}function Sn(n){const s=cn.books[n.book];if(!s)return null;const c=s[n.chapter-1];return c&&c[n.verse-1]||null}const Yi={id:"text-dating",name:"Text Dating",async init(){try{const n=await fetch("/torahmap/data/text-dating.json");if(!n.ok){console.error(`Failed to load text-dating.json: ${n.status}`);return}cn=await n.json()}catch(n){console.error("Failed to parse text-dating.json:",n)}},getVerseColor(n){const s=Sn(n);if(!s)return null;const[c,u]=s.d,d=Math.abs((c+u)/2);return Wi(d)},renderLegend(n){const s=Po.map(c=>{const[u,d,p]=c.baseColor;return`
        <div class="legend-row">
          <span class="swatch" style="background: ${`rgb(${u*255}, ${d*255}, ${p*255})`}"></span>
          <span class="label">${c.name} (${c.dateRange[0]}-${c.dateRange[1]} BCE)</span>
        </div>
      `}).join("");n.innerHTML=`
      <div class="text-dating-legend">
        ${s}
        <div class="legend-note">Darker shades = later within period</div>
      </div>
    `},getHoverInfo(n){const s=Sn(n);if(!s)return null;const[c,u]=s.d,d=Math.abs((c+u)/2),p=On(d);if(!p)return null;const v=cn.notes[s.n],k=c===u?`~${Math.abs(c)} BCE`:`${Math.abs(c)}-${Math.abs(u)} BCE`;return`${p.name} (${k})
${v}`},renderSidebarInfo(n,s){if(!s)return null;const c=Xi(n.book,n.chapter,n.verse);if(!c)return null;const u=c.dateRange[0]===c.dateRange[1]?`~${c.dateRange[0]} BCE`:`${c.dateRange[0]}-${c.dateRange[1]} BCE`,d=c.note.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener">$1</a>');return`
      <strong>${c.era}</strong> (${u})
      <br>${d}
    `}};function Xi(n,s,c){const u=Sn({book:n,chapter:s,verse:c});if(!u)return null;const[d,p]=u.d,v=Math.abs((d+p)/2),k=On(v);return k?{era:k.name,eraDateRange:k.dateRange,dateRange:[Math.abs(d),Math.abs(p)],note:cn.notes[u.n]}:null}async function Ji(){var Nt;document.title="Tanakh Map [main]";const[n,s]=await Promise.all([fetch("/torahmap/data/tanakh-structure.json"),Qo(),sr()]);if(!n.ok)throw new Error(`Failed to load tanakh-structure.json: ${n.status}`);let c;try{c=await n.json()}catch(D){throw new Error(`Failed to parse tanakh-structure.json: ${D}`)}const u=qo(c),d=Wo(u);console.log(`Loaded ${u.length} verses, bounds: ${d.width}x${d.height}`),ur(s),Dt(Dr),Dt(Ai),Dt(zi),Dt(qi),Dt(Yi),Br({verses:u}),Oi({verseTexts:s}),await Promise.all(vi().map(D=>{var a;return(a=D.init)==null?void 0:a.call(D)}));const p=document.getElementById("canvas");if(!p)throw new Error("Canvas not found");const v=window.devicePixelRatio||1;function k(){const D=window.innerWidth,a=window.innerHeight;p.width=D*v,p.height=a*v,p.style.width=D+"px",p.style.height=a+"px"}k();const T=di(p),I=hi(T.gl,u,v);let C=null;function $(){const D=ti(u,C,Y.hoveredVerse,j),a=ni(D);pi(T.gl,I,a)}const F=wr(window.innerWidth,window.innerHeight,d);let j=null;const Y=Kr();function Z(){mi(T,I,F,Y.hoveredVerse,j)}function ye(D){const a=window.innerWidth,f=window.innerHeight;F.x=a/2/F.zoom-D.x-D.size/2,F.y=f/2/F.zoom-D.y-D.size/2}function ue(D,a=!1){j=D,ot(D,!0),a&&ye(D),$(),Z(),vn(window.bookLabels,{x:F.x,y:F.y},F.zoom),nt(!0)}function oe(){j=null,ot(null),$(),Z(),nt(!0)}Z(),window.bookLabels=Zo(u,document.body),vn(window.bookLabels,{x:F.x,y:F.y},F.zoom),p.addEventListener("wheel",D=>{D.preventDefault();const a=D.deltaY>0?Lo:_o,f=xr(F.zoom*a),e=D.clientX,t=D.clientY,o=Er({x:F.x,y:F.y},F.zoom,f,e,t);F.x=o.x,F.y=o.y,F.zoom=f,Z(),kt()},{passive:!1}),p.addEventListener("mousedown",D=>{zr(Y,D.clientX,D.clientY),p.style.cursor="grabbing"}),p.addEventListener("mousemove",D=>{if(Y.isDragging){const a=D.clientX-Y.dragStart.x,f=D.clientY-Y.dragStart.y;F.x+=a/F.zoom,F.y+=f/F.zoom,Y.dragStart={x:D.clientX,y:D.clientY},Z()}}),p.addEventListener("mouseup",D=>{if(Y.isDragging){Vr(Y),kt();const a=fn(u,F,D.clientX,D.clientY);j&&a?p.style.cursor="pointer":p.style.cursor="default"}}),p.addEventListener("mouseleave",()=>{const D=Y.hoveredVerse!==null;qr(Y),p.style.cursor="default";let a=!1;C!=null&&C.setHoveredVerse&&(a=C.setHoveredVerse(null)),(D||a)&&($(),Z())});const le=jr(),ge=document.getElementById("controls");function St(){var f;if(!C)return{};const D=((f=C.getUrlParams)==null?void 0:f.call(C))??{},a={};return D.trop&&(a.trop=D.trop),D.cat&&(a.category=D.cat),D.q&&(a.q=D.q),D.ww&&(a.ww=D.ww),D.hm&&(a.hm=D.hm),a}function Fe(){const D={overlayParams:{}};return C&&(D.overlay=C.id,D.overlayParams=St()),j&&(D.verse=Mr(j.book,j.chapter,j.verse)),F.zoom!==Do&&(D.zoom=F.zoom),j||(D.x=F.x,D.y=F.y),D}function nt(D=!1){const a=Fe();Pr(a,D)}const kt=Rr(()=>nt(!1),Bo);function ot(D,a=!1){Ur(le,D,s,C,er,a)}p.addEventListener("mousemove",D=>{if(!Y.isDragging){const a=fn(u,F,D.clientX,D.clientY),f=Y.hoveredVerse;Gr(Y,a);const e=!tn(f,a);j&&a?p.style.cursor="pointer":Y.isDragging?p.style.cursor="grabbing":p.style.cursor="default";let t=!1;C!=null&&C.setHoveredVerse&&(t=C.setHoveredVerse(a)),(e||t)&&($(),Z()),j||(a?ot(a,!1):ot(null))}}),p.addEventListener("click",D=>{const a=fn(u,F,D.clientX,D.clientY);a?j&&j.book===a.book&&j.chapter===a.chapter&&j.verse===a.verse?oe():ue(a):j&&oe()}),(Nt=le.closeBtn)==null||Nt.addEventListener("click",()=>{oe()}),window.addEventListener("keydown",D=>{if(!j)return;if(D.key==="Escape"){oe();return}let a=null;D.key==="ArrowRight"?a=tr(u,j):D.key==="ArrowLeft"&&(a=nr(u,j)),a&&ue(a,!0)});const Ke=document.getElementById("overlay-select"),ze=document.getElementById("overlay-controls"),Ve=document.getElementById("overlay-legend");function Mt(D,a=!1){var f,e,t,o;(f=C==null?void 0:C.destroy)==null||f.call(C),C=gi(D)??null,(e=C==null?void 0:C.onUpdate)==null||e.call(C,()=>{var r;$(),Ve&&(Ve.innerHTML="",(r=C==null?void 0:C.renderLegend)==null||r.call(C,Ve)),Z(),nt(!1)}),ze&&(ze.innerHTML="",(t=C==null?void 0:C.renderControls)==null||t.call(C,ze)),Ve&&(Ve.innerHTML="",(o=C==null?void 0:C.renderLegend)==null||o.call(C,Ve)),$(),Z(),a||nt(!0)}Ke==null||Ke.addEventListener("change",()=>{Mt(Ke.value)}),window.addEventListener("resize",()=>{k(),Z()}),window.torahMap={verses:u,pan:{x:F.x,y:F.y},zoom:F.zoom,render:Z,canvas:p,bounds:d},$i({verses:u,callbacks:{onVerseClick:D=>{ue(D)}}}),ge&&br(ge);function Wt(D){if(D.overlay&&(Mt(D.overlay,!0),Ke&&(Ke.value=D.overlay),C!=null&&C.applyUrlParams)){const a=new URLSearchParams;D.overlayParams.trop&&a.set("trop",D.overlayParams.trop),D.overlayParams.category&&a.set("cat",D.overlayParams.category),D.overlayParams.q&&a.set("q",D.overlayParams.q),D.overlayParams.ww&&a.set("ww",D.overlayParams.ww),D.overlayParams.hm&&a.set("hm",D.overlayParams.hm),C.applyUrlParams(a)}}function he(D){if(!D.verse)return!1;const a=Nr(D.verse);if(!a)return!1;const f=u.find(e=>e.book===a.book&&e.chapter===a.chapter&&e.verse===a.verse);return f?(j=f,ot(f,!0),ye(f),!0):!1}function Yt(D,a){D.zoom!==void 0&&(F.zoom=D.zoom),!a&&D.x!==void 0&&D.y!==void 0&&(F.x=D.x,F.y=D.y)}function Xt(){const D=Ar();Wt(D);const a=he(D);Yt(D,a),$(),Z()}window.location.hash&&Xt(),Ir(()=>{Xt()})}Ji().catch(console.error);
